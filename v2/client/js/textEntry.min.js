function addPTag(d,a){var b=document.getElementById("messageInput");var c=getSelection(b);if(!c){alert("You haven't selected any text to format (or your browser does not support this function).")}else{if(!c[2].match(/(^[a-zA-Z0-9\ ]+)$/)){alert("The selected text contains characters that can not be parsed.")}else{if(!c[1].match(/ $/)){d=" "+d}if(!c[3].match(/^ /)){a=a+" "}b.value=c[1]+d+c[2]+a+c[3]}}}function getSelection(a){var c=[a.value,"","",""];if(document.selection){var d="#$%^%$#";var b=document.selection.createRange();if(b.parentElement()!=a){return false}c[2]=b.text;b.text=d;fb=a.value.split(d);b.moveStart("character",-d.length);b.text=c[2];c[1]=fb[0];c[3]=fb[1]}else{if(a.selectionStart==a.selectionEnd){return false}c=(new RegExp("([\x00-\xff]{"+a.selectionStart+"})([\x00-\xff]{"+(a.selectionEnd-a.selectionStart)+"})([\x00-\xff]*)")).exec(a.value)}return c};