//# sourceMappingURL=jquery.plugins.js.map
/*
 jQuery UI - v1.11.4+CommonJS - 2015-08-28
 http://jqueryui.com
 Includes: widget.js
 Copyright 2015 jQuery Foundation and other contributors; Licensed MIT  jQuery UI Widget 1.11.4
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 http://api.jqueryui.com/jQuery.widget/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,f,a){b instanceof String&&(b=String(b));for(var c=b.length,e=0;e<c;e++){var h=b[e];if(f.call(a,h,e,b))return{i:e,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,a){b!=Array.prototype&&b!=Object.prototype&&(b[f]=a.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,f,a,c){if(f){a=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var e=b[c];e in a||(a[e]={});a=a[e]}b=b[b.length-1];c=a[b];f=f(c);f!=c&&null!=f&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var f=0;return $jscomp.iteratorPrototype(function(){return f<b.length?{done:!1,value:b[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,f){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var a=0,c={next:function(){if(a<b.length){var e=a++;return{value:f(e,b[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var f=0,a=Array.prototype.slice;b.cleanData=function(a){return function(e){var c,k,m;for(m=0;null!=(k=e[m]);m++)try{(c=b._data(k,"events"))&&c.remove&&b(k).triggerHandler("remove")}catch(n){}a(e)}}(b.cleanData);b.widget=function(a,e,h){var c={},m=a.split(".")[0];a=a.split(".")[1];var f=m+"-"+a;h||(h=e,e=b.Widget);b.expr[":"][f.toLowerCase()]=function(d){return!!b.data(d,
f)};b[m]=b[m]||{};var d=b[m][a];var g=b[m][a]=function(d,b){if(!this._createWidget)return new g(d,b);arguments.length&&this._createWidget(d,b)};b.extend(g,d,{version:h.version,_proto:b.extend({},h),_childConstructors:[]});var l=new e;l.options=b.widget.extend({},l.options);b.each(h,function(d,a){b.isFunction(a)?c[d]=function(){var b=function(){return e.prototype[d].apply(this,arguments)},g=function(b){return e.prototype[d].apply(this,b)};return function(){var d=this._super,e=this._superApply;this._super=
b;this._superApply=g;var c=a.apply(this,arguments);this._super=d;this._superApply=e;return c}}():c[d]=a});g.prototype=b.widget.extend(l,{widgetEventPrefix:d?l.widgetEventPrefix||a:a},c,{constructor:g,namespace:m,widgetName:a,widgetFullName:f});d?(b.each(d._childConstructors,function(d,a){d=a.prototype;b.widget(d.namespace+"."+d.widgetName,g,a._proto)}),delete d._childConstructors):e._childConstructors.push(g);b.widget.bridge(a,g);return g};b.widget.extend=function(c){for(var e=a.call(arguments,1),
h=0,k=e.length,m,f;h<k;h++)for(m in e[h])f=e[h][m],e[h].hasOwnProperty(m)&&void 0!==f&&(b.isPlainObject(f)?c[m]=b.isPlainObject(c[m])?b.widget.extend({},c[m],f):b.widget.extend({},f):c[m]=f);return c};b.widget.bridge=function(c,e){var h=e.prototype.widgetFullName||c;b.fn[c]=function(k){var m="string"===typeof k,f=a.call(arguments,1),d=this;m?this.each(function(){var a=b.data(this,h);if("instance"===k)return d=a,!1;if(!a)return b.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+
k+"'");if(!b.isFunction(a[k])||"_"===k.charAt(0))return b.error("no such method '"+k+"' for "+c+" widget instance");var e=a[k].apply(a,f);if(e!==a&&void 0!==e)return d=e&&e.jquery?d.pushStack(e.get()):e,!1}):(f.length&&(k=b.widget.extend.apply(null,[k].concat(f))),this.each(function(){var d=b.data(this,h);d?(d.option(k||{}),d._init&&d._init()):b.data(this,h,new e(k,this))}));return d}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",
defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,e){e=b(e||this.defaultElement||this)[0];this.element=b(e);this.uuid=f++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=b();this.hoverable=b();this.focusable=b();e!==this&&(b.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(b){b.target===e&&this.destroy()}}),this.document=b(e.style?e.ownerDocument:e.document||e),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));
this.options=b.widget.extend({},this.options,this._getCreateOptions(),a);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");
this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(a,e){var c=a,k;if(0===arguments.length)return b.widget.extend({},this.options);if("string"===typeof a){c={};var m=a.split(".");a=m.shift();if(m.length){var f=c[a]=b.widget.extend({},this.options[a]);for(k=0;k<m.length-1;k++)f[m[k]]=f[m[k]]||{},f=f[m[k]];a=m.pop();if(1===arguments.length)return void 0===
f[a]?null:f[a];f[a]=e}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];c[a]=e}}this._setOptions(c);return this},_setOptions:function(b){for(var a in b)this._setOption(a,b[a]);return this},_setOption:function(b,a){this.options[b]=a;"disabled"===b&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!a),a&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")));return this},enable:function(){return this._setOptions({disabled:!1})},
disable:function(){return this._setOptions({disabled:!0})},_on:function(a,e,h){var c,f=this;"boolean"!==typeof a&&(h=e,e=a,a=!1);h?(e=c=b(e),this.bindings=this.bindings.add(e)):(h=e,e=this.element,c=this.widget());b.each(h,function(h,d){function g(){if(a||!0!==f.options.disabled&&!b(this).hasClass("ui-state-disabled"))return("string"===typeof d?f[d]:d).apply(f,arguments)}"string"!==typeof d&&(g.guid=d.guid=d.guid||g.guid||b.guid++);var l=h.match(/^([\w:-]*)\s*(.*)$/);h=l[1]+f.eventNamespace;(l=l[2])?
c.delegate(l,h,g):e.bind(h,g)})},_off:function(a,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(e).undelegate(e);this.bindings=b(this.bindings.not(a).get());this.focusable=b(this.focusable.not(a).get());this.hoverable=b(this.hoverable.not(a).get())},_delay:function(b,a){var e=this;return setTimeout(function(){return("string"===typeof b?e[b]:b).apply(e,arguments)},a||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){b(a.currentTarget).addClass("ui-state-hover")},
mouseleave:function(a){b(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){b(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){b(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,e,h){var c,f=this.options[a];h=h||{};e=b.Event(e);e.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();e.target=this.element[0];if(a=e.originalEvent)for(c in a)c in e||
(e[c]=a[c]);this.element.trigger(e,h);return!(b.isFunction(f)&&!1===f.apply(this.element[0],[e].concat(h))||e.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(a,e){b.Widget.prototype["_"+a]=function(c,k,f){"string"===typeof k&&(k={effect:k});var h=k?!0===k||"number"===typeof k?e:k.effect||e:a;k=k||{};"number"===typeof k&&(k={duration:k});var d=!b.isEmptyObject(k);k.complete=f;k.delay&&c.delay(k.delay);if(d&&b.effects&&b.effects.effect[h])c[a](k);else if(h!==a&&c[h])c[h](k.duration,
k.easing,f);else c.queue(function(d){b(this)[a]();f&&f.call(c[0]);d()})}})});jQuery.fn.extend({autocompleteHelper:function(b,f){function a(a,e){a.val()?$.when(Resolver.resolveFromName(b,a.val())).then(function(b){b[a.val()]?(a.attr("data-value",b[a.val()].name),a.attr("data-id",b[a.val()].id),a.removeClass("is-invalid"),a.trigger("autocompleteChange")):(a.attr("data-id",""),a.attr("data-value",""),a.addClass("is-invalid"));e&&e()}):(a.attr("data-id",""),a.attr("data-value",""),a.removeClass("is-invalid"),a.trigger("autocompleteChange"),e&&e())}var c=$('<input class="js-typeahead form-control" type="search" autocomplete="off" />');
jQuery.each(["name","id","placeholder"],function(b,a){this.attr(a)&&c.attr(a,this.attr(a))});var e=$('<div class="typeahead__container form-control-container">').append($('<div class="typeahead__field">').append($('<span class="typeahead__query">').append(c)));this.replaceWith(e);c.typeahead({display:["name"],order:"asc",minLength:1,dynamic:!0,source:{users:{ajax:{url:fimApi.directory+"api/acHelper.php",data:{access_token:fimApi.lastSessionHash,list:b,search:"{{query}}"},path:"entries"}}},template:function(b,
a){return a.avatar?'<span class="userName userNameAvatar"><img src="{{avatar}}" style="max-width: 20px; max-height: 20px;"/> <span>{{name}}</span></span>':"<span>{{name}}</span>"},callback:{onClick:function(b,a,e,c){$(b).val(e.name);$(b).attr("data-id",e.id);$(b).attr("data-value",e.name);$(b).removeClass("is-invalid");$(b).trigger("autocompleteChange").change()},onCancel:function(b,a){$(b).attr("data-id","");$(b).attr("data-value","");$(b).removeClass("is-invalid");$(b).trigger("autocompleteChange").change()}}});
c.on("change",function(b){console.log("change",b)});c.off("keyup.autocompleteHelper").on("keyup.autocompleteHelper",function(b){$(b.target).attr("data-value")!=$(b.target).val()&&($(b.target).removeClass("is-invalid"),$(b.target).attr("data-id",""),$(b.target).attr("data-value",""))});c.closest("form").off("submit.autocompleteHelper").on("submit.autocompleteHelper",function(b){return!c.val()||c.attr("data-id")||c.hasClass("is-invalid")?!0:(console.log("fetcher invalid"),b.stopImmediatePropagation(),
a(c,function(){$(b.target).trigger("submit")}),!1)});f?$.when(Resolver.resolveFromId(b,f)).then(function(b){c.val(b[f].name);c.attr("data-value",b[f].name);c.attr("data-id",f)}):(c.val(""),c.attr("data-id",""),c.attr("data-value",""));return c}});(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){function f(a){var e=!1;b('[data-notify="container"]').each(function(c,h){c=b(h);h=c.find('[data-notify="title"]').html().trim();var k=c.find('[data-notify="message"]').html().trim();h=h===b("<div>"+a.settings.content.title+"</div>").html().trim();k=k===b("<div>"+a.settings.content.message+"</div>").html().trim();c=c.hasClass("alert-"+a.settings.type);h&&k&&
c&&(e=!0);return!e});return e}function a(a,h,k){k=b.extend(!0,{},{content:{message:"object"===typeof h?h.message:h,title:h.title?h.title:"",icon:h.icon?h.icon:"",url:h.url?h.url:"#",target:h.target?h.target:"-"}},k);this.settings=b.extend(!0,{},c,k);this._defaults=c;"-"===this.settings.content.target&&(this.settings.content.target=this.settings.url_target);this.animations={start:"webkitAnimationStart oanimationstart MSAnimationStart animationstart",end:"webkitAnimationEnd oanimationend MSAnimationEnd animationend"};
"number"===typeof this.settings.offset&&(this.settings.offset={x:this.settings.offset,y:this.settings.offset});(this.settings.allow_duplicates||!this.settings.allow_duplicates&&!f(this))&&this.init()}var c={element:"body",position:null,type:"info",allow_dismiss:!0,allow_duplicates:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5E3,timer:1E3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},
onShow:null,onShown:null,onClose:null,onClosed:null,onClick:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">&times;</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'};
String.format=function(){var b=arguments;return arguments[0].replace(/(\{\{\d\}\}|\{\d\})/g,function(a){if("{{"===a.substring(0,2))return a;a=parseInt(a.match(/\d/)[0]);return b[a+1]})};b.extend(a.prototype,{init:function(){var b=this;this.buildNotify();this.settings.content.icon&&this.setIcon();"#"!=this.settings.content.url&&this.styleURL();this.styleDismiss();this.placement();this.bind();this.notify={$ele:this.$ele,update:function(a,e){var c={};"string"===typeof a?c[a]=e:c=a;for(var h in c)switch(h){case "type":this.$ele.removeClass("alert-"+
b.settings.type);this.$ele.find('[data-notify="progressbar"] > .progress-bar').removeClass("progress-bar-"+b.settings.type);b.settings.type=c[h];this.$ele.addClass("alert-"+c[h]).find('[data-notify="progressbar"] > .progress-bar').addClass("progress-bar-"+c[h]);break;case "icon":e=this.$ele.find('[data-notify="icon"]');"class"===b.settings.icon_type.toLowerCase()?e.removeClass(b.settings.content.icon).addClass(c[h]):(e.is("img")||e.find("img"),e.attr("src",c[h]));b.settings.content.icon=c[a];break;
case "progress":this.$ele.data("notify-delay",b.settings.delay-c[h]/100*b.settings.delay);this.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",c[h]).css("width",c[h]+"%");break;case "url":this.$ele.find('[data-notify="url"]').attr("href",c[h]);break;case "target":this.$ele.find('[data-notify="url"]').attr("target",c[h]);break;default:this.$ele.find('[data-notify="'+h+'"]').html(c[h])}a=this.$ele.outerHeight()+parseInt(b.settings.spacing)+parseInt(b.settings.offset.y);b.reposition(a)},
close:function(){b.close()}}},buildNotify:function(){var a=this.settings.content;this.$ele=b(String.format(this.settings.template,this.settings.type,a.title,a.message,a.url,a.target));this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align);this.settings.allow_dismiss||this.$ele.find('[data-notify="dismiss"]').css("display","none");(0>=this.settings.delay&&!this.settings.showProgressbar||!this.settings.showProgressbar)&&this.$ele.find('[data-notify="progressbar"]').remove()},
setIcon:function(){"class"===this.settings.icon_type.toLowerCase()?this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon):this.$ele.find('[data-notify="icon"]').is("img")?this.$ele.find('[data-notify="icon"]').attr("src",this.settings.content.icon):this.$ele.find('[data-notify="icon"]').append('<img src="'+this.settings.content.icon+'" alt="Notify Icon" />')},styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"10px",top:"5px",zIndex:this.settings.z_index+
2})},styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},placement:function(){var a=this,c=this.settings.offset.y,k={display:"inline-block",margin:"0px auto",position:this.settings.position?this.settings.position:"body"===this.settings.element?"fixed":"absolute",transition:"all .5s ease-in-out",
zIndex:this.settings.z_index},f=!1,n=this.settings;b('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){c=Math.max(c,parseInt(b(this).css(n.placement.from))+parseInt(b(this).outerHeight())+parseInt(n.spacing))});!0===this.settings.newest_on_top&&(c=this.settings.offset.y);k[this.settings.placement.from]=c+"px";switch(this.settings.placement.align){case "left":case "right":k[this.settings.placement.align]=this.settings.offset.x+
"px";break;case "center":k.left=0,k.right=0}this.$ele.css(k).addClass(this.settings.animate.enter);b.each(["webkit-","moz-","o-","ms-",""],function(b,g){a.$ele[0].style[g+"AnimationIterationCount"]=1});b(this.settings.element).append(this.$ele);!0===this.settings.newest_on_top&&(c=parseInt(c)+parseInt(this.settings.spacing)+this.$ele.outerHeight(),this.reposition(c));b.isFunction(a.settings.onShow)&&a.settings.onShow.call(this.$ele);this.$ele.one(this.animations.start,function(){f=!0}).one(this.animations.end,
function(){a.$ele.removeClass(a.settings.animate.enter);b.isFunction(a.settings.onShown)&&a.settings.onShown.call(this)});setTimeout(function(){f||b.isFunction(a.settings.onShown)&&a.settings.onShown.call(this)},600)},bind:function(){var a=this;this.$ele.find('[data-notify="dismiss"]').on("click",function(){a.close()});if(b.isFunction(a.settings.onClick))this.$ele.on("click",function(b){b.target!=a.$ele.find('[data-notify="dismiss"]')[0]&&a.settings.onClick.call(this,b)});this.$ele.mouseover(function(){b(this).data("data-hover",
"true")}).mouseout(function(){b(this).data("data-hover","false")});this.$ele.data("data-hover","false");if(0<this.settings.delay){a.$ele.data("notify-delay",a.settings.delay);var c=setInterval(function(){var b=parseInt(a.$ele.data("notify-delay"))-a.settings.timer;if("false"===a.$ele.data("data-hover")&&"pause"===a.settings.mouse_over||"pause"!=a.settings.mouse_over){var e=(a.settings.delay-b)/a.settings.delay*100;a.$ele.data("notify-delay",b);a.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",
e).css("width",e+"%")}b<=-a.settings.timer&&(clearInterval(c),a.close())},a.settings.timer)}},close:function(){var a=this,c=parseInt(this.$ele.css(this.settings.placement.from)),k=!1;this.$ele.attr("data-closing","true").addClass(this.settings.animate.exit);a.reposition(c);b.isFunction(a.settings.onClose)&&a.settings.onClose.call(this.$ele);this.$ele.one(this.animations.start,function(){k=!0}).one(this.animations.end,function(){b(this).remove();b.isFunction(a.settings.onClosed)&&a.settings.onClosed.call(this)});
setTimeout(function(){k||(a.$ele.remove(),b.isFunction(a.settings.onClosed)&&a.settings.onClosed.call(this))},600)},reposition:function(a){var e=this,c='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',f=this.$ele.nextAll(c);!0===this.settings.newest_on_top&&(f=this.$ele.prevAll(c));f.each(function(){b(this).css(e.settings.placement.from,a);a=parseInt(a)+parseInt(e.settings.spacing)+b(this).outerHeight()})}});b.notify=function(b,
c){return(new a(this,b,c)).notify};b.notifyDefaults=function(a){return c=b.extend(!0,{},c,a)};b.notifyClose=function(a){"undefined"===typeof a||"all"===a?b("[data-notify]").find('[data-notify="dismiss"]').trigger("click"):"success"===a||"info"===a||"warning"===a||"danger"===a?b(".alert-"+a+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):a?b(a+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):b('[data-notify-position="'+a+'"]').find('[data-notify="dismiss"]').trigger("click")};
b.notifyCloseExcept=function(a){"success"===a||"info"===a||"warning"===a||"danger"===a?b("[data-notify]").not(".alert-"+a).find('[data-notify="dismiss"]').trigger("click"):b("[data-notify]").not(a).find('[data-notify="dismiss"]').trigger("click")}});(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){function f(b){b=b.split(/\s+/);for(var a=[],d=0,g;g=b[d];d++)g=g.charAt(0).toUpperCase(),a.push(g);return a}function a(a){return a.id&&b('label[for="'+a.id+'"]').val()||a.name}function c(d,g,e){e||(e=0);g.each(function(){var g=b(this),p=this,y=this.nodeName.toLowerCase();if("label"===y&&g.find("input, textarea, select").length){var l=g.text();g=g.children().first();
p=g.get(0);y=p.nodeName.toLowerCase()}switch(y){case "menu":var h={name:g.attr("label"),items:{}};e=c(h.items,g.children(),e);break;case "a":case "button":h={name:g.text(),disabled:!!g.attr("disabled"),callback:function(){return function(){g.get(0).click()}}()};break;case "menuitem":case "command":switch(g.attr("type")){case void 0:case "command":case "menuitem":h={name:g.attr("label"),disabled:!!g.attr("disabled"),icon:g.attr("icon"),callback:function(){return function(){g.get(0).click()}}()};break;
case "checkbox":h={type:"checkbox",disabled:!!g.attr("disabled"),name:g.attr("label"),selected:!!g.attr("checked")};break;case "radio":h={type:"radio",disabled:!!g.attr("disabled"),name:g.attr("label"),radio:g.attr("radiogroup"),value:g.attr("id"),selected:!!g.attr("checked")};break;default:h=void 0}break;case "hr":h="-------";break;case "input":switch(g.attr("type")){case "text":h={type:"text",name:l||a(p),disabled:!!g.attr("disabled"),value:g.val()};break;case "checkbox":h={type:"checkbox",name:l||
a(p),disabled:!!g.attr("disabled"),selected:!!g.attr("checked")};break;case "radio":h={type:"radio",name:l||a(p),disabled:!!g.attr("disabled"),radio:!!g.attr("name"),value:g.val(),selected:!!g.attr("checked")};break;default:h=void 0}break;case "select":h={type:"select",name:l||a(p),disabled:!!g.attr("disabled"),selected:g.val(),options:{}};g.children().each(function(){h.options[this.value]=b(this).text()});break;case "textarea":h={type:"textarea",name:l||a(p),disabled:!!g.attr("disabled"),value:g.val()};
break;case "label":break;default:h={type:"html",html:g.clone(!0)}}h&&(e++,d["key"+e]=h)});return e}b.support.htmlMenuitem="HTMLMenuItemElement"in window;b.support.htmlCommand="HTMLCommandElement"in window;b.support.eventSelectstart="onselectstart"in document.documentElement;b.ui&&b.widget||(b.cleanData=function(a){return function(d){var g,p;for(p=0;null!=d[p];p++){var c=d[p];try{(g=b._data(c,"events"))&&g.remove&&b(c).triggerHandler("remove")}catch(x){}}a(d)}}(b.cleanData));var e=null,h=!1,k=b(window),
m=0,n={},d={},g={},l={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",
iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(a){if(b.ui&&b.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var d=this.offset();d.top+=this.outerHeight();d.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(d)}},position:function(b,a,d){if(a||d){if("maintain"===a&&"maintain"===d)a=b.$menu.position();else{var g=b.$menu.offsetParent().offset();
a={top:d-g.top,left:a-g.left}}d=k.scrollTop()+k.height();g=k.scrollLeft()+k.width();var p=b.$menu.outerHeight(),c=b.$menu.outerWidth();a.top+p>d&&(a.top-=p);0>a.top&&(a.top=0);a.left+c>g&&(a.left-=c);0>a.left&&(a.left=0);b.$menu.css(a)}else b.determinePosition.call(this,b.$menu)},positionSubmenu:function(a){if("undefined"!==typeof a)if(b.ui&&b.ui.position)a.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var d={top:-9,left:this.outerWidth()-
5};a.css(d)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:b.noop,hide:b.noop},callback:null,items:{}},r=null,w=null,u=null,B,C=function(a){for(var b=0;b=Math.max(b,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return b},q={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},contextmenu:function(a){var d=b(this);"right"===a.data.trigger&&(a.preventDefault(),a.stopImmediatePropagation());
if(!("right"!==a.data.trigger&&"demand"!==a.data.trigger&&a.originalEvent||"undefined"!==typeof a.mouseButton&&a.data&&!("left"===a.data.trigger&&0===a.mouseButton||"right"===a.data.trigger&&2===a.mouseButton)||d.hasClass("context-menu-active")||d.hasClass("context-menu-disabled"))){e=d;if(a.data.build){var g=a.data.build(e,a);if(!1===g)return;a.data=b.extend(!0,{},l,a.data,g||{});if(!a.data.items||b.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),
Error("No Items specified");a.data.$trigger=e;t.create(a.data)}g=!1;for(var c in a.data.items)a.data.items.hasOwnProperty(c)&&(b.isFunction(a.data.items[c].visible)?a.data.items[c].visible.call(b(a.currentTarget),c,a.data):"undefined"!==typeof a.data.items[c]&&a.data.items[c].visible?!0===a.data.items[c].visible:1)&&(g=!0);g&&t.show.call(d,a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();b(this).trigger(b.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},
mousedown:function(a){var d=b(this);e&&e.length&&!e.is(d)&&e.data("contextMenu").$menu.trigger("contextmenu:hide");2===a.button&&(e=d.data("contextMenuActive",!0))},mouseup:function(a){var d=b(this);d.data("contextMenuActive")&&e&&e.length&&e.is(d)&&!d.hasClass("context-menu-disabled")&&(a.preventDefault(),a.stopImmediatePropagation(),e=d,d.trigger(b.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));d.removeData("contextMenuActive")},mouseenter:function(a){var d=b(this),g=b(a.relatedTarget),
c=b(document);g.is(".context-menu-list")||g.closest(".context-menu-list").length||e&&e.length||(w=a.pageX,u=a.pageY,B=a.data,c.on("mousemove.contextMenuShow",q.mousemove),r=setTimeout(function(){r=null;c.off("mousemove.contextMenuShow");e=d;d.trigger(b.Event("contextmenu",{data:B,pageX:w,pageY:u}))},a.data.delay))},mousemove:function(a){w=a.pageX;u=a.pageY},mouseleave:function(a){a=b(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(r)}catch(y){}r=
null}},layerClick:function(a){var d=b(this).data("contextMenuRoot"),g=a.button,c=a.pageX,e=a.pageY,l,p;a.preventDefault();setTimeout(function(){var y="left"===d.trigger&&0===g||"right"===d.trigger&&2===g;if(document.elementFromPoint&&d.$layer){d.$layer.hide();l=document.elementFromPoint(c-k.scrollLeft(),e-k.scrollTop());if(l.isContentEditable){var h=document.createRange();var f=window.getSelection();h.selectNode(l);h.collapse(!0);f.removeAllRanges();f.addRange(h)}b(l).trigger(a);d.$layer.show()}if(d.reposition&&
y)if(document.elementFromPoint){if(d.$trigger.is(l)){d.position.call(d.$trigger,d,c,e);return}}else if(p=d.$trigger.offset(),h=b(window),p.top+=h.scrollTop(),p.top<=a.pageY&&(p.left+=h.scrollLeft(),p.left<=a.pageX&&(p.bottom=p.top+d.$trigger.outerHeight(),p.bottom>=a.pageY&&(p.right=p.left+d.$trigger.outerWidth(),p.right>=a.pageX)))){d.position.call(d.$trigger,d,c,e);return}if(l&&y)d.$trigger.one("contextmenu:hidden",function(){b(l).contextMenu({x:c,y:e,button:g})});null!==d&&"undefined"!==typeof d&&
null!==d.$menu&&"undefined"!==typeof d.$menu&&d.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,d){d.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var d={};e&&(d=e.data("contextMenu")||{});"undefined"===typeof d.zIndex&&(d.zIndex=0);var b=0,g=function(a){""!==a.style.zIndex?b=a.style.zIndex:null!==a.offsetParent&&"undefined"!==typeof a.offsetParent?g(a.offsetParent):null!==a.parentElement&&"undefined"!==typeof a.parentElement&&g(a.parentElement)};g(a.target);if(!(d.$menu&&
parseInt(b,10)>parseInt(d.$menu.css("zIndex"),10))){switch(a.keyCode){case 9:case 38:q.keyStop(a,d);if(d.isInput){if(9===a.keyCode&&a.shiftKey){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();null!==d.$menu&&"undefined"!==typeof d.$menu&&d.$menu.trigger("prevcommand");return}if(38===a.keyCode&&"checkbox"===d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else if(9!==a.keyCode||a.shiftKey){null!==d.$menu&&"undefined"!==typeof d.$menu&&
d.$menu.trigger("prevcommand");return}break;case 40:q.keyStop(a,d);if(d.isInput){if(9===a.keyCode){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();null!==d.$menu&&"undefined"!==typeof d.$menu&&d.$menu.trigger("nextcommand");return}if(40===a.keyCode&&"checkbox"===d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{null!==d.$menu&&"undefined"!==typeof d.$menu&&d.$menu.trigger("nextcommand");return}break;case 37:q.keyStop(a,d);
if(d.isInput||!d.$selected||!d.$selected.length)break;if(!d.$selected.parent().hasClass("context-menu-root")){a=d.$selected.parent().parent();d.$selected.trigger("contextmenu:blur");d.$selected=a;return}break;case 39:q.keyStop(a,d);if(d.isInput||!d.$selected||!d.$selected.length)break;var c=d.$selected.data("contextMenu")||{};if(c.$menu&&d.$selected.hasClass("context-menu-submenu")){d.$selected=null;c.$selected=null;c.$menu.trigger("nextcommand");return}break;case 35:case 36:d.$selected&&d.$selected.find("input, textarea, select").length||
((d.$selected&&d.$selected.parent()||d.$menu).children(":not(."+d.classNames.disabled+", ."+d.classNames.notSelectable+")")[36===a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:q.keyStop(a,d);if(d.isInput){if(d.$selected&&!d.$selected.is("textarea, select")){a.preventDefault();return}break}"undefined"!==typeof d.$selected&&null!==d.$selected&&d.$selected.trigger("mouseup");return;case 32:case 33:case 34:q.keyStop(a,d);return;case 27:q.keyStop(a,d);null!==
d.$menu&&"undefined"!==typeof d.$menu&&d.$menu.trigger("contextmenu:hide");return;default:if(c=String.fromCharCode(a.keyCode).toUpperCase(),d.accesskeys&&d.accesskeys[c]){d.accesskeys[c].$node.trigger(d.accesskeys[c].$menu?"contextmenu:focus":"mouseup");return}}a.stopPropagation();"undefined"!==typeof d.$selected&&null!==d.$selected&&d.$selected.trigger(a)}},prevItem:function(a){a.stopPropagation();var d=b(this).data("contextMenu")||{},g=b(this).data("contextMenuRoot")||{};if(d.$selected){var c=d.$selected;
d=d.$selected.parent().data("contextMenu")||{};d.$selected=c}c=d.$menu.children();for(var e=d.$selected&&d.$selected.prev().length?d.$selected.prev():c.last(),l=e;e.hasClass(g.classNames.disabled)||e.hasClass(g.classNames.notSelectable)||e.is(":hidden");)if(e=e.prev().length?e.prev():c.last(),e.is(l))return;d.$selected&&q.itemMouseleave.call(d.$selected.get(0),a);q.itemMouseenter.call(e.get(0),a);a=e.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var d=
b(this).data("contextMenu")||{},g=b(this).data("contextMenuRoot")||{};if(d.$selected){var c=d.$selected;d=d.$selected.parent().data("contextMenu")||{};d.$selected=c}c=d.$menu.children();for(var e=d.$selected&&d.$selected.next().length?d.$selected.next():c.first(),l=e;e.hasClass(g.classNames.disabled)||e.hasClass(g.classNames.notSelectable)||e.is(":hidden");)if(e=e.next().length?e.next():c.first(),e.is(l))return;d.$selected&&q.itemMouseleave.call(d.$selected.get(0),a);q.itemMouseenter.call(e.get(0),
a);a=e.find("input, textarea, select");a.length&&a.focus()},focusInput:function(){var a=b(this).closest(".context-menu-item"),d=a.data(),g=d.contextMenu;d=d.contextMenuRoot;d.$selected=g.$selected=a;d.isInput=g.isInput=!0},blurInput:function(){var a=b(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(){b(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var d=b(this).data().contextMenuRoot;d.$layer&&d.$layer.is(a.relatedTarget)&&
(d.hovering=!1)},itemMouseenter:function(a){var d=b(this),g=d.data(),c=g.contextMenu;g=g.contextMenuRoot;g.hovering=!0;a&&g.$layer&&g.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(c.$menu?c:g).$menu.children("."+g.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur");d.hasClass(g.classNames.disabled)||d.hasClass(g.classNames.notSelectable)?c.$selected=null:d.trigger("contextmenu:focus")},itemMouseleave:function(a){var d=b(this),
g=d.data(),c=g.contextMenu;g=g.contextMenuRoot;g!==c&&g.$layer&&g.$layer.is(a.relatedTarget)?("undefined"!==typeof g.$selected&&null!==g.$selected&&g.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),g.$selected=c.$selected=c.$node):c&&c.$menu&&c.$menu.hasClass("context-menu-visible")||d.trigger("contextmenu:blur")},itemClick:function(a){var d=b(this),g=d.data(),c=g.contextMenu,e=g.contextMenuRoot;g=g.contextMenuKey;if(!(!c.items[g]||d.is("."+e.classNames.disabled+
", .context-menu-separator, ."+e.classNames.notSelectable)||d.is(".context-menu-submenu")&&!1===e.selectableSubMenu)){a.preventDefault();a.stopImmediatePropagation();if(b.isFunction(c.callbacks[g])&&Object.prototype.hasOwnProperty.call(c.callbacks,g))d=c.callbacks[g];else if(b.isFunction(e.callback))d=e.callback;else return;!1!==d.call(e.$trigger,g,e,a)?e.$menu.trigger("contextmenu:hide"):e.$menu.parent().length&&t.update.call(e.$trigger,e)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,
d){a=b(this).data("contextMenuRoot");t.hide.call(a.$trigger,a,d&&d.force)},focusItem:function(a){a.stopPropagation();a=b(this);var d=a.data(),g=d.contextMenu;d=d.contextMenuRoot;a.hasClass(d.classNames.disabled)||a.hasClass(d.classNames.notSelectable)||(a.addClass([d.classNames.hover,d.classNames.visible].join(" ")).parent().find(".context-menu-item").not(a).removeClass(d.classNames.visible).filter("."+d.classNames.hover).trigger("contextmenu:blur"),g.$selected=d.$selected=a,g&&g.$node&&g.$node.hasClass("context-menu-submenu")&&
g.$node.addClass(d.classNames.hover),g.$node&&d.positionSubmenu.call(g.$node,g.$menu))},blurItem:function(a){a.stopPropagation();a=b(this);var d=a.data(),g=d.contextMenu;d=d.contextMenuRoot;g.autoHide&&a.removeClass(d.classNames.visible);a.removeClass(d.classNames.hover);g.$selected=null}},t={show:function(a,d,g){var c=b(this),l={};b("#context-menu-layer").trigger("mousedown");a.$trigger=c;if(!1===a.events.show.call(c,a))e=null;else if(t.update.call(c,a),a.position.call(c,a,d,g),a.zIndex&&(d=a.zIndex,
"function"===typeof a.zIndex&&(d=a.zIndex.call(c,a)),l.zIndex=C(c)+d),t.layer.call(a.$menu,a,l.zIndex),a.$menu.find("ul").css("zIndex",l.zIndex+1),a.$menu.css(l)[a.animation.show](a.animation.duration,function(){c.trigger("contextmenu:visible")}),c.data("contextMenu",a).addClass("context-menu-active"),b(document).off("keydown.contextMenu").on("keydown.contextMenu",q.key),a.autoHide)b(document).on("mousemove.contextMenuAutoHide",function(d){var b=c.offset();b.right=b.left+c.outerWidth();b.bottom=b.top+
c.outerHeight();!a.$layer||a.hovering||d.pageX>=b.left&&d.pageX<=b.right&&d.pageY>=b.top&&d.pageY<=b.bottom||setTimeout(function(){a.hovering||null===a.$menu||"undefined"===typeof a.$menu||a.$menu.trigger("contextmenu:hide")},50)})},hide:function(a,d){var g=b(this);a||(a=g.data("contextMenu")||{});if(d||!a.events||!1!==a.events.hide.call(g,a)){g.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(D){a.$layer=
null}}e=null;a.$menu.find("."+a.classNames.hover).trigger("contextmenu:blur");a.$selected=null;a.$menu.find("."+a.classNames.visible).removeClass(a.classNames.visible);b(document).off(".contextMenuAutoHide").off("keydown.contextMenu");if(a.$menu)a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&(a.$menu.remove(),b.each(a,function(d){switch(d){case "ns":case "selector":case "build":case "trigger":return!0;default:a[d]=void 0;try{delete a[d]}catch(F){}return!0}}));setTimeout(function(){g.trigger("contextmenu:hidden")},
10)})}},create:function(a,d){function c(a){var d=b("<span></span>");if(a._accesskey)a._beforeAccesskey&&d.append(document.createTextNode(a._beforeAccesskey)),b("<span></span>").addClass("context-menu-accesskey").text(a._accesskey).appendTo(d),a._afterAccesskey&&d.append(document.createTextNode(a._afterAccesskey));else if(a.isHtmlName){if("undefined"!==typeof a.accesskey)throw Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");d.html(a.name)}else d.text(a.name);
return d}"undefined"===typeof d&&(d=a);a.$menu=b('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:d});b.each(["callbacks","commands","inputs"],function(b,g){a[g]={};d[g]||(d[g]={})});d.accesskeys||(d.accesskeys={});b.each(a.items,function(e,l){var h=b('<li class="context-menu-item"></li>').addClass(l.className||""),k=null,r=null;h.on("click",b.noop);if("string"===typeof l||"cm_separator"===l.type)l={type:"cm_seperator"};l.$node=h.data({contextMenu:a,
contextMenuRoot:d,contextMenuKey:e});if("undefined"!==typeof l.accesskey)for(var u=f(l.accesskey),p=0,w;w=u[p];p++)if(!d.accesskeys[w]){d.accesskeys[w]=l;if(u=l.name.match(new RegExp("^(.*?)("+w+")(.*)$","i")))l._beforeAccesskey=u[1],l._accesskey=u[2],l._afterAccesskey=u[3];break}if(l.type&&g[l.type])g[l.type].call(h,l,a,d),b.each([a,d],function(d,g){g.commands[e]=l;!b.isFunction(l.callback)||"undefined"!==typeof g.callbacks[e]&&"undefined"!==typeof a.type||(g.callbacks[e]=l.callback)});else{"cm_seperator"===
l.type?h.addClass("context-menu-separator "+d.classNames.notSelectable):"html"===l.type?h.addClass("context-menu-html "+d.classNames.notSelectable):"sub"!==l.type&&(l.type?(k=b("<label></label>").appendTo(h),c(l).appendTo(k),h.addClass("context-menu-input"),a.hasTypes=!0,b.each([a,d],function(a,d){d.commands[e]=l;d.inputs[e]=l})):l.items&&(l.type="sub"));switch(l.type){case "cm_seperator":break;case "text":r=b('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+e).val(l.value||
"").appendTo(k);break;case "textarea":r=b('<textarea name=""></textarea>').attr("name","context-menu-input-"+e).val(l.value||"").appendTo(k);l.height&&r.height(l.height);break;case "checkbox":r=b('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+e).val(l.value||"").prop("checked",!!l.selected).prependTo(k);break;case "radio":r=b('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+l.radio).val(l.value||"").prop("checked",!!l.selected).prependTo(k);
break;case "select":r=b('<select name=""></select>').attr("name","context-menu-input-"+e).appendTo(k);l.options&&(b.each(l.options,function(a,d){b("<option></option>").val(a).text(d).appendTo(r)}),r.val(l.selected));break;case "sub":c(l).appendTo(h);l.appendTo=l.$node;h.data("contextMenu",l).addClass("context-menu-submenu");l.callback=null;"function"===typeof l.items.then?t.processPromises(l,d,l.items):t.create(l,d);break;case "html":b(l.html).appendTo(h);break;default:b.each([a,d],function(d,g){g.commands[e]=
l;!b.isFunction(l.callback)||"undefined"!==typeof g.callbacks[e]&&"undefined"!==typeof a.type||(g.callbacks[e]=l.callback)}),c(l).appendTo(h)}if(l.type&&"sub"!==l.type&&"html"!==l.type&&"cm_seperator"!==l.type&&(r.on("focus",q.focusInput).on("blur",q.blurInput),l.events))r.on(l.events,a);l.icon&&(b.isFunction(l.icon)?l._icon=l.icon.call(this,this,h,e,l):"string"===typeof l.icon&&"fa-"===l.icon.substring(0,3)?l._icon=d.classNames.icon+" "+d.classNames.icon+"--fa fa "+l.icon:l._icon=d.classNames.icon+
" "+d.classNames.icon+"-"+l.icon,h.addClass(l._icon))}l.$input=r;l.$label=k;h.appendTo(a.$menu);if(!a.hasTypes&&b.support.eventSelectstart)h.on("selectstart.disableTextSelect",q.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||document.body)},resize:function(a,d){var g;a.css({position:"absolute",display:"block"});a.data("width",(g=a.get(0)).getBoundingClientRect?Math.ceil(g.getBoundingClientRect().width):a.outerWidth()+1);a.css({position:"static",
minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){t.resize(b(this),!0)});d||a.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return b(this).data("width")})},update:function(a,d){var g=this;"undefined"===typeof d&&(d=a,t.resize(a.$menu));a.$menu.children().each(function(){var c=b(this),l=c.data("contextMenuKey"),e=a.items[l],h=b.isFunction(e.disabled)&&e.disabled.call(g,l,d)||!0===e.disabled;var k=b.isFunction(e.visible)?e.visible.call(g,
l,d):"undefined"!==typeof e.visible?!0===e.visible:!0;c[k?"show":"hide"]();c[h?"addClass":"removeClass"](d.classNames.disabled);b.isFunction(e.icon)&&(c.removeClass(e._icon),e._icon=e.icon.call(this,g,c,l,e),c.addClass(e._icon));if(e.type)switch(c.find("input, select, textarea").prop("disabled",h),e.type){case "text":case "textarea":e.$input.val(e.value||"");break;case "checkbox":case "radio":e.$input.val(e.value||"").prop("checked",!!e.selected);break;case "select":e.$input.val((0===e.selected?"0":
e.selected)||"")}e.$menu&&t.update.call(g,e,d)})},layer:function(a,d){a=a.$layer=b('<div id="context-menu-layer"></div>').css({height:k.height(),width:k.width(),display:"block",position:"fixed","z-index":d,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",q.abortevent).on("mousedown",q.layerClick);"undefined"===typeof document.body.style.maxWidth&&a.css({position:"absolute",height:b(document).height()});return a},
processPromises:function(a,d,b){function g(a,d,b){"undefined"===typeof b?(b={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"===typeof b&&(b={error:{name:b}});c(a,d,b)}function c(a,d,b){"undefined"!==typeof d.$menu&&d.$menu.is(":visible")&&(a.$node.removeClass(d.classNames.iconLoadingClass),a.items=b,t.create(a,
d,!0),t.update(a,d),d.positionSubmenu.call(a.$node,a.$menu))}a.$node.addClass(d.classNames.iconLoadingClass);b.then(function(a,d,b){"undefined"===typeof b&&g(void 0);c(a,d,b)}.bind(this,a,d),g.bind(this,a,d))}};b.fn.contextMenu=function(a){var g=this;if(0<this.length)if("undefined"===typeof a)this.first().trigger("contextmenu");else if("undefined"!==typeof a.x&&"undefined"!==typeof a.y)this.first().trigger(b.Event("contextmenu",{pageX:a.x,pageY:a.y,mouseButton:a.button}));else if("hide"===a){var c=
this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;c&&c.trigger("contextmenu:hide")}else"destroy"===a?b.contextMenu("destroy",{context:this}):b.isPlainObject(a)?(a.context=this,b.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");else b.each(d,function(){this.selector===g.selector&&(a.data=this,b.extend(a.data,{trigger:"demand"}))}),q.contextmenu.call(a.target,a);return this};b.contextMenu=function(a,g){"string"!==
typeof a&&(g=a,a="create");"string"===typeof g?g={selector:g}:"undefined"===typeof g&&(g={});var c=b.extend(!0,{},l,g||{}),e=b(document),k=e,f=!1;c.context&&c.context.length?(k=b(c.context).first(),c.context=k.get(0),f=!b(c.context).is(document)):c.context=document;switch(a){case "create":if(!c.selector)throw Error("No selector specified");if(c.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+c.selector+'" as it contains a reserved className');if(!c.build&&
(!c.items||b.isEmptyObject(c.items)))throw Error("No Items specified");m++;c.ns=".contextMenu"+m;f||(n[c.selector]=c.ns);d[c.ns]=c;c.trigger||(c.trigger="right");h||(a={"contextmenu:focus.contextMenu":q.focusItem,"contextmenu:blur.contextMenu":q.blurItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.itemMouseenter,"mouseleave.contextMenu":q.itemMouseleave},a["click"===c.itemClickEvent?"click.contextMenu":"mouseup.contextMenu"]=q.itemClick,e.on({"contextmenu:hide.contextMenu":q.hideMenu,
"prevcommand.contextMenu":q.prevItem,"nextcommand.contextMenu":q.nextItem,"contextmenu.contextMenu":q.abortevent,"mouseenter.contextMenu":q.menuMouseenter,"mouseleave.contextMenu":q.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",q.inputClick).on(a,".context-menu-item"),h=!0);k.on("contextmenu"+c.ns,c.selector,c,q.contextmenu);if(f)k.on("remove"+c.ns,function(){b(this).contextMenu("destroy")});switch(c.trigger){case "hover":k.on("mouseenter"+c.ns,c.selector,c,
q.mouseenter).on("mouseleave"+c.ns,c.selector,c,q.mouseleave);break;case "left":k.on("click"+c.ns,c.selector,c,q.click);break;case "touchstart":k.on("touchstart"+c.ns,c.selector,c,q.click)}c.build||t.create(c);break;case "destroy":if(f){var r=c.context;b.each(d,function(a,g){if(!g||!b(r).is(g.selector))return!0;u=b(".context-menu-list").filter(":visible");u.length&&u.data().contextMenuRoot.$trigger.is(b(g.context).find(g.selector))&&u.trigger("contextmenu:hide",{force:!0});try{d[g.ns].$menu&&d[g.ns].$menu.remove(),
delete d[g.ns]}catch(z){d[g.ns]=null}b(g.context).off(g.ns);return!0})}else if(!c.selector)e.off(".contextMenu .contextMenuAutoHide"),b.each(d,function(a,d){b(d.context).off(d.ns)}),n={},d={},m=0,h=!1,b("#context-menu-layer, .context-menu-list").remove();else if(n[c.selector]){var u=b(".context-menu-list").filter(":visible");u.length&&u.data().contextMenuRoot.$trigger.is(c.selector)&&u.trigger("contextmenu:hide",{force:!0});try{d[n[c.selector]].$menu&&d[n[c.selector]].$menu.remove(),delete d[n[c.selector]]}catch(K){d[n[c.selector]]=
null}e.off(n[c.selector])}break;case "html5":(!b.support.htmlCommand&&!b.support.htmlMenuitem||"boolean"===typeof g&&g)&&b('menu[type="context"]').each(function(){this.id&&b.contextMenu({selector:"[contextmenu="+this.id+"]",items:b.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+a+'"');}return this};b.contextMenu.setInputValues=function(a,d){"undefined"===typeof d&&(d={});b.each(a.inputs,function(a,b){switch(b.type){case "text":case "textarea":b.value=
d[a]||"";break;case "checkbox":b.selected=d[a]?!0:!1;break;case "radio":b.selected=(d[b.radio]||"")===b.value;break;case "select":b.selected=d[a]||""}})};b.contextMenu.getInputValues=function(a,d){"undefined"===typeof d&&(d={});b.each(a.inputs,function(a,b){switch(b.type){case "text":case "textarea":case "select":d[a]=b.$input.val();break;case "checkbox":d[a]=b.$input.prop("checked");break;case "radio":b.$input.prop("checked")&&(d[b.radio]=b.value)}});return d};b.contextMenu.fromMenu=function(a){a=
b(a);var d={};c(d,a.children());return d};b.contextMenu.defaults=l;b.contextMenu.types=g;b.contextMenu.handle=q;b.contextMenu.op=t;b.contextMenu.menus=d});jQuery.cookie=function(b,f,a){if("undefined"!=typeof f){a=a||{};null===f&&(f="",a.expires=-1);var c="";a.expires&&("number"==typeof a.expires||a.expires.toUTCString)&&("number"==typeof a.expires?(c=new Date,c.setTime(c.getTime()+864E5*a.expires)):c=a.expires,c="; expires="+c.toUTCString());var e=a.path?"; path="+a.path:"",h=a.domain?"; domain="+a.domain:"";a=a.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(f),c,e,h,a].join("")}else{f=null;if(document.cookie&&""!=document.cookie)for(a=
document.cookie.split(";"),c=0;c<a.length;c++)if(e=jQuery.trim(a[c]),e.substring(0,b.length+1)==b+"="){f=decodeURIComponent(e.substring(b.length+1));break}return f}};var dia={exception:function(b){$("#modal-dynamicException .modal-title").html("Exception: "+b.string);$("#modal-dynamicException .modal-body").html(b.details);$("#modal-dynamicException").modal();console.log("Stack trace for "+b.string+":");console.log(b.trace)},error:function(b){console.log("Error: "+b);$("#modal-dynamicError .modal-body").html(b);$("#modal-dynamicError").modal()},info:function(b,f){$.notify({message:b},{type:f?f:"info",placement:{from:"top",align:"center"},delay:3E3})},confirm:function(b,
f){$("#modal-dynamicConfirm .modal-title").text(f);$("#modal-dynamicConfirm .modal-body").html(b.text);$("#modal-dynamicConfirm button[name=confirm]").off("click").on("click",function(){if("undefined"!==typeof b["true"])b["true"]();$("#modal-dynamicConfirm").modal("hide")});$("#modal-dynamicConfirm button[name=cancel]").off("click").on("click",function(){if("undefined"!==typeof b["false"])b["false"]();$("#modal-dynamicConfirm").modal("hide")});$("#modal-dynamicConfirm").modal()},full:function(b){$("#modal-dynamicFull .modal-title").text(b.title);
$("#modal-dynamicFull .modal-body").html(b.content);$("#modal-dynamicFull").modal();$("#modal-dynamicFull .modal-footer").html("");jQuery.each(b.buttons,function(b,a){$("#modal-dynamicFull .modal-footer").append($("<button>").attr("class","btn btn-secondary").text(b).click(function(){a();$("#modal-dynamicFull").modal("hide");return!1}))});"undefined"!==typeof b.oF&&b.oF();if("undefined"!==typeof b.cF)$("#modal-dynamicFull").on("hidden.bs.modal",function(){b.cF()})}};(function(b){"function"===typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],b):"object"===typeof exports?b(require("jquery"),require("./vendor/jquery.ui.widget")):b(window.jQuery)})(function(b){function f(a){var c="dragover"===a;return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var h=e.dataTransfer;h&&-1!==b.inArray("Files",h.types)&&!1!==this._trigger(a,b.Event(a,{delegatedEvent:e}))&&(e.preventDefault(),c&&(h.dropEffect="copy"))}}b.support.fileInput=
!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),
pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},
i18n:function(a,c){a=this.messages[a]||a.toString();c&&b.each(c,function(b,c){a=a.replace("{"+b+"}",c)});return a},formData:function(a){return a.serializeArray()},add:function(a,c){if(a.isDefaultPrevented())return!1;(c.autoUpload||!1!==c.autoUpload&&b(this).fileupload("option","autoUpload"))&&c.process().done(function(){c.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&
function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,e){var c=a-this.timestamp;if(!this.bitrate||!e||c>e)this.bitrate=1E3/c*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(a){if("function"===
b.type(a.formData))return a.formData(a.form);if(b.isArray(a.formData))return a.formData;if("object"===b.type(a.formData)){var c=[];b.each(a.formData,function(a,b){c.push({name:a,value:b})});return c}return[]},_getTotal:function(a){var c=0;b.each(a,function(a,b){c+=b.size||1});return c},_initProgressObject:function(a){var c={loaded:0,total:0,bitrate:0};a._progress?b.extend(a._progress,c):a._progress=c},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&
delete a._response[b];else a._response={}},_onProgress:function(a,c){if(a.lengthComputable){var e=Date.now?Date.now():(new Date).getTime();if(!(c._time&&c.progressInterval&&e-c._time<c.progressInterval&&a.loaded!==a.total)){c._time=e;var h=Math.floor(a.loaded/a.total*(c.chunkSize||c._progress.total))+(c.uploadedBytes||0);this._progress.loaded+=h-c._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(e,this._progress.loaded,c.bitrateInterval);c._progress.loaded=c.loaded=h;c._progress.bitrate=
c.bitrate=c._bitrateTimer.getBitrate(e,h,c.bitrateInterval);this._trigger("progress",b.Event("progress",{delegatedEvent:a}),c);this._trigger("progressall",b.Event("progressall",{delegatedEvent:a}),this._progress)}}},_initProgressListener:function(a){var c=this,e=a.xhr?a.xhr():b.ajaxSettings.xhr();e.upload&&(b(e.upload).bind("progress",function(b){var e=b.originalEvent;b.lengthComputable=e.lengthComputable;b.loaded=e.loaded;b.total=e.total;c._onProgress(b,a)}),a.xhr=function(){return e})},_isInstanceOf:function(a,
b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var c=this,e=a.files[0],h=a.multipart||!b.support.xhrFileUpload,k="array"===b.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=b.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);h&&!a.blob&&this._isInstanceOf("File",e)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"');if(!h)a.contentType=e.type||"application/octet-stream",a.data=a.blob||e;
else if(b.support.xhrFormDataFileUpload){if(a.postMessage){var f=this._getFormData(a);a.blob?f.push({name:k,value:a.blob}):b.each(a.files,function(c,d){f.push({name:"array"===b.type(a.paramName)&&a.paramName[c]||k,value:d})})}else c._isInstanceOf("FormData",a.formData)?f=a.formData:(f=new FormData,b.each(this._getFormData(a),function(a,d){f.append(d.name,d.value)})),a.blob?f.append(k,a.blob,e.name):b.each(a.files,function(e,d){(c._isInstanceOf("File",d)||c._isInstanceOf("Blob",d))&&f.append("array"===
b.type(a.paramName)&&a.paramName[e]||k,d,d.uploadName||d.name)});a.data=f}a.blob=null},_initIframeSettings:function(a){var c=b("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&c&&c!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&
(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var c=b(a.fileInput),e=a.paramName;e?b.isArray(e)||(e=[e]):(e=[],c.each(function(){var a=b(this),c=a.prop("name")||"files[]";for(a=(a.prop("files")||[1]).length;a;)e.push(c),--a}),e.length||(e=[c.prop("name")||"files[]"]));return e},_initFormSettings:function(a){a.form&&a.form.length||(a.form=b(a.fileInput.prop("form")),a.form.length||(a.form=b(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);
a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===b.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=b.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?
"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,c,e){var h=b.Deferred(),f=h.promise();c=c||this.options.context||f;!0===a?h.resolveWith(c,e):!1===a&&h.rejectWith(c,e);f.abort=h.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(a,c){var e=this,h=function(a){return b.Deferred().resolveWith(e,a).promise()};c.process=function(a,f){if(a||f)c._processQueue=this._processQueue=(this._processQueue||
h([this])).then(function(){return c.errorThrown?b.Deferred().rejectWith(e,[c]).promise():h(arguments)}).then(a,f);return this._processQueue||h([this])};c.submit=function(){"pending"!==this.state()&&(c.jqXHR=this.jqXHR=!1!==e._trigger("submit",b.Event("submit",{delegatedEvent:a}),this)&&e._onSend(a,this));return this.jqXHR||e._getXHRPromise()};c.abort=function(){if(this.jqXHR)return this.jqXHR.abort();this.errorThrown="abort";e._trigger("fail",null,this);return e._getXHRPromise(!1)};c.state=function(){if(this.jqXHR)return e._getDeferredState(this.jqXHR);
if(this._processQueue)return e._getDeferredState(this._processQueue)};c.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===e._getDeferredState(this._processQueue)};c.progress=function(){return this._progress};c.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,c){a.uploadedBytes=a.uploadedBytes||0;var e=this,h=a.files[0],f=h.size,
m=a.uploadedBytes,n=a.maxChunkSize||f,d=this._blobSlice,g=b.Deferred(),l=g.promise(),r;if(!(this._isXHRUpload(a)&&d&&(m||("function"===b.type(n)?n(a):n)<f))||a.data)return!1;if(c)return!0;if(m>=f)return h.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",h.error]);var w=function(){var c=b.extend({},a),l=c._progress.loaded;c.blob=d.call(h,m,m+("function"===b.type(n)?n(c):n),h.type);c.chunkSize=c.blob.size;c.contentRange="bytes "+m+"-"+(m+c.chunkSize-1)+"/"+f;e._initXHRData(c);
e._initProgressListener(c);r=(!1!==e._trigger("chunksend",null,c)&&b.ajax(c)||e._getXHRPromise(!1,c.context)).done(function(d,h,k){m=e._getUploadedBytes(k)||m+c.chunkSize;l+c.chunkSize-c._progress.loaded&&e._onProgress(b.Event("progress",{lengthComputable:!0,loaded:m-c.uploadedBytes,total:m-c.uploadedBytes}),c);a.uploadedBytes=c.uploadedBytes=m;c.result=d;c.textStatus=h;c.jqXHR=k;e._trigger("chunkdone",null,c);e._trigger("chunkalways",null,c);m<f?w():g.resolveWith(c.context,[d,h,k])}).fail(function(a,
d,b){c.jqXHR=a;c.textStatus=d;c.errorThrown=b;e._trigger("chunkfail",null,c);e._trigger("chunkalways",null,c);g.rejectWith(c.context,[a,d,b])})};this._enhancePromise(l);l.abort=function(){return r.abort()};w();return l},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||
0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,c,e,h){var f=h._progress.total,m=h._response;h._progress.loaded<f&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:f,total:f}),h);m.result=h.result=a;m.textStatus=h.textStatus=c;m.jqXHR=h.jqXHR=e;this._trigger("done",null,h)},_onFail:function(a,b,e,h){var c=h._response;h.recalculateProgress&&(this._progress.loaded-=
h._progress.loaded,this._progress.total-=h._progress.total);c.jqXHR=h.jqXHR=a;c.textStatus=h.textStatus=b;c.errorThrown=h.errorThrown=e;this._trigger("fail",null,h)},_onAlways:function(a,b,e,h){this._trigger("always",null,h)},_onSend:function(a,c){c.submit||this._addConvenienceMethods(a,c);var e=this,h,f,m=e._getAJAXSettings(c),n=function(){e._sending+=1;m._bitrateTimer=new e._BitrateTimer;return h=h||((f||!1===e._trigger("send",b.Event("send",{delegatedEvent:a}),m))&&e._getXHRPromise(!1,m.context,
f)||e._chunkedUpload(m)||b.ajax(m)).done(function(a,d,b){e._onDone(a,d,b,m)}).fail(function(a,d,b){e._onFail(a,d,b,m)}).always(function(a,d,b){e._onAlways(a,d,b,m);--e._sending;--e._active;if(m.limitConcurrentUploads&&m.limitConcurrentUploads>e._sending)for(a=e._slots.shift();a;){if("pending"===e._getDeferredState(a)){a.resolve();break}a=e._slots.shift()}0===e._active&&e._trigger("stop")})};this._beforeSend(a,m);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=
this._sending){if(1<this.options.limitConcurrentUploads){var d=b.Deferred();this._slots.push(d);c=d.then(n)}else c=this._sequence=this._sequence.then(n,n);c.abort=function(){f=[void 0,"abort","abort"];return h?h.abort():(d&&d.rejectWith(m.context,f),n())};return this._enhancePromise(c)}return n()},_onAdd:function(a,c){var e=this,h=!0,f=b.extend({},this.options,c),m=c.files,n=m.length,d=f.limitMultiFileUploads,g=f.limitMultiFileUploadSize,l=f.limitMultiFileUploadSizeOverhead,r=0,w=this._getParamName(f),
u=0;if(!n)return!1;g&&void 0===m[0].size&&(g=void 0);if((f.singleFileUploads||d||g)&&this._isXHRUpload(f))if(f.singleFileUploads||g||!d)if(!f.singleFileUploads&&g){var B=[];var C=[];for(f=0;f<n;f+=1)if(r+=m[f].size+l,f+1===n||r+m[f+1].size+l>g||d&&f+1-u>=d)B.push(m.slice(u,f+1)),r=w.slice(u,f+1),r.length||(r=w),C.push(r),u=f+1,r=0}else C=w;else for(B=[],C=[],f=0;f<n;f+=d)B.push(m.slice(f,f+d)),r=w.slice(f,f+d),r.length||(r=w),C.push(r);else B=[m],C=[w];c.originalFiles=m;b.each(B||m,function(d,g){var l=
b.extend({},c);l.files=B?g:[g];l.paramName=C[d];e._initResponseObject(l);e._initProgressObject(l);e._addConvenienceMethods(a,l);return h=e._trigger("add",b.Event("add",{delegatedEvent:a}),l)});return h},_replaceFileInput:function(a){var c=a.fileInput,e=c.clone(!0),f=c.is(document.activeElement);a.fileInputClone=e;b("<form></form>").append(e)[0].reset();c.after(e).detach();f&&e.focus();b.cleanData(c.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(a,b){return b===c[0]?e[0]:
b});c[0]===this.element[0]&&(this.element=e)},_handleFileTreeEntry:function(a,c){var e=this,f=b.Deferred(),k=[],m=function(d){d&&!d.entry&&(d.entry=a);f.resolve([d])},n=function(d){e._handleFileTreeEntries(d,c+a.name+"/").done(function(a){f.resolve(a)}).fail(m)},d=function(){g.readEntries(function(a){a.length?(k=k.concat(a),d()):n(k)},m)};c=c||"";if(a.isFile)a._file?(a._file.relativePath=c,f.resolve(a._file)):a.file(function(a){a.relativePath=c;f.resolve(a)},m);else if(a.isDirectory){var g=a.createReader();
d()}else f.resolve([]);return f.promise()},_handleFileTreeEntries:function(a,c){var e=this;return b.when.apply(b,b.map(a,function(a){return e._handleFileTreeEntry(a,c)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var c=a.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(b.map(c,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):
b.Deferred().resolve(b.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=b(a);var c=a.prop("webkitEntries")||a.prop("entries");if(c&&c.length)return this._handleFileTreeEntries(c);c=b.makeArray(a.prop("files"));if(c.length)void 0===c[0].name&&c[0].fileName&&b.each(c,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return b.Deferred().resolve([]).promise();c=[{name:a.replace(/^.*\\/,"")}]}return b.Deferred().resolve(c).promise()},_getFileInputFiles:function(a){return a instanceof
b&&1!==a.length?b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var c=this,e={fileInput:b(a.target),form:b(a.target.form)};this._getFileInputFiles(e.fileInput).always(function(f){e.files=f;c.options.replaceFileInput&&c._replaceFileInput(e);!1!==c._trigger("change",b.Event("change",{delegatedEvent:a}),e)&&c._onAdd(a,e)})},_onPaste:function(a){var c=a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.items,e={files:[]};c&&c.length&&(b.each(c,function(a,b){(a=b.getAsFile&&b.getAsFile())&&e.files.push(a)}),!1!==this._trigger("paste",b.Event("paste",{delegatedEvent:a}),e)&&this._onAdd(a,e))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var c=this,e=a.dataTransfer,f={};e&&e.files&&e.files.length&&(a.preventDefault(),this._getDroppedFiles(e).always(function(e){f.files=e;!1!==c._trigger("drop",b.Event("drop",{delegatedEvent:a}),f)&&c._onAdd(a,
f)}))},_onDragOver:f("dragover"),_onDragEnter:f("dragenter"),_onDragLeave:f("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");
this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(a,c){var e=-1!==b.inArray(a,this._specialOptions);e&&this._destroyEventHandlers();this._super(a,c);e&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof
b||(a.fileInput=b(a.fileInput));a.dropZone instanceof b||(a.dropZone=b(a.dropZone));a.pasteZone instanceof b||(a.pasteZone=b(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),b)},_isRegExpOption:function(a,c){return"url"!==a&&"string"===b.type(c)&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var a=this,c=this.options,e=this.element.data();b.each(this.element[0].attributes,function(b,f){b=f.name.toLowerCase();/^data-/.test(b)&&
(b=b.slice(5).replace(/-[a-z]/g,function(a){return a.charAt(1).toUpperCase()}),f=e[b],a._isRegExpOption(b,f)&&(f=a._getRegExp(f)),c[b]=f)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var c=this;a&&!this.options.disabled&&(a.fileInput&&
!a.files?this._getFileInputFiles(a.fileInput).always(function(b){a.files=b;c._onAdd(null,a)}):(a.files=b.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var c=this,e=b.Deferred(),f=e.promise(),k,m;f.abort=function(){m=!0;if(k)return k.abort();e.reject(null,"abort","abort");return f};this._getFileInputFiles(a.fileInput).always(function(b){m||(b.length?(a.files=b,k=c._onSend(null,a),k.then(function(a,b,c){e.resolve(a,b,c)},function(a,
b,c){e.reject(a,b,c)})):e.reject())});return this._enhancePromise(f)}a.files=b.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});/*
 jQuery hashchange event - v1.3 - 7/21/2010
 http://benalman.com/projects/jquery-hashchange-plugin/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(b,f,a){function c(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var e=document,h=b.event.special,k=e.documentMode,m="onhashchange"in f&&(k===a||7<k);b.fn.hashchange=function(a){return a?this.bind("hashchange",a):this.trigger("hashchange")};b.fn.hashchange.delay=50;h.hashchange=b.extend(h.hashchange,{setup:function(){if(m)return!1;b(n.start)},teardown:function(){if(m)return!1;b(n.stop)}});var n=function(){function d(){var a=c(),g=B(h);a!==h?(u(h=a,g),b(f).trigger("hashchange")):
g!==h&&(location.href=location.href.replace(/#.*/,"")+g);l=setTimeout(d,b.fn.hashchange.delay)}var g={},l,h=c(),k=function(a){return a},u=k,B=k;g.start=function(){l||d()};g.stop=function(){l&&clearTimeout(l);l=a};navigator.userAgent.match(/msie [6,7,8]/i)&&!m&&function(){var a,l;g.start=function(){a||(l=(l=b.fn.hashchange.src)&&l+c(),a=b('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){l||u(c());d()}).attr("src",l||"javascript:0").insertAfter("body")[0].contentWindow,e.onpropertychange=
function(){try{"title"===event.propertyName&&(a.document.title=e.title)}catch(t){}})};g.stop=k;B=function(){return c(a.location.href)};u=function(d,g){var c=a.document,l=b.fn.hashchange.domain;d!==g&&(c.title=e.title,c.open(),l&&c.write('<script>document.domain="'+l+'"\x3c/script>'),c.close(),a.location.hash=d)}}();return g}()})(jQuery,this);var notify={webkitNotifySupported:function(){return"Notification"in window},webkitNotifyRequest:function(){window.Notification.requestPermission()},webkitNotify:function(b,f,a){"granted"!=window.Notification.permission?notify.webkitNotifyRequest():new window.Notification(f,{body:a,icon:b,tag:"fm-notify"})}};/*
 SerializeJSON jQuery plugin.
  https://github.com/marioizquierdo/jquery.serializeJSON
  version 2.9.0 (Jan, 2018)

  Copyright (c) 2012-2018 Mario Izquierdo
  Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
  and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
*/
(function(b){if("function"===typeof define&&define.amd)define(["jquery"],b);else if("object"===typeof exports){var f=require("jquery");module.exports=b(f)}else b(window.jQuery||window.Zepto||window.$)})(function(b){b.fn.serializeJSON=function(f){var a,c,e,h,k,m,n,d;var g=b.serializeJSON;var l=this;var r=g.setupOpts(f);f=l.serializeArray();g.readCheckboxUncheckedValues(f,r,l);var w={};b.each(f,function(b,f){a=f.name;c=f.value;h=g.extractTypeAndNameWithNoType(a);k=h.nameWithNoType;(m=h.type)||(m=g.attrFromInputWithName(l,
a,"data-value-type"));g.validateType(a,m,r);"skip"!==m&&(n=g.splitInputNameIntoKeysArray(k),e=g.parseValue(c,a,m,r),(d=!e&&g.shouldSkipFalsy(l,a,k,m,r))||g.deepSet(w,n,e,r))});return w};b.serializeJSON={defaultOptions:{checkboxUncheckedValue:void 0,parseNumbers:!1,parseBooleans:!1,parseNulls:!1,parseAll:!1,parseWithFunction:null,skipFalsyValuesForTypes:[],skipFalsyValuesForFields:[],customTypes:{},defaultTypes:{string:function(b){return String(b)},number:function(b){return Number(b)},"boolean":function(b){return-1===
["false","null","undefined","","0"].indexOf(b)},"null":function(b){return-1===["false","null","undefined","","0"].indexOf(b)?b:null},array:function(b){return JSON.parse(b)},object:function(b){return JSON.parse(b)},auto:function(f){return b.serializeJSON.parseValue(f,null,null,{parseNumbers:!0,parseBooleans:!0,parseNulls:!0})},skip:null},useIntKeysAsArrayIndex:!1},setupOpts:function(f){var a=b.serializeJSON;null==f&&(f={});var c=a.defaultOptions||{};a="checkboxUncheckedValue parseNumbers parseBooleans parseNulls parseAll parseWithFunction skipFalsyValuesForTypes skipFalsyValuesForFields customTypes defaultTypes useIntKeysAsArrayIndex".split(" ");
for(e in f)if(-1===a.indexOf(e))throw Error("serializeJSON ERROR: invalid option '"+e+"'. Please use one of "+a.join(", "));var e=function(a){return!1!==f[a]&&""!==f[a]&&(f[a]||c[a])};a=e("parseAll");return{checkboxUncheckedValue:e("checkboxUncheckedValue"),parseNumbers:a||e("parseNumbers"),parseBooleans:a||e("parseBooleans"),parseNulls:a||e("parseNulls"),parseWithFunction:e("parseWithFunction"),skipFalsyValuesForTypes:e("skipFalsyValuesForTypes"),skipFalsyValuesForFields:e("skipFalsyValuesForFields"),
typeFunctions:b.extend({},e("defaultTypes"),e("customTypes")),useIntKeysAsArrayIndex:e("useIntKeysAsArrayIndex")}},parseValue:function(f,a,c,e){var h=b.serializeJSON;var k=f;e.typeFunctions&&c&&e.typeFunctions[c]?k=e.typeFunctions[c](f):e.parseNumbers&&h.isNumeric(f)?k=Number(f):!e.parseBooleans||"true"!==f&&"false"!==f?e.parseNulls&&"null"==f?k=null:e.typeFunctions&&e.typeFunctions.string&&(k=e.typeFunctions.string(f)):k="true"===f;e.parseWithFunction&&!c&&(k=e.parseWithFunction(k,a));return k},
isObject:function(b){return b===Object(b)},isUndefined:function(b){return void 0===b},isValidArrayIndex:function(b){return/^[0-9]+$/.test(String(b))},isNumeric:function(b){return 0<=b-parseFloat(b)},optionKeys:function(b){if(Object.keys)return Object.keys(b);var a,c=[];for(a in b)c.push(a);return c},readCheckboxUncheckedValues:function(f,a,c){var e,h;null==a&&(a={});c.find("input[type=checkbox][name]:not(:checked):not([disabled])").add(c.filter("input[type=checkbox][name]:not(:checked):not([disabled])")).each(function(c,
m){e=b(m);h=e.attr("data-unchecked-value");null==h&&(h=a.checkboxUncheckedValue);if(null!=h){if(m.name&&-1!==m.name.indexOf("[]["))throw Error("serializeJSON ERROR: checkbox unchecked values are not supported on nested arrays of objects like '"+m.name+"'. See https://github.com/marioizquierdo/jquery.serializeJSON/issues/67");f.push({name:m.name,value:h})}})},extractTypeAndNameWithNoType:function(b){var a;return(a=b.match(/(.*):([^:]+)$/))?{nameWithNoType:a[1],type:a[2]}:{nameWithNoType:b,type:null}},
shouldSkipFalsy:function(f,a,c,e,h){f=b.serializeJSON.attrFromInputWithName(f,a,"data-skip-falsy");if(null!=f)return"false"!==f;if((f=h.skipFalsyValuesForFields)&&(-1!==f.indexOf(c)||-1!==f.indexOf(a)))return!0;a=h.skipFalsyValuesForTypes;null==e&&(e="string");return a&&-1!==a.indexOf(e)?!0:!1},attrFromInputWithName:function(b,a,c){a='[name="'+a.replace(/(:|\.|\[|\]|\s)/g,"\\$1")+'"]';return b.find(a).add(b.filter(a)).attr(c)},validateType:function(f,a,c){var e=b.serializeJSON;c=e.optionKeys(c?c.typeFunctions:
e.defaultOptions.defaultTypes);if(a&&-1===c.indexOf(a))throw Error("serializeJSON ERROR: Invalid type "+a+" found in input name '"+f+"', please use one of "+c.join(", "));return!0},splitInputNameIntoKeysArray:function(f){f=f.split("[");f=b.map(f,function(a){return a.replace(/\]/g,"")});""===f[0]&&f.shift();return f},deepSet:function(f,a,c,e){null==e&&(e={});var h=b.serializeJSON;if(h.isUndefined(f))throw Error("ArgumentError: param 'o' expected to be an object or array, found undefined");if(!a||0===
a.length)throw Error("ArgumentError: param 'keys' expected to be an array with least one element");var k=a[0];if(1===a.length)""===k?f.push(c):f[k]=c;else{var m=a[1];if(""===k){k=f.length-1;var n=f[k];k=h.isObject(n)&&(h.isUndefined(n[m])||2<a.length)?k:k+1}if(""===m){if(h.isUndefined(f[k])||!b.isArray(f[k]))f[k]=[]}else if(e.useIntKeysAsArrayIndex&&h.isValidArrayIndex(m)){if(h.isUndefined(f[k])||!b.isArray(f[k]))f[k]=[]}else if(h.isUndefined(f[k])||!h.isObject(f[k]))f[k]={};a=a.slice(1);h.deepSet(f[k],
a,c,e)}}}});/*
 jQuery Typeahead
 Copyright (C) 2017 RunningCoder.org
 Licensed under the MIT license

 @author Tom Bertrand
 @version 2.10.4 (2017-10-17)
 @link http://www.runningcoder.org/jquerytypeahead/
*/
(function(b){"function"===typeof define&&define.amd?define("jquery-typeahead",["jquery"],function(f){return b(f)}):"object"===typeof module&&module.exports?module.exports=function(f,a){void 0===f&&(f="undefined"!==typeof window?require("jquery"):require("jquery")(a));return b(f)}():b(jQuery)})(function(b){window.Typeahead={version:"2.10.4"};var f={input:null,minLength:2,maxLength:!1,maxItem:8,dynamic:!1,delay:300,order:null,offset:!1,hint:!1,accent:!1,highlight:!0,multiselect:null,group:!1,groupOrder:null,
maxItemPerGroup:null,dropdownFilter:!1,dynamicFilter:null,backdrop:!1,backdropOnFocus:!1,cache:!1,ttl:36E5,compression:!1,searchOnFocus:!1,blurOnTab:!0,resultContainer:null,generateOnLoad:null,mustSelectItem:!1,href:null,display:["display"],template:null,templateValue:null,groupTemplate:null,correlativeTemplate:!1,emptyTemplate:!1,cancelButton:!0,loadingAnimation:!0,filter:!0,matcher:null,source:null,callback:{onInit:null,onReady:null,onShowLayout:null,onHideLayout:null,onSearch:null,onResult:null,
onLayoutBuiltBefore:null,onLayoutBuiltAfter:null,onNavigateBefore:null,onNavigateAfter:null,onEnter:null,onLeave:null,onClickBefore:null,onClickAfter:null,onDropdownFilter:null,onSendRequest:null,onReceiveRequest:null,onPopulateSource:null,onCacheSave:null,onSubmit:null,onCancel:null},selector:{container:"typeahead__container",result:"typeahead__result",list:"typeahead__list",group:"typeahead__group",item:"typeahead__item",empty:"typeahead__empty",display:"typeahead__display",query:"typeahead__query",
filter:"typeahead__filter",filterButton:"typeahead__filter-button",dropdown:"typeahead__dropdown",dropdownItem:"typeahead__dropdown-item",labelContainer:"typeahead__label-container",label:"typeahead__label",button:"typeahead__button",backdrop:"typeahead__backdrop",hint:"typeahead__hint",cancelButton:"typeahead__cancel-button"},debug:!1},a={from:"\u00e3\u00e0\u00e1\u00e4\u00e2\u1ebd\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u00f5\u00f2\u00f3\u00f6\u00f4\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7",to:"aaaaaeeeeeiiiiooooouuuunc"},
c=~window.navigator.appVersion.indexOf("MSIE 9."),e=~window.navigator.appVersion.indexOf("MSIE 10"),h=~window.navigator.userAgent.indexOf("Trident")?~window.navigator.userAgent.indexOf("rv:11"):!1,k=function(a,b){this.rawQuery=a.val()||"";this.query=a.val()||"";this.selector=a[0].selector;this.deferred=null;this.tmpSource={};this.source={};this.dynamicGroups=[];this.hasDynamicGroups=!1;this.generatedGroupCount=0;this.groupBy="group";this.groups=[];this.searchGroups=[];this.generateGroups=[];this.requestGroups=
[];this.result=[];this.tmpResult={};this.groupTemplate="";this.resultHtml=null;this.resultCount=0;this.resultCountPerGroup={};this.options=b;this.node=a;this.namespace="."+this.helper.slugify.call(this,this.selector)+".typeahead";this.isContentEditable="undefined"!==typeof this.node.attr("contenteditable")&&"false"!==this.node.attr("contenteditable");this.comparedItems=this.items=this.item=this.resultContainer=this.container=null;this.xhr={};this.hintIndex=null;this.filters={dropdown:{},dynamic:{}};
this.dropdownFilter={static:[],dynamic:[]};this.dropdownFilterAll=null;this.isDropdownEvent=!1;this.requests={};this.backdrop={};this.hint={};this.label={};this.focusOnly=this.hasDragged=!1;this.__construct()};k.prototype={_validateCacheMethod:function(a){var d=["localStorage","sessionStorage"];if(!0===a)a="localStorage";else if("string"===typeof a&&!~d.indexOf(a))return this.options.debug&&(n.log({node:this.selector,function:"extendOptions()",message:'Invalid options.cache, possible options are "localStorage" or "sessionStorage"'}),
n.print()),!1;d="undefined"!==typeof window[a];try{window[a].setItem("typeahead","typeahead"),window[a].removeItem("typeahead")}catch(l){d=!1}return d&&a||!1},extendOptions:function(){this.options.cache=this._validateCacheMethod(this.options.cache);!this.options.compression||"object"===typeof LZString&&this.options.cache||(this.options.debug&&(n.log({node:this.selector,function:"extendOptions()",message:"Missing LZString Library or options.cache, no compression will occur."}),n.print()),this.options.compression=
!1);if(!this.options.maxLength||isNaN(this.options.maxLength))this.options.maxLength=Infinity;"undefined"!==typeof this.options.maxItem&&~[0,!1].indexOf(this.options.maxItem)&&(this.options.maxItem=Infinity);this.options.maxItemPerGroup&&!/^\d+$/.test(this.options.maxItemPerGroup)&&(this.options.maxItemPerGroup=null);this.options.display&&!Array.isArray(this.options.display)&&(this.options.display=[this.options.display]);this.options.multiselect&&(this.items=[],this.comparedItems=[],"string"===typeof this.options.multiselect.matchOn&&
(this.options.multiselect.matchOn=[this.options.multiselect.matchOn]));this.options.group&&(Array.isArray(this.options.group)?this.options.debug&&(n.log({node:this.selector,function:"extendOptions()",message:"options.group must be a boolean|string|object as of 2.5.0"}),n.print()):("string"===typeof this.options.group?this.options.group={key:this.options.group}:"boolean"===typeof this.options.group&&(this.options.group={key:"group"}),this.options.group.key=this.options.group.key||"group"));this.options.highlight&&
!~["any",!0].indexOf(this.options.highlight)&&(this.options.highlight=!1);if(this.options.dropdownFilter&&this.options.dropdownFilter instanceof Object){Array.isArray(this.options.dropdownFilter)||(this.options.dropdownFilter=[this.options.dropdownFilter]);for(var d=0,g=this.options.dropdownFilter.length;d<g;++d)this.dropdownFilter[this.options.dropdownFilter[d].value?"static":"dynamic"].push(this.options.dropdownFilter[d])}this.options.dynamicFilter&&!Array.isArray(this.options.dynamicFilter)&&(this.options.dynamicFilter=
[this.options.dynamicFilter]);this.options.accent&&("object"===typeof this.options.accent?this.options.accent.from&&this.options.accent.to&&this.options.accent.from.length!==this.options.accent.to.length&&this.options.debug&&(n.log({node:this.selector,function:"extendOptions()",message:'Invalid "options.accent", from and to must be defined and same length.'}),n.print()):this.options.accent=a);this.options.groupTemplate&&(this.groupTemplate=this.options.groupTemplate);this.options.resultContainer&&
("string"===typeof this.options.resultContainer&&(this.options.resultContainer=b(this.options.resultContainer)),this.options.resultContainer instanceof b&&this.options.resultContainer[0]?this.resultContainer=this.options.resultContainer:this.options.debug&&(n.log({node:this.selector,function:"extendOptions()",message:'Invalid jQuery selector or jQuery Object for "options.resultContainer".'}),n.print()));this.options.maxItemPerGroup&&this.options.group&&this.options.group.key&&(this.groupBy=this.options.group.key);
this.options.callback&&this.options.callback.onClick&&(this.options.callback.onClickBefore=this.options.callback.onClick,delete this.options.callback.onClick);this.options.callback&&this.options.callback.onNavigate&&(this.options.callback.onNavigateBefore=this.options.callback.onNavigate,delete this.options.callback.onNavigate);this.options=b.extend(!0,{},f,this.options)},unifySourceFormat:function(){this.dynamicGroups=[];Array.isArray(this.options.source)&&(this.options.source={group:{data:this.options.source}});
"string"===typeof this.options.source&&(this.options.source={group:{ajax:{url:this.options.source}}});this.options.source.ajax&&(this.options.source={group:{ajax:this.options.source.ajax}});if(this.options.source.url||this.options.source.data)this.options.source={group:this.options.source};var a;for(a in this.options.source)if(this.options.source.hasOwnProperty(a)){var b=this.options.source[a];"string"===typeof b&&(b={ajax:{url:b}});var c=b.url||b.ajax;Array.isArray(c)?(b.ajax="string"===typeof c[0]?
{url:c[0]}:c[0],b.ajax.path=b.ajax.path||c[1]||null):"object"===typeof b.url?b.ajax=b.url:"string"===typeof b.url&&(b.ajax={url:b.url});delete b.url;if(!b.data&&!b.ajax)return this.options.debug&&(n.log({node:this.selector,function:"unifySourceFormat()",arguments:JSON.stringify(this.options.source),message:'Undefined "options.source.'+a+'.[data|ajax]" is Missing - Typeahead dropped'}),n.print()),!1;b.display&&!Array.isArray(b.display)&&(b.display=[b.display]);b.minLength="number"===typeof b.minLength?
b.minLength:this.options.minLength;b.maxLength="number"===typeof b.maxLength?b.maxLength:this.options.maxLength;b.dynamic="boolean"===typeof b.dynamic||this.options.dynamic;b.minLength>b.maxLength&&(b.minLength=b.maxLength);this.options.source[a]=b;this.options.source[a].dynamic&&this.dynamicGroups.push(a);b.cache="undefined"!==typeof b.cache?this._validateCacheMethod(b.cache):this.options.cache;!b.compression||"object"===typeof LZString&&b.cache||(this.options.debug&&(n.log({node:this.selector,function:"unifySourceFormat()",
message:"Missing LZString Library or group.cache, no compression will occur on group: "+a}),n.print()),b.compression=!1)}this.hasDynamicGroups=this.options.dynamic||!!this.dynamicGroups.length;return!0},init:function(){this.helper.executeCallback.call(this,this.options.callback.onInit,[this.node]);this.container=this.node.closest("."+this.options.selector.container);this.options.debug&&(n.log({node:this.selector,function:"init()",message:"OK - Typeahead activated on "+this.selector}),n.print())},
delegateEvents:function(){var a=this,g=["focus"+this.namespace,"input"+this.namespace,"propertychange"+this.namespace,"keydown"+this.namespace,"keyup"+this.namespace,"search"+this.namespace,"generate"+this.namespace];b("html").on("touchmove",function(){a.hasDragged=!0}).on("touchstart",function(){a.hasDragged=!1});this.node.closest("form").on("submit",function(b){if(a.options.mustSelectItem&&a.helper.isEmpty(a.item))b.preventDefault();else if(a.options.backdropOnFocus||a.hideLayout(),a.options.callback.onSubmit)return a.helper.executeCallback.call(a,
a.options.callback.onSubmit,[a.node,this,a.item||a.items,b])}).on("reset",function(){setTimeout(function(){a.node.trigger("input"+a.namespace);a.hideLayout()})});var l=!1;if(this.node.attr("placeholder")&&(e||h)){var f=!0;this.node.on("focusin focusout",function(){f=!(this.value||!this.placeholder)});this.node.on("input",function(a){f&&(a.stopImmediatePropagation(),f=!1)})}this.node.off(this.namespace).on(g.join(" "),function(d,g){switch(d.type){case "generate":a.generateSource(Object.keys(a.options.source));
break;case "focus":if(a.focusOnly){a.focusOnly=!1;break}a.options.backdropOnFocus&&(a.buildBackdropLayout(),a.showLayout());a.options.searchOnFocus&&!a.item&&(a.deferred=b.Deferred(),a.assignQuery(),a.generateSource());break;case "keydown":8===d.keyCode&&a.options.multiselect&&a.options.multiselect.cancelOnBackspace&&""===a.query&&a.items.length?a.cancelMultiselectItem(a.items.length-1,null,d):d.keyCode&&~[9,13,27,38,39,40].indexOf(d.keyCode)&&(l=!0,a.navigate(d));break;case "keyup":c&&a.node[0].value.replace(/^\s+/,
"").toString().length<a.query.length&&a.node.trigger("input"+a.namespace);break;case "propertychange":if(l){l=!1;break}case "input":a.deferred=b.Deferred();a.assignQuery();""===a.rawQuery&&""===a.query&&(d.originalEvent=g||{},a.helper.executeCallback.call(a,a.options.callback.onCancel,[a.node,d]));a.options.cancelButton&&a.toggleCancelButtonVisibility();a.options.hint&&a.hint.container&&""!==a.hint.container.val()&&0!==a.hint.container.val().indexOf(a.rawQuery)&&(a.hint.container.val(""),a.isContentEditable&&
a.hint.container.text(""));a.hasDynamicGroups?a.helper.typeWatch(function(){a.generateSource()},a.options.delay):a.generateSource();break;case "search":a.searchResult(),a.buildLayout(),a.result.length||a.searchGroups.length&&a.options.emptyTemplate&&a.query.length?a.showLayout():a.hideLayout(),a.deferred&&a.deferred.resolve()}return a.deferred&&a.deferred.promise()});this.options.generateOnLoad&&this.node.trigger("generate"+this.namespace)},assignQuery:function(){this.rawQuery=this.isContentEditable?
this.node.text():this.node.val().toString();this.rawQuery=this.rawQuery.replace(/^\s+/,"");this.rawQuery!==this.query&&(this.item=null,this.query=this.rawQuery)},filterGenerateSource:function(){this.searchGroups=[];this.generateGroups=[];if(!this.focusOnly||this.options.multiselect)for(var a in this.options.source)this.options.source.hasOwnProperty(a)&&this.query.length>=this.options.source[a].minLength&&this.query.length<=this.options.source[a].maxLength&&(this.searchGroups.push(a),!this.options.source[a].dynamic&&
this.source[a]||this.generateGroups.push(a))},generateSource:function(a){this.filterGenerateSource();if(Array.isArray(a)&&a.length)this.generateGroups=a;else if(!this.generateGroups.length){this.node.trigger("search"+this.namespace);return}this.requestGroups=[];this.generatedGroupCount=0;this.options.loadingAnimation&&this.container.addClass("loading");if(!this.helper.isEmpty(this.xhr)){for(var d in this.xhr)this.xhr.hasOwnProperty(d)&&this.xhr[d].abort();this.xhr={}}var c=this,e;d=0;for(var f=this.generateGroups.length;d<
f;++d){a=this.generateGroups[d];var h=this.options.source[a];var k=h.cache;var m=h.compression;if(k&&(e=window[k].getItem("TYPEAHEAD_"+this.selector+":"+a))){m&&(e=LZString.decompressFromUTF16(e));m=!1;try{e=JSON.parse(e+""),e.data&&e.ttl>(new Date).getTime()?(this.populateSource(e.data,a),m=!0,this.options.debug&&(n.log({node:this.selector,function:"generateSource()",message:'Source for group "'+a+'" found in '+k}),n.print())):window[k].removeItem("TYPEAHEAD_"+this.selector+":"+a)}catch(t){}if(m)continue}if(h.data&&
!h.ajax)if("function"===typeof h.data){var q=h.data.call(this);Array.isArray(q)?c.populateSource(q,a):"function"===typeof q.promise&&function(a){b.when(q).then(function(b){b&&Array.isArray(b)&&c.populateSource(b,a)})}(a)}else this.populateSource(b.extend(!0,[],h.data),a);else h.ajax&&(this.requests[a]||(this.requests[a]=this.generateRequestObject(a)),this.requestGroups.push(a))}this.requestGroups.length&&this.handleRequests();return!!this.generateGroups.length},generateRequestObject:function(a){var b=
this,d=this.options.source[a],c={request:{url:d.ajax.url||null,dataType:"json",beforeSend:function(c,g){b.xhr[a]=c;var e=b.requests[a].callback.beforeSend||d.ajax.beforeSend;"function"===typeof e&&e.apply(null,arguments)}},callback:{beforeSend:null,done:null,fail:null,then:null,always:null},extra:{path:d.ajax.path||null,group:a},validForGroup:[a]};if("function"!==typeof d.ajax&&(d.ajax instanceof Object&&(c=this.extendXhrObject(c,d.ajax)),1<Object.keys(this.options.source).length))for(var e in this.requests)this.requests.hasOwnProperty(e)&&
!this.requests[e].isDuplicated&&c.request.url&&c.request.url===this.requests[e].request.url&&(this.requests[e].validForGroup.push(a),c.isDuplicated=!0,delete c.validForGroup);return c},extendXhrObject:function(a,c){"object"===typeof c.callback&&(a.callback=c.callback,delete c.callback);"function"===typeof c.beforeSend&&(a.callback.beforeSend=c.beforeSend,delete c.beforeSend);a.request=b.extend(!0,a.request,c);"jsonp"!==a.request.dataType.toLowerCase()||a.request.jsonpCallback||(a.request.jsonpCallback=
"callback_"+a.extra.group);return a},handleRequests:function(){var a=this,c=this.requestGroups.length;if(!1!==this.helper.executeCallback.call(this,this.options.callback.onSendRequest,[this.node,this.query]))for(var e=0,f=this.requestGroups.length;e<f;++e){var h=this.requestGroups[e];this.requests[h].isDuplicated||function(d,g){if("function"===typeof a.options.source[d].ajax){var e=a.options.source[d].ajax.call(a,a.query);g=a.extendXhrObject(a.generateRequestObject(d),"object"===typeof e?e:{});if("object"!==
typeof g.request||!g.request.url){a.options.debug&&(n.log({node:a.selector,function:"handleRequests",message:'Source function must return an object containing ".url" key for group "'+d+'"'}),n.print());a.populateSource([],d);return}a.requests[d]=g}var l;d=!1;var f={};~g.request.url.indexOf("{{query}}")&&(d||(g=b.extend(!0,{},g),d=!0),g.request.url=g.request.url.replace("{{query}}",encodeURIComponent(a.query)));if(g.request.data)for(var h in g.request.data)if(g.request.data.hasOwnProperty(h)&&~String(g.request.data[h]).indexOf("{{query}}")){d||
(g=b.extend(!0,{},g),d=!0);g.request.data[h]=g.request.data[h].replace("{{query}}",a.query);break}b.ajax(g.request).done(function(b,d,c){for(var e,h=0,k=g.validForGroup.length;h<k;h++)e=g.validForGroup[h],l=a.requests[e],l.callback.done instanceof Function&&(f[e]=l.callback.done.call(a,b,d,c),Array.isArray(f[e])&&"object"===typeof f[e]||!a.options.debug||(n.log({node:a.selector,function:"Ajax.callback.done()",message:"Invalid returned data has to be an Array"}),n.print()))}).fail(function(b,d,c){for(var e=
0,f=g.validForGroup.length;e<f;e++)l=a.requests[g.validForGroup[e]],l.callback.fail instanceof Function&&l.callback.fail.call(a,b,d,c);a.options.debug&&(n.log({node:a.selector,function:"Ajax.callback.fail()",arguments:JSON.stringify(g.request),message:d}),console.log(c),n.print())}).always(function(b,d,e){for(var h,k=0,r=g.validForGroup.length;k<r;k++){h=g.validForGroup[k];l=a.requests[h];l.callback.always instanceof Function&&l.callback.always.call(a,b,d,e);if("object"!==typeof e)break;a.populateSource(null!==
b&&"function"===typeof b.promise&&[]||f[h]||b,l.extra.group,l.extra.path||l.request.path);--c;0===c&&a.helper.executeCallback.call(a,a.options.callback.onReceiveRequest,[a.node,a.query])}}).then(function(b,d){for(var c=0,e=g.validForGroup.length;c<e;c++)l=a.requests[g.validForGroup[c]],l.callback.then instanceof Function&&l.callback.then.call(a,b,d)})}(h,this.requests[h])}},populateSource:function(a,c,e){var d=this,g=this.options.source[c],l=g.ajax&&g.data;e&&"string"===typeof e&&(a=this.helper.namespace.call(this,
e,a));"undefined"===typeof a&&this.options.debug&&(n.log({node:this.selector,function:"populateSource()",arguments:e,message:"Invalid data path."}),n.print());Array.isArray(a)||(this.options.debug&&(n.log({node:this.selector,function:"populateSource()",arguments:JSON.stringify({group:c}),message:"Invalid data type, must be Array type."}),n.print()),a=[]);l&&("function"===typeof l&&(l=l()),Array.isArray(l)?a=a.concat(l):this.options.debug&&(n.log({node:this.selector,function:"populateSource()",arguments:JSON.stringify(l),
message:"WARNING - this.options.source."+c+".data Must be an Array or a function that returns an Array."}),n.print()));var f=g.display?"compiled"===g.display[0]?g.display[1]:g.display[0]:"compiled"===this.options.display[0]?this.options.display[1]:this.options.display[0],h=0;for(l=a.length;h<l;h++)if(null===a[h]||"boolean"===typeof a[h])this.options.debug&&(n.log({node:this.selector,function:"populateSource()",message:"WARNING - NULL/BOOLEAN value inside "+c+"! The data was skipped."}),n.print());
else{if("string"===typeof a[h]){var k={};k[f]=a[h];a[h]=k}a[h].group=c}if(!this.hasDynamicGroups&&this.dropdownFilter.dynamic.length){var m={};h=0;for(l=a.length;h<l;h++)for(var p=0,y=this.dropdownFilter.dynamic.length;p<y;p++)if(k=this.dropdownFilter.dynamic[p].key,f=a[h][k])this.dropdownFilter.dynamic[p].value||(this.dropdownFilter.dynamic[p].value=[]),m[k]||(m[k]=[]),~m[k].indexOf(f.toLowerCase())||(m[k].push(f.toLowerCase()),this.dropdownFilter.dynamic[p].value.push(f))}if(this.options.correlativeTemplate)if(l=
g.template||this.options.template,k="","function"===typeof l&&(l=l.call(this,"",{})),l){if(Array.isArray(this.options.correlativeTemplate))for(h=0,l=this.options.correlativeTemplate.length;h<l;h++)k+="{{"+this.options.correlativeTemplate[h]+"}} ";else k=l.replace(/<.+?>/g," ").replace(/\s{2,}/," ").trim();h=0;for(l=a.length;h<l;h++)a[h].compiled=b("<textarea />").html(k.replace(/\{\{([\w\-\.]+)(?:\|(\w+))?}}/g,function(b,c){return d.helper.namespace.call(d,c,a[h],"get","")}).trim()).text();g.display?
~g.display.indexOf("compiled")||g.display.unshift("compiled"):~this.options.display.indexOf("compiled")||this.options.display.unshift("compiled")}else this.options.debug&&(n.log({node:this.selector,function:"populateSource()",arguments:String(c),message:"WARNING - this.options.correlativeTemplate is enabled but no template was found."}),n.print());this.options.callback.onPopulateSource&&(a=this.helper.executeCallback.call(this,this.options.callback.onPopulateSource,[this.node,a,c,e]),!this.options.debug||
a&&Array.isArray(a)||(n.log({node:this.selector,function:"callback.populateSource()",message:'callback.onPopulateSource must return the "data" parameter'}),n.print()));this.tmpSource[c]=Array.isArray(a)&&a||[];g=this.options.source[c].cache;l=this.options.source[c].compression;k=this.options.source[c].ttl||this.options.ttl;g&&!window[g].getItem("TYPEAHEAD_"+this.selector+":"+c)&&(this.options.callback.onCacheSave&&(a=this.helper.executeCallback.call(this,this.options.callback.onCacheSave,[this.node,
a,c,e]),!this.options.debug||a&&Array.isArray(a)||(n.log({node:this.selector,function:"callback.populateSource()",message:'callback.onCacheSave must return the "data" parameter'}),n.print())),e=JSON.stringify({data:a,ttl:(new Date).getTime()+k}),l&&(e=LZString.compressToUTF16(e)),window[g].setItem("TYPEAHEAD_"+this.selector+":"+c,e));this.incrementGeneratedGroup()},incrementGeneratedGroup:function(){this.generatedGroupCount++;if(this.generatedGroupCount===this.generateGroups.length){this.xhr={};for(var a=
0,b=this.generateGroups.length;a<b;a++)this.source[this.generateGroups[a]]=this.tmpSource[this.generateGroups[a]];this.hasDynamicGroups||this.buildDropdownItemLayout("dynamic");this.options.loadingAnimation&&this.container.removeClass("loading");this.node.trigger("search"+this.namespace)}},navigate:function(a){this.helper.executeCallback.call(this,this.options.callback.onNavigateBefore,[this.node,this.query,a]);if(27===a.keyCode)a.preventDefault(),this.query.length?(this.resetInput(),this.node.trigger("input"+
this.namespace,[a])):(this.node.blur(),this.hideLayout());else if(this.result.length){var b=this.resultContainer.find("."+this.options.selector.item).not("[disabled]"),d=b.filter(".active"),c=d[0]?b.index(d):null,e=d[0]?d.attr("data-index"):null,f=null;this.clearActiveItem();this.helper.executeCallback.call(this,this.options.callback.onLeave,[this.node,null!==c&&b.eq(c)||void 0,null!==e&&this.result[e]||void 0,a]);13===a.keyCode?(a.preventDefault(),0<d.length?"javascript:;"===d.find("a:first")[0].href?
d.find("a:first").trigger("click",a):d.find("a:first")[0].click():this.node.closest("form").trigger("submit")):39===a.keyCode?null!==c?b.eq(c).find("a:first")[0].click():this.options.hint&&""!==this.hint.container.val()&&this.helper.getCaret(this.node[0])>=this.query.length&&b.filter('[data-index="'+this.hintIndex+'"]').find("a:first")[0].click():(9===a.keyCode?this.options.blurOnTab?this.hideLayout():0<d.length?c+1<b.length?(a.preventDefault(),f=c+1,this.addActiveItem(b.eq(f))):this.hideLayout():
b.length?(a.preventDefault(),f=0,this.addActiveItem(b.first())):this.hideLayout():38===a.keyCode?(a.preventDefault(),0<d.length?0<=c-1&&(f=c-1,this.addActiveItem(b.eq(f))):b.length&&(f=b.length-1,this.addActiveItem(b.last()))):40===a.keyCode&&(a.preventDefault(),0<d.length?c+1<b.length&&(f=c+1,this.addActiveItem(b.eq(f))):b.length&&(f=0,this.addActiveItem(b.first()))),d=null!==f?b.eq(f).attr("data-index"):null,this.helper.executeCallback.call(this,this.options.callback.onEnter,[this.node,null!==f&&
b.eq(f)||void 0,null!==d&&this.result[d]||void 0,a]),a.preventInputChange&&~[38,40].indexOf(a.keyCode)&&this.buildHintLayout(null!==d&&d<this.result.length?[this.result[d]]:null),this.options.hint&&this.hint.container&&this.hint.container.css("color",a.preventInputChange?this.hint.css.color:null===d&&this.hint.css.color||this.hint.container.css("background-color")||"fff"),c=null===d||a.preventInputChange?this.rawQuery:this.getTemplateValue.call(this,this.result[d]),this.node.val(c),this.isContentEditable&&
this.node.text(c),this.helper.executeCallback.call(this,this.options.callback.onNavigateAfter,[this.node,b,null!==f&&b.eq(f).find("a:first")||void 0,null!==d&&this.result[d]||void 0,this.query,a]))}},getTemplateValue:function(a){if(a){var b=a.group&&this.options.source[a.group].templateValue||this.options.templateValue;"function"===typeof b&&(b=b.call(this));if(!b)return this.helper.namespace.call(this,a.matchedKey,a).toString();var d=this;return b.replace(/\{\{([\w\-.]+)}}/gi,function(b,c){return d.helper.namespace.call(d,
c,a,"get","")})}},clearActiveItem:function(){this.resultContainer.find("."+this.options.selector.item).removeClass("active")},addActiveItem:function(a){a.addClass("active")},searchResult:function(){this.resetLayout();!1!==this.helper.executeCallback.call(this,this.options.callback.onSearch,[this.node,this.query])&&(!this.searchGroups.length||this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit||this.searchResultData(),this.helper.executeCallback.call(this,
this.options.callback.onResult,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]),this.isDropdownEvent&&(this.helper.executeCallback.call(this,this.options.callback.onDropdownFilter,[this.node,this.query,this.filters.dropdown,this.result]),this.isDropdownEvent=!1))},searchResultData:function(){var a=this.groupBy,c=null,e=this.query.toLowerCase(),f=this.options.maxItem,h=this.options.maxItemPerGroup,k=this.filters.dynamic&&!this.helper.isEmpty(this.filters.dynamic),m={},
C="function"===typeof this.options.matcher&&this.options.matcher;this.options.accent&&(e=this.helper.removeAccent.call(this,e));for(var q=0,t=this.searchGroups.length;q<t;++q){var p=this.searchGroups[q];if(!this.filters.dropdown||"group"!==this.filters.dropdown.key||this.filters.dropdown.value===p){var y="undefined"!==typeof this.options.source[p].filter?this.options.source[p].filter:this.options.filter;var E="function"===typeof this.options.source[p].matcher&&this.options.source[p].matcher||C;for(var D=
0,F=this.source[p].length;D<F&&(!(this.resultItemCount>=f)||this.options.callback.onResult);D++)if(!k||this.dynamicFilter.validate.apply(this,[this.source[p][D]])){var x=this.source[p][D];if(!(null===x||"boolean"===typeof x||this.options.multiselect&&!this.isMultiselectUniqueData(x)||this.filters.dropdown&&(x[this.filters.dropdown.key]||"").toLowerCase()!==(this.filters.dropdown.value||"").toLowerCase())){(c="group"===a?p:x[a]?x[a]:x.group)&&!this.tmpResult[c]&&(this.tmpResult[c]=[],this.resultCountPerGroup[c]=
0);if(h&&"group"===a&&this.tmpResult[c].length>=h&&!this.options.callback.onResult)break;var v=this.options.source[p].display||this.options.display;for(var A=0,K=v.length;A<K;++A){if(!1!==y){var H=/\./.test(v[A])?this.helper.namespace.call(this,v[A],x):x[v[A]];if("undefined"===typeof H||""===H){this.options.debug&&(m[A]={display:v[A],data:x});continue}H=this.helper.cleanStringFromScript(H)}if("function"===typeof y){var z=y.call(this,x,H);if(void 0===z)break;if(!z)continue;"object"===typeof z&&(x=
z)}if(~[void 0,!0].indexOf(y)){var G=H;G=G.toString().toLowerCase();this.options.accent&&(G=this.helper.removeAccent.call(this,G));z=G.indexOf(e);if(this.options.correlativeTemplate&&"compiled"===v[A]&&0>z&&/\s/.test(e)){var L=!0;var J=e.split(" ");for(var I=0,M=J.length;I<M;I++)if(""!==J[I]){if(!~G.indexOf(J[I])){L=!1;break}G=G.replace(J[I],"")}}if(0>z&&!L)continue;if(this.options.offset&&0!==z)continue;if(E){z=E.call(this,x,H);if(void 0===z)break;if(!z)continue;"object"===typeof z&&(x=z)}}this.resultCount++;
this.resultCountPerGroup[c]++;if(this.resultItemCount<f){if(h&&this.tmpResult[c].length>=h)break;this.tmpResult[c].push(b.extend(!0,{matchedKey:v[A]},x));this.resultItemCount++}break}if(!this.options.callback.onResult){if(this.resultItemCount>=f)break;if(h&&this.tmpResult[c].length>=h&&"group"===a)break}}}}}this.options.debug&&!this.helper.isEmpty(m)&&(n.log({node:this.selector,function:"searchResult()",arguments:JSON.stringify(m),message:"Missing keys for display, make sure options.display is set properly."}),
n.print());if(this.options.order)for(p in v=[],this.tmpResult)if(this.tmpResult.hasOwnProperty(p)){q=0;for(t=this.tmpResult[p].length;q<t;q++)a=this.options.source[this.tmpResult[p][q].group].display||this.options.display,~v.indexOf(a[0])||v.push(a[0]);this.tmpResult[p].sort(this.helper.sort(v,"asc"===this.options.order,function(a){return a.toString().toUpperCase()}))}p=[];v=[];v="function"===typeof this.options.groupOrder?this.options.groupOrder.apply(this,[this.node,this.query,this.tmpResult,this.resultCount,
this.resultCountPerGroup]):Array.isArray(this.options.groupOrder)?this.options.groupOrder:"string"===typeof this.options.groupOrder&&~["asc","desc"].indexOf(this.options.groupOrder)?Object.keys(this.tmpResult).sort(this.helper.sort([],"asc"===this.options.groupOrder,function(a){return a.toString().toUpperCase()})):Object.keys(this.tmpResult);q=0;for(t=v.length;q<t;q++)p=p.concat(this.tmpResult[v[q]]||[]);this.groups=JSON.parse(JSON.stringify(v));this.result=p},buildLayout:function(){this.buildHtmlLayout();
this.buildBackdropLayout();this.buildHintLayout();this.options.callback.onLayoutBuiltBefore&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltBefore,[this.node,this.query,this.result,this.resultHtml]);this.resultHtml instanceof b&&this.resultContainer.html(this.resultHtml);this.options.callback.onLayoutBuiltAfter&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltAfter,[this.node,this.query,this.result])},buildHtmlLayout:function(){if(!1!==this.options.resultContainer){this.resultContainer||
(this.resultContainer=b("<div/>",{class:this.options.selector.result}),this.container.append(this.resultContainer));if(!this.result.length)if(this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit)var a=this.options.multiselect.limitTemplate?"function"===typeof this.options.multiselect.limitTemplate?this.options.multiselect.limitTemplate.call(this,this.query):this.options.multiselect.limitTemplate.replace(/\{\{query}}/gi,b("<div>").text(this.helper.cleanStringFromScript(this.query)).html()):
"Can't select more than "+this.items.length+" items.";else if(this.options.emptyTemplate&&""!==this.query)a="function"===typeof this.options.emptyTemplate?this.options.emptyTemplate.call(this,this.query):this.options.emptyTemplate.replace(/\{\{query}}/gi,b("<div>").text(this.helper.cleanStringFromScript(this.query)).html());else return;var c=this.query.toLowerCase();this.options.accent&&(c=this.helper.removeAccent.call(this,c));var e=this,f=this.groupTemplate||"<ul></ul>",h=!1;this.groupTemplate?
f=b(f.replace(/<([^>]+)>\{\{(.+?)}}<\/[^>]+>/g,function(b,d,c,g,f){b="";c="group"===c?e.groups:[c];if(!e.result.length){if(!0===h)return"";h=!0;return"<"+d+' class="'+e.options.selector.empty+'">'+a+"</"+d+">"}g=0;for(f=c.length;g<f;++g)b+="<"+d+' data-group-template="'+c[g]+'"><ul></ul></'+d+">";return b})):(f=b(f),this.result.length||f.append(a instanceof b?a:'<li class="'+e.options.selector.empty+'">'+a+"</li>"));f.addClass(this.options.selector.list+(this.helper.isEmpty(this.result)?" empty":
""));for(var k,m,n,q,t,p,y,E,D,F=this.groupTemplate&&this.result.length&&e.groups||[],x,v=0,A=this.result.length;v<A;++v)n=this.result[v],k=n.group,q=!this.options.multiselect&&this.options.source[n.group].href||this.options.href,y=[],E=this.options.source[n.group].display||this.options.display,this.options.group&&(k=n[this.options.group.key],this.options.group.template&&("function"===typeof this.options.group.template?m=this.options.group.template.call(this,n):"string"===typeof this.options.group.template&&
(m=this.options.group.template.replace(/\{\{([\w\-\.]+)}}/gi,function(a,b){return e.helper.namespace.call(e,b,n,"get","")}))),f.find('[data-search-group="'+k+'"]')[0]||(this.groupTemplate?f.find('[data-group-template="'+k+'"] ul'):f).append(b("<li/>",{class:e.options.selector.group,html:b("<a/>",{href:"javascript:;",html:m||k,tabindex:-1}),"data-search-group":k}))),this.groupTemplate&&F.length&&(x=F.indexOf(k||n.group),~x&&F.splice(x,1)),q=b("<li/>",{class:e.options.selector.item+" "+e.options.selector.group+
"-"+this.helper.slugify.call(this,k),disabled:n.disabled?!0:!1,"data-group":k,"data-index":v,html:b("<a/>",{href:q&&!n.disabled?n.href=e.generateHref.call(e,q,n):"javascript:;",html:function(){if(t=n.group&&e.options.source[n.group].template||e.options.template)"function"===typeof t&&(t=t.call(e,e.query,n)),p=t.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(a,b,d){a=e.helper.cleanStringFromScript(String(e.helper.namespace.call(e,b,n,"get","")));d=d&&d.split("|")||[];~d.indexOf("slugify")&&(a=
e.helper.slugify.call(e,a));~d.indexOf("raw")||!0===e.options.highlight&&c&&~E.indexOf(b)&&(a=e.helper.highlight.call(e,a,c.split(" "),e.options.accent));return a});else{for(var a=0,d=E.length;a<d;a++)D=/\./.test(E[a])?e.helper.namespace.call(e,E[a],n,"get",""):n[E[a]],"undefined"!==typeof D&&""!==D&&y.push(D);p='<span class="'+e.options.selector.display+'">'+e.helper.cleanStringFromScript(String(y.join(" ")))+"</span>"}if(!0===e.options.highlight&&c&&!t||"any"===e.options.highlight)p=e.helper.highlight.call(e,
p,c.split(" "),e.options.accent);b(this).append(p)}})}),function(a,d,c){c.on("click",function(a,c){d.disabled?a.preventDefault():(c&&"object"===typeof c&&(a.originalEvent=c),e.options.mustSelectItem&&e.helper.isEmpty(d)?a.preventDefault():(e.options.multiselect?(e.items.push(d),e.comparedItems.push(e.getMultiselectComparedData(d))):e.item=d,!1===e.helper.executeCallback.call(e,e.options.callback.onClickBefore,[e.node,b(this),d,a])||a.originalEvent&&a.originalEvent.defaultPrevented||a.isDefaultPrevented()||
(c=e.getTemplateValue.call(e,d),e.options.multiselect?(e.query=e.rawQuery="",e.addMultiselectItemLayout(c)):(e.focusOnly=!0,e.query=e.rawQuery=c,e.isContentEditable&&(e.node.text(e.query),e.helper.setCaretAtEnd(e.node[0]))),e.hideLayout(),e.node.val(e.query).focus(),e.helper.executeCallback.call(e,e.options.callback.onClickAfter,[e.node,b(this),d,a]))))});c.on("mouseenter",function(a){d.disabled||(e.clearActiveItem(),e.addActiveItem(b(this)));e.helper.executeCallback.call(e,e.options.callback.onEnter,
[e.node,b(this),d,a])});c.on("mouseleave",function(a){d.disabled||e.clearActiveItem();e.helper.executeCallback.call(e,e.options.callback.onLeave,[e.node,b(this),d,a])})}(v,n,q),(this.groupTemplate?f.find('[data-group-template="'+k+'"] ul'):f).append(q);if(this.result.length&&F.length)for(v=0,A=F.length;v<A;++v)f.find('[data-group-template="'+F[v]+'"]').remove();this.resultHtml=f}},generateHref:function(a,b){var d=this;"string"===typeof a?a=a.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(a,c,
e){a=d.helper.namespace.call(d,c,b,"get","");e=e&&e.split("|")||[];~e.indexOf("slugify")&&(a=d.helper.slugify.call(d,a));return a}):"function"===typeof a&&(a=a.call(this,b));return a},getMultiselectComparedData:function(a){var b="";if(Array.isArray(this.options.multiselect.matchOn))for(var d=0,c=this.options.multiselect.matchOn.length;d<c;++d)b+="undefined"!==typeof a[this.options.multiselect.matchOn[d]]?a[this.options.multiselect.matchOn[d]]:"";else{a=JSON.parse(JSON.stringify(a));b=["group","matchedKey",
"compiled","href"];d=0;for(c=b.length;d<c;++d)delete a[b[d]];b=JSON.stringify(a)}return b},buildBackdropLayout:function(){this.options.backdrop&&(this.backdrop.container||(this.backdrop.css=b.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},this.options.backdrop),this.backdrop.container=b("<div/>",{class:this.options.selector.backdrop,css:this.backdrop.css}).insertAfter(this.container)),this.container.addClass("backdrop").css({"z-index":this.backdrop.css["z-index"]+
1,position:"relative"}))},buildHintLayout:function(a){if(this.options.hint)if(this.node[0].scrollWidth>Math.ceil(this.node.innerWidth()))this.hint.container&&this.hint.container.val("");else{var d=this,c="";a=a||this.result;var e=this.query.toLowerCase();this.options.accent&&(e=this.helper.removeAccent.call(this,e));this.hintIndex=null;if(this.searchGroups.length){this.hint.container||(this.hint.css=b.extend({"border-color":"transparent",position:"absolute",top:0,display:"inline","z-index":-1,float:"none",
color:"silver","box-shadow":"none",cursor:"default","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},this.options.hint),this.hint.container=b("<"+this.node[0].nodeName+"/>",{type:this.node.attr("type"),class:this.node.attr("class"),readonly:!0,unselectable:"on","aria-hidden":"true",tabindex:-1,click:function(){d.node.focus()}}).addClass(this.options.selector.hint).css(this.hint.css).insertAfter(this.node),this.node.parent().css({position:"relative"}));
this.hint.container.css("color",this.hint.css.color);if(e)for(var f,h,k=0,m=a.length;k<m;k++)if(!a[k].disabled){f=a[k].group;f=this.options.source[f].display||this.options.display;for(var n=0,t=f.length;n<t;n++)if(h=String(a[k][f[n]]).toLowerCase(),this.options.accent&&(h=this.helper.removeAccent.call(this,h)),0===h.indexOf(e)){c=String(a[k][f[n]]);this.hintIndex=k;break}if(null!==this.hintIndex)break}a=0<c.length&&this.rawQuery+c.substring(this.query.length)||"";this.hint.container.val(a);this.isContentEditable&&
this.hint.container.text(a)}}},buildDropdownLayout:function(){if(this.options.dropdownFilter){var a=this;b("<span/>",{class:this.options.selector.filter,html:function(){b(this).append(b("<button/>",{type:"button",class:a.options.selector.filterButton,style:"display: none;",click:function(){a.container.toggleClass("filter");var d=a.namespace+"-dropdown-filter";b("html").off(d);if(a.container.hasClass("filter"))b("html").on("click"+d+" touchend"+d,function(c){b(c.target).closest("."+a.options.selector.filter)[0]&&
b(c.target).closest(a.container)[0]||a.hasDragged||(a.container.removeClass("filter"),b("html").off(d))})}}));b(this).append(b("<ul/>",{class:a.options.selector.dropdown}))}}).insertAfter(a.container.find("."+a.options.selector.query))}},buildDropdownItemLayout:function(a){if(this.options.dropdownFilter){var d=this,c="string"===typeof this.options.dropdownFilter&&this.options.dropdownFilter||"All",e=this.container.find("."+this.options.selector.dropdown);"static"!==a||!0!==this.options.dropdownFilter&&
"string"!==typeof this.options.dropdownFilter||this.dropdownFilter.static.push({key:"group",template:"{{group}}",all:c,value:Object.keys(this.options.source)});for(var f=0,h=this.dropdownFilter[a].length;f<h;f++){var k=this.dropdownFilter[a][f];Array.isArray(k.value)||(k.value=[k.value]);k.all&&(this.dropdownFilterAll=k.all);for(var m=0,n=k.value.length;m<=n;m++)if(m!==n||f===h-1)if(m!==n||f!==h-1||"static"!==a||!this.dropdownFilter.dynamic.length){var t=this.dropdownFilterAll||c;k.value[m]?t=k.template?
k.template.replace(new RegExp("{{"+k.key+"}}","gi"),k.value[m]):k.value[m]:this.container.find("."+d.options.selector.filterButton).html(t);(function(a,g,f){e.append(b("<li/>",{class:d.options.selector.dropdownItem+" "+d.helper.slugify.call(d,g.key+"-"+(g.value[a]||c)),html:b("<a/>",{href:"javascript:;",html:f,click:function(b){b.preventDefault();b={key:g.key,value:g.value[a]||"*",template:f};"*"===b.value?delete d.filters.dropdown:d.filters.dropdown=b;d.container.removeClass("filter").find("."+d.options.selector.filterButton).html(b.template);
d.isDropdownEvent=!0;d.node.trigger("search"+d.namespace);d.options.multiselect&&d.adjustInputSize();d.node.focus()}})}))})(m,k,t)}}this.dropdownFilter[a].length&&this.container.find("."+d.options.selector.filterButton).removeAttr("style")}},dynamicFilter:{isEnabled:!1,init:function(){this.options.dynamicFilter&&(this.dynamicFilter.bind.call(this),this.dynamicFilter.isEnabled=!0)},validate:function(a){var b=null,d=null,c;for(c in this.filters.dynamic)if(this.filters.dynamic.hasOwnProperty(c)){var e=
~c.indexOf(".")?this.helper.namespace.call(this,c,a,"get"):a[c];"|"!==this.filters.dynamic[c].modifier||b||(b=e==this.filters.dynamic[c].value||!1);if("&"===this.filters.dynamic[c].modifier)if(e==this.filters.dynamic[c].value)d=!0;else{d=!1;break}}a=b;null!==d&&(a=d,!0===d&&null!==b&&(a=b));return!!a},set:function(a,b){a=a.match(/^([|&])?(.+)/);b?this.filters.dynamic[a[2]]={modifier:a[1]||"|",value:b}:delete this.filters.dynamic[a[2]];this.dynamicFilter.isEnabled&&this.generateSource()},bind:function(){for(var a=
this,c,e=0,f=this.options.dynamicFilter.length;e<f;e++)c=this.options.dynamicFilter[e],"string"===typeof c.selector&&(c.selector=b(c.selector)),c.selector instanceof b&&c.selector[0]&&c.key?function(b){b.selector.off(a.namespace).on("change"+a.namespace,function(){a.dynamicFilter.set.apply(a,[b.key,a.dynamicFilter.getValue(this)])}).trigger("change"+a.namespace)}(c):this.options.debug&&(n.log({node:this.selector,function:"buildDynamicLayout()",message:'Invalid jQuery selector or jQuery Object for "filter.selector" or missing filter.key'}),
n.print())},getValue:function(a){if("SELECT"===a.tagName)var b=a.value;else"INPUT"===a.tagName&&("checkbox"===a.type?b=a.checked&&a.getAttribute("value")||a.checked||null:"radio"===a.type&&a.checked&&(b=a.value));return b}},buildMultiselectLayout:function(){if(this.options.multiselect){var a=this;this.label.container=b("<span/>",{class:this.options.selector.labelContainer,"data-padding-left":parseFloat(this.node.css("padding-left"))||0,"data-padding-right":parseFloat(this.node.css("padding-right"))||
0,"data-padding-top":parseFloat(this.node.css("padding-top"))||0,click:function(d){b(d.target).hasClass(a.options.selector.labelContainer)&&a.node.focus()}});this.node.closest("."+this.options.selector.query).prepend(this.label.container);if(this.options.multiselect.data)if(Array.isArray(this.options.multiselect.data))this.populateMultiselectData(this.options.multiselect.data);else if("function"===typeof this.options.multiselect.data){var c=this.options.multiselect.data.call(this);Array.isArray(c)?
this.populateMultiselectData(c):"function"===typeof c.promise&&b.when(c).then(function(b){b&&Array.isArray(b)&&a.populateMultiselectData(b)})}}},isMultiselectUniqueData:function(a){for(var b=!0,d=0,c=this.comparedItems.length;d<c;++d)if(this.comparedItems[d]===this.getMultiselectComparedData(a)){b=!1;break}return b},populateMultiselectData:function(a){for(var b=0,d=a.length;b<d;++b)this.isMultiselectUniqueData(a[b])&&(this.items.push(a[b]),this.comparedItems.push(this.getMultiselectComparedData(a[b])),
this.addMultiselectItemLayout(this.getTemplateValue(a[b])));this.node.trigger("search"+this.namespace,{origin:"populateMultiselectData"})},addMultiselectItemLayout:function(a){var d=this;a=b("<span/>",{class:this.options.selector.label,html:b("<"+(this.options.multiselect.href?"a":"span")+"/>",{text:a,click:function(a){var c=b(this).closest("."+d.options.selector.label);c=d.label.container.find("."+d.options.selector.label).index(c);d.options.multiselect.callback&&d.helper.executeCallback.call(d,
d.options.multiselect.callback.onClick,[d.node,d.items[c],a])},href:this.options.multiselect.href?d.generateHref.call(d,d.options.multiselect.href,d.items[d.items.length-1]):null})});a.append(b("<span/>",{class:this.options.selector.cancelButton,html:"\u00d7",click:function(a){var c=b(this).closest("."+d.options.selector.label),e=d.label.container.find("."+d.options.selector.label).index(c);d.cancelMultiselectItem(e,c,a)}}));this.label.container.append(a);this.adjustInputSize()},cancelMultiselectItem:function(a,
b,c){var d=this.items[a];b=b||this.label.container.find("."+this.options.selector.label).eq(a);b.remove();this.items.splice(a,1);this.comparedItems.splice(a,1);this.options.multiselect.callback&&this.helper.executeCallback.call(this,this.options.multiselect.callback.onCancel,[this.node,d,c]);this.adjustInputSize();this.focusOnly=!0;this.node.focus().trigger("input"+this.namespace,{origin:"cancelMultiselectItem"})},adjustInputSize:function(){var a=this.node[0].getBoundingClientRect().width-(parseFloat(this.label.container.data("padding-right"))||
0)-(parseFloat(this.label.container.css("padding-left"))||0),c=0,e=0,f=0,h=!1,k=0;this.label.container.find("."+this.options.selector.label).filter(function(d,g){0===d&&(k=b(g)[0].getBoundingClientRect().height+parseFloat(b(g).css("margin-bottom")||0));c=b(g)[0].getBoundingClientRect().width+parseFloat(b(g).css("margin-right")||0);f+c>.7*a&&!h&&(e++,h=!0);f+c<a?f+=c:(h=!1,f=c)});var m=parseFloat(this.label.container.data("padding-left")||0)+(h?0:f),n=e*k+parseFloat(this.label.container.data("padding-top")||
0);this.container.find("."+this.options.selector.query).find("input, textarea, [contenteditable], .typeahead__hint").css({paddingLeft:m,paddingTop:n})},showLayout:function(){!this.container.hasClass("result")&&(this.result.length||this.options.emptyTemplate||this.options.backdropOnFocus)&&(function(){var a=this;b("html").off("keydown"+this.namespace).on("keydown"+this.namespace,function(d){d.keyCode&&9===d.keyCode&&setTimeout(function(){b(":focus").closest(a.container).find(a.node)[0]||a.hideLayout()},
0)});b("html").off("click"+this.namespace+" touchend"+this.namespace).on("click"+this.namespace+" touchend"+this.namespace,function(d){b(d.target).closest(a.container)[0]||b(d.target).closest("."+a.options.selector.item)[0]||d.target.className===a.options.selector.cancelButton||a.hasDragged||a.hideLayout()})}.call(this),this.container.addClass([this.result.length||this.searchGroups.length&&this.options.emptyTemplate&&this.query.length?"result ":"",this.options.hint&&this.searchGroups.length?"hint":
"",this.options.backdrop||this.options.backdropOnFocus?"backdrop":""].join(" ")),this.helper.executeCallback.call(this,this.options.callback.onShowLayout,[this.node,this.query]))},hideLayout:function(){if(this.container.hasClass("result")||this.container.hasClass("backdrop"))this.container.removeClass("result hint filter"+(this.options.backdropOnFocus&&b(this.node).is(":focus")?"":" backdrop")),this.options.backdropOnFocus&&this.container.hasClass("backdrop")||(b("html").off(this.namespace),this.helper.executeCallback.call(this,
this.options.callback.onHideLayout,[this.node,this.query]))},resetLayout:function(){this.result=[];this.tmpResult={};this.groups=[];this.resultCount=0;this.resultCountPerGroup={};this.resultItemCount=0;this.resultHtml=null;this.options.hint&&this.hint.container&&(this.hint.container.val(""),this.isContentEditable&&this.hint.container.text(""))},resetInput:function(){this.node.val("");this.isContentEditable&&this.node.text("");this.item=null;this.rawQuery=this.query=""},buildCancelButtonLayout:function(){if(this.options.cancelButton){var a=
this;b("<span/>",{class:this.options.selector.cancelButton,html:"\u00d7",mousedown:function(b){b.stopImmediatePropagation();b.preventDefault();a.resetInput();a.node.trigger("input"+a.namespace,[b])}}).insertBefore(this.node)}},toggleCancelButtonVisibility:function(){this.container.toggleClass("cancel",!!this.query.length)},__construct:function(){this.extendOptions();this.unifySourceFormat()&&(this.dynamicFilter.init.apply(this),this.init(),this.buildDropdownLayout(),this.buildDropdownItemLayout("static"),
this.buildMultiselectLayout(),this.delegateEvents(),this.buildCancelButtonLayout(),this.helper.executeCallback.call(this,this.options.callback.onReady,[this.node]))},helper:{isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},removeAccent:function(b){if("string"===typeof b){var d=a;"object"===typeof this.options.accent&&(d=this.options.accent);return b=b.toLowerCase().replace(new RegExp("["+d.from+"]","g"),function(a){return d.to[d.from.indexOf(a)]})}},slugify:function(a){a=
String(a);""!==a&&(a=this.helper.removeAccent.call(this,a),a=a.replace(/[^-a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""));return a},sort:function(a,b,c){var d=function(b){for(var d=0,e=a.length;d<e;d++)if("undefined"!==typeof b[a[d]])return c(b[a[d]]);return b};b=[-1,1][+!!b];return function(a,c){return a=d(a),c=d(c),b*((a>c)-(c>a))}},replaceAt:function(a,b,c,e){return a.substring(0,b)+e+a.substring(b+c)},highlight:function(a,b,c){a=String(a);c=c&&this.helper.removeAccent.call(this,a)||
a;var d=[];Array.isArray(b)||(b=[b]);b.sort(function(a,b){return b.length-a.length});for(var e=b.length-1;0<=e;e--)""===b[e].trim()?b.splice(e,1):b[e]=b[e].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c.replace(new RegExp("(?:"+b.join("|")+")(?!([^<]+)?>)","gi"),function(a,b,c){d.push({offset:c,length:a.length})});for(e=d.length-1;0<=e;e--)a=this.helper.replaceAt(a,d[e].offset,d[e].length,"<strong>"+a.substr(d[e].offset,d[e].length)+"</strong>");return a},getCaret:function(a){var b=0;if(a.selectionStart)return a.selectionStart;
if(document.selection){var d=document.selection.createRange();if(null===d)return b;a=a.createTextRange();b=a.duplicate();a.moveToBookmark(d.getBookmark());b.setEndPoint("EndToStart",a);b=b.text.length}else window.getSelection&&(d=window.getSelection(),d.rangeCount&&(d=d.getRangeAt(0),d.commonAncestorContainer.parentNode==a&&(b=d.endOffset)));return b},setCaretAtEnd:function(a){if("undefined"!==typeof window.getSelection&&"undefined"!==typeof document.createRange){var b=document.createRange();b.selectNodeContents(a);
b.collapse(!1);a=window.getSelection();a.removeAllRanges();a.addRange(b)}else"undefined"!==typeof document.body.createTextRange&&(b=document.body.createTextRange(),b.moveToElementText(a),b.collapse(!1),b.select())},cleanStringFromScript:function(a){return"string"===typeof a&&a.replace(/<\/?(?:script|iframe)\b[^>]*>/gm,"")||a},executeCallback:function(a,b){if(a){if("function"===typeof a)var d=a;else if("string"===typeof a||Array.isArray(a))if("string"===typeof a&&(a=[a,[]]),d=this.helper.namespace.call(this,
a[0],window),"function"!==typeof d){this.options.debug&&(n.log({node:this.selector,function:"executeCallback()",arguments:JSON.stringify(a),message:'WARNING - Invalid callback function"'}),n.print());return}return d.apply(this,(a[1]||[]).concat(b?b:[]))}},namespace:function(a,b,c,e){if("string"!==typeof a||""===a)return this.options.debug&&(n.log({node:this.options.input||this.selector,function:"helper.namespace()",arguments:a,message:'ERROR - Missing string"'}),n.print()),!1;var d="undefined"!==
typeof e?e:void 0;if(!~a.indexOf("."))return b[a]||d;a=a.split(".");b=b||window;c=c||"get";for(var f,g=0,h=a.length;g<h;g++){f=a[g];if("undefined"===typeof b[f]){if(~["get","delete"].indexOf(c))return"undefined"!==typeof e?e:void 0;b[f]={}}if(~["set","create","delete"].indexOf(c)&&g===h-1)if("set"===c||"create"===c)b[f]=d;else return delete b[f],!0;b=b[f]}return b},typeWatch:function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}()}};b.fn.typeahead=b.typeahead=function(a){return m.typeahead(this,
a)};var m={typeahead:function(a,c){if(c&&c.source&&"object"===typeof c.source){if("function"===typeof a){if(!c.input){n.log({node:a.selector,function:"$.typeahead()",message:'Undefined "options.input" - Typeahead dropped'});n.print();return}a=b(c.input)}"undefined"===typeof a[0].value&&(a[0].value=a.text());if(a.length){if(1===a.length)return a[0].selector=a.selector||c.input||a[0].nodeName.toLowerCase(),window.Typeahead[a[0].selector]=new k(a,c);for(var d={},e,f=0,g=a.length;f<g;++f)e=a[f].nodeName.toLowerCase(),
"undefined"!==typeof d[e]&&(e+=f),a[f].selector=e,window.Typeahead[e]=d[e]=new k(a.eq(f),c);return d}n.log({node:a.selector,function:"$.typeahead()",arguments:JSON.stringify(c.input),message:"Unable to find jQuery input element - Typeahead dropped"})}else n.log({node:a.selector||c&&c.input,function:"$.typeahead()",arguments:JSON.stringify(c&&c.source||""),message:'Undefined "options" or "options.source" or invalid source type - Typeahead dropped'});n.print()}},n={table:{},log:function(a){a.message&&
"string"===typeof a.message&&(this.table[a.message]=b.extend({node:"",function:"",arguments:""},a))},print:function(){if(!k.prototype.helper.isEmpty(this.table)&&console&&console.table){if(void 0!==console.group||void 0!==console.table)console.groupCollapsed("--- jQuery Typeahead Debug ---"),console.table(this.table),console.groupEnd();this.table={}}}};n.log({message:"WARNING - You are using the DEBUG version. Use /dist/jquery.typeahead.min.js in production."});n.print();window.console=window.console||
{log:function(){}};Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,b){void 0===b&&(b=0);0>b&&(b+=this.length);0>b&&(b=0);for(var c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1});Object.keys||(Object.keys=function(a){var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,
c)&&b.push(c);return b});return k});
