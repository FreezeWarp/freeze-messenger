//# sourceMappingURL=jquery.plugins.js.map
/*
 jQuery UI Widget 1.11.4
 http://jqueryui.com

 Copyright jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license

 http://api.jqueryui.com/jQuery.widget/
 jQuery hashchange event - v1.3 - 7/21/2010
 http://benalman.com/projects/jquery-hashchange-plugin/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
 SerializeJSON jQuery plugin.
  https://github.com/marioizquierdo/jquery.serializeJSON
  version 2.9.0 (Jan, 2018)

  Copyright (c) 2012-2018 Mario Izquierdo
  Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
  and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 jQuery Typeahead
 Copyright (C) 2017 RunningCoder.org
 Licensed under the MIT license

 @author Tom Bertrand
 @version 2.10.4 (2017-10-17)
 @link http://www.runningcoder.org/jquerytypeahead/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,g,a){b instanceof String&&(b=String(b));for(var c=b.length,e=0;e<c;e++){var f=b[e];if(g.call(a,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,g,a){b!=Array.prototype&&b!=Object.prototype&&(b[g]=a.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,g,a,c){if(g){a=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var e=b[c];e in a||(a[e]={});a=a[e]}b=b[b.length-1];c=a[b];g=g(c);g!=c&&null!=g&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:g})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(g){return $jscomp.SYMBOL_PREFIX+(g||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var g=0;return $jscomp.iteratorPrototype(function(){return g<b.length?{done:!1,value:b[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,g){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var a=0,c={next:function(){if(a<b.length){var e=a++;return{value:g(e,b[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){var g=0,a=Array.prototype.slice;b.cleanData=function(a){return function(e){var c,k,l;for(l=0;null!=(k=e[l]);l++)try{(c=b._data(k,"events"))&&c.remove&&b(k).triggerHandler("remove")}catch(m){}a(e)}}(b.cleanData);b.widget=function(a,e,f){var c={},l=a.split(".")[0];a=a.split(".")[1];var g=l+"-"+a;f||(f=e,e=b.Widget);b.expr[":"][g.toLowerCase()]=function(d){return!!b.data(d,
g)};b[l]=b[l]||{};var d=b[l][a];var h=b[l][a]=function(d,b){if(!this._createWidget)return new h(d,b);arguments.length&&this._createWidget(d,b)};b.extend(h,d,{version:f.version,_proto:b.extend({},f),_childConstructors:[]});var n=new e;n.options=b.widget.extend({},n.options);b.each(f,function(d,a){b.isFunction(a)?c[d]=function(){var b=function(){return e.prototype[d].apply(this,arguments)},h=function(b){return e.prototype[d].apply(this,b)};return function(){var d=this._super,e=this._superApply;this._super=
b;this._superApply=h;var c=a.apply(this,arguments);this._super=d;this._superApply=e;return c}}():c[d]=a});h.prototype=b.widget.extend(n,{widgetEventPrefix:d?n.widgetEventPrefix||a:a},c,{constructor:h,namespace:l,widgetName:a,widgetFullName:g});d?(b.each(d._childConstructors,function(d,a){d=a.prototype;b.widget(d.namespace+"."+d.widgetName,h,a._proto)}),delete d._childConstructors):e._childConstructors.push(h);b.widget.bridge(a,h);return h};b.widget.extend=function(c){for(var e=a.call(arguments,1),
f=0,k=e.length,l,g;f<k;f++)for(l in e[f])g=e[f][l],e[f].hasOwnProperty(l)&&void 0!==g&&(b.isPlainObject(g)?c[l]=b.isPlainObject(c[l])?b.widget.extend({},c[l],g):b.widget.extend({},g):c[l]=g);return c};b.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;b.fn[c]=function(k){var l="string"===typeof k,g=a.call(arguments,1),d=this;l?this.each(function(){var a=b.data(this,f);if("instance"===k)return d=a,!1;if(!a)return b.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+
k+"'");if(!b.isFunction(a[k])||"_"===k.charAt(0))return b.error("no such method '"+k+"' for "+c+" widget instance");var e=a[k].apply(a,g);if(e!==a&&void 0!==e)return d=e&&e.jquery?d.pushStack(e.get()):e,!1}):(g.length&&(k=b.widget.extend.apply(null,[k].concat(g))),this.each(function(){var d=b.data(this,f);d?(d.option(k||{}),d._init&&d._init()):b.data(this,f,new e(k,this))}));return d}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",
defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,e){e=b(e||this.defaultElement||this)[0];this.element=b(e);this.uuid=g++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=b();this.hoverable=b();this.focusable=b();e!==this&&(b.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(b){b.target===e&&this.destroy()}}),this.document=b(e.style?e.ownerDocument:e.document||e),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));
this.options=b.widget.extend({},this.options,this._getCreateOptions(),a);this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");
this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(a,e){var c=a,k;if(0===arguments.length)return b.widget.extend({},this.options);if("string"===typeof a){c={};var l=a.split(".");a=l.shift();if(l.length){var g=c[a]=b.widget.extend({},this.options[a]);for(k=0;k<l.length-1;k++)g[l[k]]=g[l[k]]||{},g=g[l[k]];a=l.pop();if(1===arguments.length)return void 0===
g[a]?null:g[a];g[a]=e}else{if(1===arguments.length)return void 0===this.options[a]?null:this.options[a];c[a]=e}}this._setOptions(c);return this},_setOptions:function(b){for(var a in b)this._setOption(a,b[a]);return this},_setOption:function(b,a){this.options[b]=a;"disabled"===b&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!a),a&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")));return this},enable:function(){return this._setOptions({disabled:!1})},
disable:function(){return this._setOptions({disabled:!0})},_on:function(a,e,f){var c,g=this;"boolean"!==typeof a&&(f=e,e=a,a=!1);f?(e=c=b(e),this.bindings=this.bindings.add(e)):(f=e,e=this.element,c=this.widget());b.each(f,function(f,d){function h(){if(a||!0!==g.options.disabled&&!b(this).hasClass("ui-state-disabled"))return("string"===typeof d?g[d]:d).apply(g,arguments)}"string"!==typeof d&&(h.guid=d.guid=d.guid||h.guid||b.guid++);var n=f.match(/^([\w:-]*)\s*(.*)$/);f=n[1]+g.eventNamespace;(n=n[2])?
c.delegate(n,f,h):e.bind(f,h)})},_off:function(a,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(e).undelegate(e);this.bindings=b(this.bindings.not(a).get());this.focusable=b(this.focusable.not(a).get());this.hoverable=b(this.hoverable.not(a).get())},_delay:function(b,a){var e=this;return setTimeout(function(){return("string"===typeof b?e[b]:b).apply(e,arguments)},a||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){b(a.currentTarget).addClass("ui-state-hover")},
mouseleave:function(a){b(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){b(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){b(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,e,f){var c,g=this.options[a];f=f||{};e=b.Event(e);e.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();e.target=this.element[0];if(a=e.originalEvent)for(c in a)c in e||
(e[c]=a[c]);this.element.trigger(e,f);return!(b.isFunction(g)&&!1===g.apply(this.element[0],[e].concat(f))||e.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(a,e){b.Widget.prototype["_"+a]=function(c,k,g){"string"===typeof k&&(k={effect:k});var f=k?!0===k||"number"===typeof k?e:k.effect||e:a;k=k||{};"number"===typeof k&&(k={duration:k});var d=!b.isEmptyObject(k);k.complete=g;k.delay&&c.delay(k.delay);if(d&&b.effects&&b.effects.effect[f])c[a](k);else if(f!==a&&c[f])c[f](k.duration,
k.easing,g);else c.queue(function(d){b(this)[a]();g&&g.call(c[0]);d()})}})});
jQuery.cookie=function(b,g,a){if("undefined"!=typeof g){a=a||{};null===g&&(g="",a.expires=-1);var c="";a.expires&&("number"==typeof a.expires||a.expires.toUTCString)&&("number"==typeof a.expires?(c=new Date,c.setTime(c.getTime()+864E5*a.expires)):c=a.expires,c="; expires="+c.toUTCString());var e=a.path?"; path="+a.path:"",f=a.domain?"; domain="+a.domain:"";a=a.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(g),c,e,f,a].join("")}else{g=null;if(document.cookie&&""!=document.cookie)for(a=
document.cookie.split(";"),c=0;c<a.length;c++)if(e=jQuery.trim(a[c]),e.substring(0,b.length+1)==b+"="){g=decodeURIComponent(e.substring(b.length+1));break}return g}};jQuery.getCookie=function(b,g){b=$.cookie(b);return null===b||void 0===b?g:b};jQuery.toArray=function(b){return $.map(b,function(b,a){return b})};
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){function g(d){d=d.split(/\s+/);for(var b=[],a=0,e;e=d[a];a++)e=e.charAt(0).toUpperCase(),b.push(e);return b}function a(d){return d.id&&b('label[for="'+d.id+'"]').val()||d.name}function c(d,e,h){h||(h=0);e.each(function(){var e=b(this),q=this,x=this.nodeName.toLowerCase();if("label"===x&&e.find("input, textarea, select").length){var f=e.text();e=e.children().first();
q=e.get(0);x=q.nodeName.toLowerCase()}switch(x){case "menu":var n={name:e.attr("label"),items:{}};h=c(n.items,e.children(),h);break;case "a":case "button":n={name:e.text(),disabled:!!e.attr("disabled"),callback:function(){return function(){e.get(0).click()}}()};break;case "menuitem":case "command":switch(e.attr("type")){case void 0:case "command":case "menuitem":n={name:e.attr("label"),disabled:!!e.attr("disabled"),icon:e.attr("icon"),callback:function(){return function(){e.get(0).click()}}()};break;
case "checkbox":n={type:"checkbox",disabled:!!e.attr("disabled"),name:e.attr("label"),selected:!!e.attr("checked")};break;case "radio":n={type:"radio",disabled:!!e.attr("disabled"),name:e.attr("label"),radio:e.attr("radiogroup"),value:e.attr("id"),selected:!!e.attr("checked")};break;default:n=void 0}break;case "hr":n="-------";break;case "input":switch(e.attr("type")){case "text":n={type:"text",name:f||a(q),disabled:!!e.attr("disabled"),value:e.val()};break;case "checkbox":n={type:"checkbox",name:f||
a(q),disabled:!!e.attr("disabled"),selected:!!e.attr("checked")};break;case "radio":n={type:"radio",name:f||a(q),disabled:!!e.attr("disabled"),radio:!!e.attr("name"),value:e.val(),selected:!!e.attr("checked")};break;default:n=void 0}break;case "select":n={type:"select",name:f||a(q),disabled:!!e.attr("disabled"),selected:e.val(),options:{}};e.children().each(function(){n.options[this.value]=b(this).text()});break;case "textarea":n={type:"textarea",name:f||a(q),disabled:!!e.attr("disabled"),value:e.val()};
break;case "label":break;default:n={type:"html",html:e.clone(!0)}}n&&(h++,d["key"+h]=n)});return h}b.support.htmlMenuitem="HTMLMenuItemElement"in window;b.support.htmlCommand="HTMLCommandElement"in window;b.support.eventSelectstart="onselectstart"in document.documentElement;b.ui&&b.widget||(b.cleanData=function(d){return function(a){var e,h;for(h=0;null!=a[h];h++){var q=a[h];try{(e=b._data(q,"events"))&&e.remove&&b(q).triggerHandler("remove")}catch(y){}}d(a)}}(b.cleanData));var e=null,f=!1,k=b(window),
l=0,m={},d={},h={},n={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",
iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(d){if(b.ui&&b.ui.position)d.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var a=this.offset();a.top+=this.outerHeight();a.left+=this.outerWidth()/2-d.outerWidth()/2;d.css(a)}},position:function(d,b,a){if(b||a){if("maintain"===b&&"maintain"===a)b=d.$menu.position();else{var e=d.$menu.offsetParent().offset();
b={top:a-e.top,left:b-e.left}}a=k.scrollTop()+k.height();e=k.scrollLeft()+k.width();var h=d.$menu.outerHeight(),q=d.$menu.outerWidth();b.top+h>a&&(b.top-=h);0>b.top&&(b.top=0);b.left+q>e&&(b.left-=q);0>b.left&&(b.left=0);d.$menu.css(b)}else d.determinePosition.call(this,d.$menu)},positionSubmenu:function(d){if("undefined"!==typeof d)if(b.ui&&b.ui.position)d.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var a={top:-9,left:this.outerWidth()-
5};d.css(a)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:b.noop,hide:b.noop},callback:null,items:{}},t=null,v=null,w=null,D,B=function(d){for(var b=0;b=Math.max(b,parseInt(d.css("z-index"),10)||0),d=d.parent(),d&&d.length&&!(-1<"html body".indexOf(d.prop("nodeName").toLowerCase())););return b},p={abortevent:function(d){d.preventDefault();d.stopImmediatePropagation()},contextmenu:function(d){var a=b(this);"right"===d.data.trigger&&(d.preventDefault(),d.stopImmediatePropagation());
if(!("right"!==d.data.trigger&&"demand"!==d.data.trigger&&d.originalEvent||"undefined"!==typeof d.mouseButton&&d.data&&!("left"===d.data.trigger&&0===d.mouseButton||"right"===d.data.trigger&&2===d.mouseButton)||a.hasClass("context-menu-active")||a.hasClass("context-menu-disabled"))){e=a;if(d.data.build){var h=d.data.build(e,d);if(!1===h)return;d.data=b.extend(!0,{},n,d.data,h||{});if(!d.data.items||b.isEmptyObject(d.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),
Error("No Items specified");d.data.$trigger=e;r.create(d.data)}h=!1;for(var c in d.data.items)d.data.items.hasOwnProperty(c)&&(b.isFunction(d.data.items[c].visible)?d.data.items[c].visible.call(b(d.currentTarget),c,d.data):"undefined"!==typeof d.data.items[c]&&d.data.items[c].visible?!0===d.data.items[c].visible:1)&&(h=!0);h&&r.show.call(a,d.data,d.pageX,d.pageY)}},click:function(d){d.preventDefault();d.stopImmediatePropagation();b(this).trigger(b.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},
mousedown:function(d){var a=b(this);e&&e.length&&!e.is(a)&&e.data("contextMenu").$menu.trigger("contextmenu:hide");2===d.button&&(e=a.data("contextMenuActive",!0))},mouseup:function(d){var a=b(this);a.data("contextMenuActive")&&e&&e.length&&e.is(a)&&!a.hasClass("context-menu-disabled")&&(d.preventDefault(),d.stopImmediatePropagation(),e=a,a.trigger(b.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY})));a.removeData("contextMenuActive")},mouseenter:function(d){var a=b(this),h=b(d.relatedTarget),
c=b(document);h.is(".context-menu-list")||h.closest(".context-menu-list").length||e&&e.length||(v=d.pageX,w=d.pageY,D=d.data,c.on("mousemove.contextMenuShow",p.mousemove),t=setTimeout(function(){t=null;c.off("mousemove.contextMenuShow");e=a;a.trigger(b.Event("contextmenu",{data:D,pageX:v,pageY:w}))},d.data.delay))},mousemove:function(d){v=d.pageX;w=d.pageY},mouseleave:function(d){d=b(d.relatedTarget);if(!d.is(".context-menu-list")&&!d.closest(".context-menu-list").length){try{clearTimeout(t)}catch(x){}t=
null}},layerClick:function(d){var a=b(this).data("contextMenuRoot"),e=d.button,h=d.pageX,c=d.pageY,n,f;d.preventDefault();setTimeout(function(){var q="left"===a.trigger&&0===e||"right"===a.trigger&&2===e;if(document.elementFromPoint&&a.$layer){a.$layer.hide();n=document.elementFromPoint(h-k.scrollLeft(),c-k.scrollTop());if(n.isContentEditable){var x=document.createRange();var g=window.getSelection();x.selectNode(n);x.collapse(!0);g.removeAllRanges();g.addRange(x)}b(n).trigger(d);a.$layer.show()}if(a.reposition&&
q)if(document.elementFromPoint){if(a.$trigger.is(n)){a.position.call(a.$trigger,a,h,c);return}}else if(f=a.$trigger.offset(),x=b(window),f.top+=x.scrollTop(),f.top<=d.pageY&&(f.left+=x.scrollLeft(),f.left<=d.pageX&&(f.bottom=f.top+a.$trigger.outerHeight(),f.bottom>=d.pageY&&(f.right=f.left+a.$trigger.outerWidth(),f.right>=d.pageX)))){a.position.call(a.$trigger,a,h,c);return}if(n&&q)a.$trigger.one("contextmenu:hidden",function(){b(n).contextMenu({x:h,y:c,button:e})});null!==a&&"undefined"!==typeof a&&
null!==a.$menu&&"undefined"!==typeof a.$menu&&a.$menu.trigger("contextmenu:hide")},50)},keyStop:function(d,b){b.isInput||d.preventDefault();d.stopPropagation()},key:function(d){var b={};e&&(b=e.data("contextMenu")||{});"undefined"===typeof b.zIndex&&(b.zIndex=0);var a=0,h=function(d){""!==d.style.zIndex?a=d.style.zIndex:null!==d.offsetParent&&"undefined"!==typeof d.offsetParent?h(d.offsetParent):null!==d.parentElement&&"undefined"!==typeof d.parentElement&&h(d.parentElement)};h(d.target);if(!(b.$menu&&
parseInt(a,10)>parseInt(b.$menu.css("zIndex"),10))){switch(d.keyCode){case 9:case 38:p.keyStop(d,b);if(b.isInput){if(9===d.keyCode&&d.shiftKey){d.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();null!==b.$menu&&"undefined"!==typeof b.$menu&&b.$menu.trigger("prevcommand");return}if(38===d.keyCode&&"checkbox"===b.$selected.find("input, textarea, select").prop("type")){d.preventDefault();return}}else if(9!==d.keyCode||d.shiftKey){null!==b.$menu&&"undefined"!==typeof b.$menu&&
b.$menu.trigger("prevcommand");return}break;case 40:p.keyStop(d,b);if(b.isInput){if(9===d.keyCode){d.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();null!==b.$menu&&"undefined"!==typeof b.$menu&&b.$menu.trigger("nextcommand");return}if(40===d.keyCode&&"checkbox"===b.$selected.find("input, textarea, select").prop("type")){d.preventDefault();return}}else{null!==b.$menu&&"undefined"!==typeof b.$menu&&b.$menu.trigger("nextcommand");return}break;case 37:p.keyStop(d,b);
if(b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){d=b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=d;return}break;case 39:p.keyStop(d,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var c=b.$selected.data("contextMenu")||{};if(c.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;c.$selected=null;c.$menu.trigger("nextcommand");return}break;case 35:case 36:b.$selected&&b.$selected.find("input, textarea, select").length||
((b.$selected&&b.$selected.parent()||b.$menu).children(":not(."+b.classNames.disabled+", ."+b.classNames.notSelectable+")")[36===d.keyCode?"first":"last"]().trigger("contextmenu:focus"),d.preventDefault());return;case 13:p.keyStop(d,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){d.preventDefault();return}break}"undefined"!==typeof b.$selected&&null!==b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:p.keyStop(d,b);return;case 27:p.keyStop(d,b);null!==
b.$menu&&"undefined"!==typeof b.$menu&&b.$menu.trigger("contextmenu:hide");return;default:if(c=String.fromCharCode(d.keyCode).toUpperCase(),b.accesskeys&&b.accesskeys[c]){b.accesskeys[c].$node.trigger(b.accesskeys[c].$menu?"contextmenu:focus":"mouseup");return}}d.stopPropagation();"undefined"!==typeof b.$selected&&null!==b.$selected&&b.$selected.trigger(d)}},prevItem:function(d){d.stopPropagation();var a=b(this).data("contextMenu")||{},e=b(this).data("contextMenuRoot")||{};if(a.$selected){var h=a.$selected;
a=a.$selected.parent().data("contextMenu")||{};a.$selected=h}h=a.$menu.children();for(var c=a.$selected&&a.$selected.prev().length?a.$selected.prev():h.last(),f=c;c.hasClass(e.classNames.disabled)||c.hasClass(e.classNames.notSelectable)||c.is(":hidden");)if(c=c.prev().length?c.prev():h.last(),c.is(f))return;a.$selected&&p.itemMouseleave.call(a.$selected.get(0),d);p.itemMouseenter.call(c.get(0),d);d=c.find("input, textarea, select");d.length&&d.focus()},nextItem:function(d){d.stopPropagation();var a=
b(this).data("contextMenu")||{},e=b(this).data("contextMenuRoot")||{};if(a.$selected){var h=a.$selected;a=a.$selected.parent().data("contextMenu")||{};a.$selected=h}h=a.$menu.children();for(var c=a.$selected&&a.$selected.next().length?a.$selected.next():h.first(),f=c;c.hasClass(e.classNames.disabled)||c.hasClass(e.classNames.notSelectable)||c.is(":hidden");)if(c=c.next().length?c.next():h.first(),c.is(f))return;a.$selected&&p.itemMouseleave.call(a.$selected.get(0),d);p.itemMouseenter.call(c.get(0),
d);d=c.find("input, textarea, select");d.length&&d.focus()},focusInput:function(){var d=b(this).closest(".context-menu-item"),a=d.data(),e=a.contextMenu;a=a.contextMenuRoot;a.$selected=e.$selected=d;a.isInput=e.isInput=!0},blurInput:function(){var d=b(this).closest(".context-menu-item").data();d.contextMenuRoot.isInput=d.contextMenu.isInput=!1},menuMouseenter:function(){b(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(d){var a=b(this).data().contextMenuRoot;a.$layer&&a.$layer.is(d.relatedTarget)&&
(a.hovering=!1)},itemMouseenter:function(d){var a=b(this),e=a.data(),h=e.contextMenu;e=e.contextMenuRoot;e.hovering=!0;d&&e.$layer&&e.$layer.is(d.relatedTarget)&&(d.preventDefault(),d.stopImmediatePropagation());(h.$menu?h:e).$menu.children("."+e.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur");a.hasClass(e.classNames.disabled)||a.hasClass(e.classNames.notSelectable)?h.$selected=null:a.trigger("contextmenu:focus")},itemMouseleave:function(d){var a=b(this),
e=a.data(),h=e.contextMenu;e=e.contextMenuRoot;e!==h&&e.$layer&&e.$layer.is(d.relatedTarget)?("undefined"!==typeof e.$selected&&null!==e.$selected&&e.$selected.trigger("contextmenu:blur"),d.preventDefault(),d.stopImmediatePropagation(),e.$selected=h.$selected=h.$node):h&&h.$menu&&h.$menu.hasClass("context-menu-visible")||a.trigger("contextmenu:blur")},itemClick:function(d){var a=b(this),e=a.data(),h=e.contextMenu,c=e.contextMenuRoot;e=e.contextMenuKey;if(!(!h.items[e]||a.is("."+c.classNames.disabled+
", .context-menu-separator, ."+c.classNames.notSelectable)||a.is(".context-menu-submenu")&&!1===c.selectableSubMenu)){d.preventDefault();d.stopImmediatePropagation();if(b.isFunction(h.callbacks[e])&&Object.prototype.hasOwnProperty.call(h.callbacks,e))a=h.callbacks[e];else if(b.isFunction(c.callback))a=c.callback;else return;!1!==a.call(c.$trigger,e,c,d)?c.$menu.trigger("contextmenu:hide"):c.$menu.parent().length&&r.update.call(c.$trigger,c)}},inputClick:function(d){d.stopImmediatePropagation()},hideMenu:function(d,
a){d=b(this).data("contextMenuRoot");r.hide.call(d.$trigger,d,a&&a.force)},focusItem:function(d){d.stopPropagation();d=b(this);var a=d.data(),e=a.contextMenu;a=a.contextMenuRoot;d.hasClass(a.classNames.disabled)||d.hasClass(a.classNames.notSelectable)||(d.addClass([a.classNames.hover,a.classNames.visible].join(" ")).parent().find(".context-menu-item").not(d).removeClass(a.classNames.visible).filter("."+a.classNames.hover).trigger("contextmenu:blur"),e.$selected=a.$selected=d,e&&e.$node&&e.$node.hasClass("context-menu-submenu")&&
e.$node.addClass(a.classNames.hover),e.$node&&a.positionSubmenu.call(e.$node,e.$menu))},blurItem:function(d){d.stopPropagation();d=b(this);var a=d.data(),e=a.contextMenu;a=a.contextMenuRoot;e.autoHide&&d.removeClass(a.classNames.visible);d.removeClass(a.classNames.hover);e.$selected=null}},r={show:function(d,a,h){var c=b(this),f={};b("#context-menu-layer").trigger("mousedown");d.$trigger=c;if(!1===d.events.show.call(c,d))e=null;else if(r.update.call(c,d),d.position.call(c,d,a,h),d.zIndex&&(a=d.zIndex,
"function"===typeof d.zIndex&&(a=d.zIndex.call(c,d)),f.zIndex=B(c)+a),r.layer.call(d.$menu,d,f.zIndex),d.$menu.find("ul").css("zIndex",f.zIndex+1),d.$menu.css(f)[d.animation.show](d.animation.duration,function(){c.trigger("contextmenu:visible")}),c.data("contextMenu",d).addClass("context-menu-active"),b(document).off("keydown.contextMenu").on("keydown.contextMenu",p.key),d.autoHide)b(document).on("mousemove.contextMenuAutoHide",function(b){var a=c.offset();a.right=a.left+c.outerWidth();a.bottom=a.top+
c.outerHeight();!d.$layer||d.hovering||b.pageX>=a.left&&b.pageX<=a.right&&b.pageY>=a.top&&b.pageY<=a.bottom||setTimeout(function(){d.hovering||null===d.$menu||"undefined"===typeof d.$menu||d.$menu.trigger("contextmenu:hide")},50)})},hide:function(d,a){var h=b(this);d||(d=h.data("contextMenu")||{});if(a||!d.events||!1!==d.events.hide.call(h,d)){h.removeData("contextMenu").removeClass("context-menu-active");if(d.$layer){setTimeout(function(d){return function(){d.remove()}}(d.$layer),10);try{delete d.$layer}catch(C){d.$layer=
null}}e=null;d.$menu.find("."+d.classNames.hover).trigger("contextmenu:blur");d.$selected=null;d.$menu.find("."+d.classNames.visible).removeClass(d.classNames.visible);b(document).off(".contextMenuAutoHide").off("keydown.contextMenu");if(d.$menu)d.$menu[d.animation.hide](d.animation.duration,function(){d.build&&(d.$menu.remove(),b.each(d,function(b){switch(b){case "ns":case "selector":case "build":case "trigger":return!0;default:d[b]=void 0;try{delete d[b]}catch(F){}return!0}}));setTimeout(function(){h.trigger("contextmenu:hidden")},
10)})}},create:function(d,a){function e(d){var a=b("<span></span>");if(d._accesskey)d._beforeAccesskey&&a.append(document.createTextNode(d._beforeAccesskey)),b("<span></span>").addClass("context-menu-accesskey").text(d._accesskey).appendTo(a),d._afterAccesskey&&a.append(document.createTextNode(d._afterAccesskey));else if(d.isHtmlName){if("undefined"!==typeof d.accesskey)throw Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");a.html(d.name)}else a.text(d.name);
return a}"undefined"===typeof a&&(a=d);d.$menu=b('<ul class="context-menu-list"></ul>').addClass(d.className||"").data({contextMenu:d,contextMenuRoot:a});b.each(["callbacks","commands","inputs"],function(b,e){d[e]={};a[e]||(a[e]={})});a.accesskeys||(a.accesskeys={});b.each(d.items,function(c,f){var n=b('<li class="context-menu-item"></li>').addClass(f.className||""),k=null,l=null;n.on("click",b.noop);if("string"===typeof f||"cm_separator"===f.type)f={type:"cm_seperator"};f.$node=n.data({contextMenu:d,
contextMenuRoot:a,contextMenuKey:c});if("undefined"!==typeof f.accesskey)for(var t=g(f.accesskey),w=0,v;v=t[w];w++)if(!a.accesskeys[v]){a.accesskeys[v]=f;if(t=f.name.match(new RegExp("^(.*?)("+v+")(.*)$","i")))f._beforeAccesskey=t[1],f._accesskey=t[2],f._afterAccesskey=t[3];break}if(f.type&&h[f.type])h[f.type].call(n,f,d,a),b.each([d,a],function(a,e){e.commands[c]=f;!b.isFunction(f.callback)||"undefined"!==typeof e.callbacks[c]&&"undefined"!==typeof d.type||(e.callbacks[c]=f.callback)});else{"cm_seperator"===
f.type?n.addClass("context-menu-separator "+a.classNames.notSelectable):"html"===f.type?n.addClass("context-menu-html "+a.classNames.notSelectable):"sub"!==f.type&&(f.type?(k=b("<label></label>").appendTo(n),e(f).appendTo(k),n.addClass("context-menu-input"),d.hasTypes=!0,b.each([d,a],function(d,a){a.commands[c]=f;a.inputs[c]=f})):f.items&&(f.type="sub"));switch(f.type){case "cm_seperator":break;case "text":l=b('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+c).val(f.value||
"").appendTo(k);break;case "textarea":l=b('<textarea name=""></textarea>').attr("name","context-menu-input-"+c).val(f.value||"").appendTo(k);f.height&&l.height(f.height);break;case "checkbox":l=b('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+c).val(f.value||"").prop("checked",!!f.selected).prependTo(k);break;case "radio":l=b('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",!!f.selected).prependTo(k);
break;case "select":l=b('<select name=""></select>').attr("name","context-menu-input-"+c).appendTo(k);f.options&&(b.each(f.options,function(d,a){b("<option></option>").val(d).text(a).appendTo(l)}),l.val(f.selected));break;case "sub":e(f).appendTo(n);f.appendTo=f.$node;n.data("contextMenu",f).addClass("context-menu-submenu");f.callback=null;"function"===typeof f.items.then?r.processPromises(f,a,f.items):r.create(f,a);break;case "html":b(f.html).appendTo(n);break;default:b.each([d,a],function(a,e){e.commands[c]=
f;!b.isFunction(f.callback)||"undefined"!==typeof e.callbacks[c]&&"undefined"!==typeof d.type||(e.callbacks[c]=f.callback)}),e(f).appendTo(n)}if(f.type&&"sub"!==f.type&&"html"!==f.type&&"cm_seperator"!==f.type&&(l.on("focus",p.focusInput).on("blur",p.blurInput),f.events))l.on(f.events,d);f.icon&&(b.isFunction(f.icon)?f._icon=f.icon.call(this,this,n,c,f):"string"===typeof f.icon&&"fa-"===f.icon.substring(0,3)?f._icon=a.classNames.icon+" "+a.classNames.icon+"--fa fa "+f.icon:f._icon=a.classNames.icon+
" "+a.classNames.icon+"-"+f.icon,n.addClass(f._icon))}f.$input=l;f.$label=k;n.appendTo(d.$menu);if(!d.hasTypes&&b.support.eventSelectstart)n.on("selectstart.disableTextSelect",p.abortevent)});d.$node||d.$menu.css("display","none").addClass("context-menu-root");d.$menu.appendTo(d.appendTo||document.body)},resize:function(d,a){var e;d.css({position:"absolute",display:"block"});d.data("width",(e=d.get(0)).getBoundingClientRect?Math.ceil(e.getBoundingClientRect().width):d.outerWidth()+1);d.css({position:"static",
minWidth:"0px",maxWidth:"100000px"});d.find("> li > ul").each(function(){r.resize(b(this),!0)});a||d.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return b(this).data("width")})},update:function(d,a){var e=this;"undefined"===typeof a&&(a=d,r.resize(d.$menu));d.$menu.children().each(function(){var h=b(this),c=h.data("contextMenuKey"),f=d.items[c],n=b.isFunction(f.disabled)&&f.disabled.call(e,c,a)||!0===f.disabled;var k=b.isFunction(f.visible)?f.visible.call(e,
c,a):"undefined"!==typeof f.visible?!0===f.visible:!0;h[k?"show":"hide"]();h[n?"addClass":"removeClass"](a.classNames.disabled);b.isFunction(f.icon)&&(h.removeClass(f._icon),f._icon=f.icon.call(this,e,h,c,f),h.addClass(f._icon));if(f.type)switch(h.find("input, select, textarea").prop("disabled",n),f.type){case "text":case "textarea":f.$input.val(f.value||"");break;case "checkbox":case "radio":f.$input.val(f.value||"").prop("checked",!!f.selected);break;case "select":f.$input.val((0===f.selected?"0":
f.selected)||"")}f.$menu&&r.update.call(e,f,a)})},layer:function(d,a){d=d.$layer=b('<div id="context-menu-layer"></div>').css({height:k.height(),width:k.width(),display:"block",position:"fixed","z-index":a,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",d).insertBefore(this).on("contextmenu",p.abortevent).on("mousedown",p.layerClick);"undefined"===typeof document.body.style.maxWidth&&d.css({position:"absolute",height:b(document).height()});return d},
processPromises:function(d,a,b){function e(d,a,b){"undefined"===typeof b?(b={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"===typeof b&&(b={error:{name:b}});h(d,a,b)}function h(d,a,b){"undefined"!==typeof a.$menu&&a.$menu.is(":visible")&&(d.$node.removeClass(a.classNames.iconLoadingClass),d.items=b,r.create(d,
a,!0),r.update(d,a),a.positionSubmenu.call(d.$node,d.$menu))}d.$node.addClass(a.classNames.iconLoadingClass);b.then(function(d,a,b){"undefined"===typeof b&&e(void 0);h(d,a,b)}.bind(this,d,a),e.bind(this,d,a))}};b.fn.contextMenu=function(a){var e=this;if(0<this.length)if("undefined"===typeof a)this.first().trigger("contextmenu");else if("undefined"!==typeof a.x&&"undefined"!==typeof a.y)this.first().trigger(b.Event("contextmenu",{pageX:a.x,pageY:a.y,mouseButton:a.button}));else if("hide"===a){var h=
this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;h&&h.trigger("contextmenu:hide")}else"destroy"===a?b.contextMenu("destroy",{context:this}):b.isPlainObject(a)?(a.context=this,b.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");else b.each(d,function(){this.selector===e.selector&&(a.data=this,b.extend(a.data,{trigger:"demand"}))}),p.contextmenu.call(a.target,a);return this};b.contextMenu=function(a,e){"string"!==
typeof a&&(e=a,a="create");"string"===typeof e?e={selector:e}:"undefined"===typeof e&&(e={});var h=b.extend(!0,{},n,e||{}),c=b(document),k=c,g=!1;h.context&&h.context.length?(k=b(h.context).first(),h.context=k.get(0),g=!b(h.context).is(document)):h.context=document;switch(a){case "create":if(!h.selector)throw Error("No selector specified");if(h.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+h.selector+'" as it contains a reserved className');if(!h.build&&
(!h.items||b.isEmptyObject(h.items)))throw Error("No Items specified");l++;h.ns=".contextMenu"+l;g||(m[h.selector]=h.ns);d[h.ns]=h;h.trigger||(h.trigger="right");f||(a={"contextmenu:focus.contextMenu":p.focusItem,"contextmenu:blur.contextMenu":p.blurItem,"contextmenu.contextMenu":p.abortevent,"mouseenter.contextMenu":p.itemMouseenter,"mouseleave.contextMenu":p.itemMouseleave},a["click"===h.itemClickEvent?"click.contextMenu":"mouseup.contextMenu"]=p.itemClick,c.on({"contextmenu:hide.contextMenu":p.hideMenu,
"prevcommand.contextMenu":p.prevItem,"nextcommand.contextMenu":p.nextItem,"contextmenu.contextMenu":p.abortevent,"mouseenter.contextMenu":p.menuMouseenter,"mouseleave.contextMenu":p.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",p.inputClick).on(a,".context-menu-item"),f=!0);k.on("contextmenu"+h.ns,h.selector,h,p.contextmenu);if(g)k.on("remove"+h.ns,function(){b(this).contextMenu("destroy")});switch(h.trigger){case "hover":k.on("mouseenter"+h.ns,h.selector,h,
p.mouseenter).on("mouseleave"+h.ns,h.selector,h,p.mouseleave);break;case "left":k.on("click"+h.ns,h.selector,h,p.click);break;case "touchstart":k.on("touchstart"+h.ns,h.selector,h,p.click)}h.build||r.create(h);break;case "destroy":if(g){var t=h.context;b.each(d,function(a,e){if(!e||!b(t).is(e.selector))return!0;w=b(".context-menu-list").filter(":visible");w.length&&w.data().contextMenuRoot.$trigger.is(b(e.context).find(e.selector))&&w.trigger("contextmenu:hide",{force:!0});try{d[e.ns].$menu&&d[e.ns].$menu.remove(),
delete d[e.ns]}catch(z){d[e.ns]=null}b(e.context).off(e.ns);return!0})}else if(!h.selector)c.off(".contextMenu .contextMenuAutoHide"),b.each(d,function(d,a){b(a.context).off(a.ns)}),m={},d={},l=0,f=!1,b("#context-menu-layer, .context-menu-list").remove();else if(m[h.selector]){var w=b(".context-menu-list").filter(":visible");w.length&&w.data().contextMenuRoot.$trigger.is(h.selector)&&w.trigger("contextmenu:hide",{force:!0});try{d[m[h.selector]].$menu&&d[m[h.selector]].$menu.remove(),delete d[m[h.selector]]}catch(K){d[m[h.selector]]=
null}c.off(m[h.selector])}break;case "html5":(!b.support.htmlCommand&&!b.support.htmlMenuitem||"boolean"===typeof e&&e)&&b('menu[type="context"]').each(function(){this.id&&b.contextMenu({selector:"[contextmenu="+this.id+"]",items:b.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+a+'"');}return this};b.contextMenu.setInputValues=function(d,a){"undefined"===typeof a&&(a={});b.each(d.inputs,function(d,b){switch(b.type){case "text":case "textarea":b.value=
a[d]||"";break;case "checkbox":b.selected=a[d]?!0:!1;break;case "radio":b.selected=(a[b.radio]||"")===b.value;break;case "select":b.selected=a[d]||""}})};b.contextMenu.getInputValues=function(d,a){"undefined"===typeof a&&(a={});b.each(d.inputs,function(d,b){switch(b.type){case "text":case "textarea":case "select":a[d]=b.$input.val();break;case "checkbox":a[d]=b.$input.prop("checked");break;case "radio":b.$input.prop("checked")&&(a[b.radio]=b.value)}});return a};b.contextMenu.fromMenu=function(d){d=
b(d);var a={};c(a,d.children());return a};b.contextMenu.defaults=n;b.contextMenu.types=h;b.contextMenu.handle=p;b.contextMenu.op=r;b.contextMenu.menus=d});
(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):"object"===typeof exports?b(require("jquery")):b(jQuery)})(function(b){function g(a){var e=!1;b('[data-notify="container"]').each(function(c,f){c=b(f);f=c.find('[data-notify="title"]').html().trim();var k=c.find('[data-notify="message"]').html().trim();f=f===b("<div>"+a.settings.content.title+"</div>").html().trim();k=k===b("<div>"+a.settings.content.message+"</div>").html().trim();c=c.hasClass("alert-"+a.settings.type);f&&k&&
c&&(e=!0);return!e});return e}function a(a,f,k){k=b.extend(!0,{},{content:{message:"object"===typeof f?f.message:f,title:f.title?f.title:"",icon:f.icon?f.icon:"",url:f.url?f.url:"#",target:f.target?f.target:"-"}},k);this.settings=b.extend(!0,{},c,k);this._defaults=c;"-"===this.settings.content.target&&(this.settings.content.target=this.settings.url_target);this.animations={start:"webkitAnimationStart oanimationstart MSAnimationStart animationstart",end:"webkitAnimationEnd oanimationend MSAnimationEnd animationend"};
"number"===typeof this.settings.offset&&(this.settings.offset={x:this.settings.offset,y:this.settings.offset});(this.settings.allow_duplicates||!this.settings.allow_duplicates&&!g(this))&&this.init()}var c={element:"body",position:null,type:"info",allow_dismiss:!0,allow_duplicates:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5E3,timer:1E3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},
onShow:null,onShown:null,onClose:null,onClosed:null,onClick:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">&times;</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'};
String.format=function(){var a=arguments;return arguments[0].replace(/(\{\{\d\}\}|\{\d\})/g,function(b){if("{{"===b.substring(0,2))return b;b=parseInt(b.match(/\d/)[0]);return a[b+1]})};b.extend(a.prototype,{init:function(){var a=this;this.buildNotify();this.settings.content.icon&&this.setIcon();"#"!=this.settings.content.url&&this.styleURL();this.styleDismiss();this.placement();this.bind();this.notify={$ele:this.$ele,update:function(b,e){var c={};"string"===typeof b?c[b]=e:c=b;for(var f in c)switch(f){case "type":this.$ele.removeClass("alert-"+
a.settings.type);this.$ele.find('[data-notify="progressbar"] > .progress-bar').removeClass("progress-bar-"+a.settings.type);a.settings.type=c[f];this.$ele.addClass("alert-"+c[f]).find('[data-notify="progressbar"] > .progress-bar').addClass("progress-bar-"+c[f]);break;case "icon":e=this.$ele.find('[data-notify="icon"]');"class"===a.settings.icon_type.toLowerCase()?e.removeClass(a.settings.content.icon).addClass(c[f]):(e.is("img")||e.find("img"),e.attr("src",c[f]));a.settings.content.icon=c[b];break;
case "progress":this.$ele.data("notify-delay",a.settings.delay-c[f]/100*a.settings.delay);this.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",c[f]).css("width",c[f]+"%");break;case "url":this.$ele.find('[data-notify="url"]').attr("href",c[f]);break;case "target":this.$ele.find('[data-notify="url"]').attr("target",c[f]);break;default:this.$ele.find('[data-notify="'+f+'"]').html(c[f])}b=this.$ele.outerHeight()+parseInt(a.settings.spacing)+parseInt(a.settings.offset.y);a.reposition(b)},
close:function(){a.close()}}},buildNotify:function(){var a=this.settings.content;this.$ele=b(String.format(this.settings.template,this.settings.type,a.title,a.message,a.url,a.target));this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align);this.settings.allow_dismiss||this.$ele.find('[data-notify="dismiss"]').css("display","none");(0>=this.settings.delay&&!this.settings.showProgressbar||!this.settings.showProgressbar)&&this.$ele.find('[data-notify="progressbar"]').remove()},
setIcon:function(){"class"===this.settings.icon_type.toLowerCase()?this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon):this.$ele.find('[data-notify="icon"]').is("img")?this.$ele.find('[data-notify="icon"]').attr("src",this.settings.content.icon):this.$ele.find('[data-notify="icon"]').append('<img src="'+this.settings.content.icon+'" alt="Notify Icon" />')},styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"10px",top:"5px",zIndex:this.settings.z_index+
2})},styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},placement:function(){var a=this,c=this.settings.offset.y,k={display:"inline-block",margin:"0px auto",position:this.settings.position?this.settings.position:"body"===this.settings.element?"fixed":"absolute",transition:"all .5s ease-in-out",
zIndex:this.settings.z_index},g=!1,m=this.settings;b('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){c=Math.max(c,parseInt(b(this).css(m.placement.from))+parseInt(b(this).outerHeight())+parseInt(m.spacing))});!0===this.settings.newest_on_top&&(c=this.settings.offset.y);k[this.settings.placement.from]=c+"px";switch(this.settings.placement.align){case "left":case "right":k[this.settings.placement.align]=this.settings.offset.x+
"px";break;case "center":k.left=0,k.right=0}this.$ele.css(k).addClass(this.settings.animate.enter);b.each(["webkit-","moz-","o-","ms-",""],function(d,b){a.$ele[0].style[b+"AnimationIterationCount"]=1});b(this.settings.element).append(this.$ele);!0===this.settings.newest_on_top&&(c=parseInt(c)+parseInt(this.settings.spacing)+this.$ele.outerHeight(),this.reposition(c));b.isFunction(a.settings.onShow)&&a.settings.onShow.call(this.$ele);this.$ele.one(this.animations.start,function(){g=!0}).one(this.animations.end,
function(){a.$ele.removeClass(a.settings.animate.enter);b.isFunction(a.settings.onShown)&&a.settings.onShown.call(this)});setTimeout(function(){g||b.isFunction(a.settings.onShown)&&a.settings.onShown.call(this)},600)},bind:function(){var a=this;this.$ele.find('[data-notify="dismiss"]').on("click",function(){a.close()});if(b.isFunction(a.settings.onClick))this.$ele.on("click",function(b){b.target!=a.$ele.find('[data-notify="dismiss"]')[0]&&a.settings.onClick.call(this,b)});this.$ele.mouseover(function(){b(this).data("data-hover",
"true")}).mouseout(function(){b(this).data("data-hover","false")});this.$ele.data("data-hover","false");if(0<this.settings.delay){a.$ele.data("notify-delay",a.settings.delay);var c=setInterval(function(){var b=parseInt(a.$ele.data("notify-delay"))-a.settings.timer;if("false"===a.$ele.data("data-hover")&&"pause"===a.settings.mouse_over||"pause"!=a.settings.mouse_over){var e=(a.settings.delay-b)/a.settings.delay*100;a.$ele.data("notify-delay",b);a.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",
e).css("width",e+"%")}b<=-a.settings.timer&&(clearInterval(c),a.close())},a.settings.timer)}},close:function(){var a=this,c=parseInt(this.$ele.css(this.settings.placement.from)),k=!1;this.$ele.attr("data-closing","true").addClass(this.settings.animate.exit);a.reposition(c);b.isFunction(a.settings.onClose)&&a.settings.onClose.call(this.$ele);this.$ele.one(this.animations.start,function(){k=!0}).one(this.animations.end,function(){b(this).remove();b.isFunction(a.settings.onClosed)&&a.settings.onClosed.call(this)});
setTimeout(function(){k||(a.$ele.remove(),b.isFunction(a.settings.onClosed)&&a.settings.onClosed.call(this))},600)},reposition:function(a){var e=this,c='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',g=this.$ele.nextAll(c);!0===this.settings.newest_on_top&&(g=this.$ele.prevAll(c));g.each(function(){b(this).css(e.settings.placement.from,a);a=parseInt(a)+parseInt(e.settings.spacing)+b(this).outerHeight()})}});b.notify=function(b,
c){return(new a(this,b,c)).notify};b.notifyDefaults=function(a){return c=b.extend(!0,{},c,a)};b.notifyClose=function(a){"undefined"===typeof a||"all"===a?b("[data-notify]").find('[data-notify="dismiss"]').trigger("click"):"success"===a||"info"===a||"warning"===a||"danger"===a?b(".alert-"+a+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):a?b(a+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):b('[data-notify-position="'+a+'"]').find('[data-notify="dismiss"]').trigger("click")};
b.notifyCloseExcept=function(a){"success"===a||"info"===a||"warning"===a||"danger"===a?b("[data-notify]").not(".alert-"+a).find('[data-notify="dismiss"]').trigger("click"):b("[data-notify]").not(a).find('[data-notify="dismiss"]').trigger("click")}});
jQuery.fn.extend({autocompleteHelper:function(b,g){function a(a,e){a.val()?$.when(Resolver.resolveFromName(b,a.val())).then(function(b){b[a.val()]?(a.attr("data-value",b[a.val()].name),a.attr("data-id",b[a.val()].id),a.removeClass("is-invalid"),a.trigger("autocompleteChange")):(a.attr("data-id",""),a.attr("data-value",""),a.addClass("is-invalid"));e&&e()}):(a.attr("data-id",""),a.attr("data-value",""),a.removeClass("is-invalid"),a.trigger("autocompleteChange"),e&&e())}var c=$('<input class="js-typeahead form-control" type="search" autocomplete="off" />');
this.attr("name")&&c.attr("name",this.attr("name"));this.attr("id")&&c.attr("id",this.attr("id"));var e=$('<div class="typeahead__container form-control-container">').append($('<div class="typeahead__field">').append($('<span class="typeahead__query">').append(c)));this.replaceWith(e);c.typeahead({display:["name"],order:"asc",minLength:1,dynamic:!0,source:{users:{ajax:{url:fimApi.directory+"api/acHelper.php",data:{access_token:fimApi.lastSessionHash,list:b,search:"{{query}}"},path:"entries"}}},template:function(a,
b){return b.avatar?'<span class="userName userNameAvatar"><img src="{{avatar}}" style="max-width: 20px; max-height: 20px;"/> <span>{{name}}</span></span>':"<span>{{name}}</span>"},callback:{onClick:function(a,b,e,c){$(a).val(e.name);$(a).attr("data-id",e.id);$(a).attr("data-value",e.name);$(a).removeClass("is-invalid");$(a).trigger("autocompleteChange").change()},onCancel:function(a,b){$(a).attr("data-id","");$(a).attr("data-value","");$(a).removeClass("is-invalid");$(a).trigger("autocompleteChange").change()}}});
c.on("change",function(a){console.log("change",a)});c.off("keyup.autocompleteHelper").on("keyup.autocompleteHelper",function(a){$(a.target).attr("data-value")!=$(a.target).val()&&($(a.target).removeClass("is-invalid"),$(a.target).attr("data-id",""),$(a.target).attr("data-value",""))});c.closest("form").off("submit.autocompleteHelper").on("submit.autocompleteHelper",function(b){return!c.val()||c.attr("data-id")||c.hasClass("is-invalid")?!0:(console.log("fetcher invalid"),b.stopImmediatePropagation(),
a(c,function(){$(b.target).trigger("submit")}),!1)});g?$.when(Resolver.resolveFromId(b,g)).then(function(a){c.val(a[g].name);c.attr("data-value",a[g].name);c.attr("data-id",g)}):(c.val(""),c.attr("data-id",""),c.attr("data-value",""));return c}});
var notify={webkitNotifySupported:function(){return"Notification"in window},webkitNotifyRequest:function(){window.Notification.requestPermission()},webkitNotify:function(b,g,a){"granted"!=window.Notification.permission?notify.webkitNotifyRequest():new window.Notification(g,{body:a,icon:b,tag:"fm-notify"})}},dia={exception:function(b){$("#modal-dynamicException .modal-title").html("Exception: "+b.string);$("#modal-dynamicException .modal-body").html(b.details);$("#modal-dynamicException").modal();
console.log("Stack trace for "+b.string+":");console.log(b.trace)},error:function(b){console.log("Error: "+b);$("#modal-dynamicError .modal-body").html(b);$("#modal-dynamicError").modal()},info:function(b,g){$.notify({message:b},{type:g?g:"info",placement:{from:"top",align:"center"},delay:3E3})},confirm:function(b,g){$("#modal-dynamicConfirm .modal-title").text(g);$("#modal-dynamicConfirm .modal-body").html(b.text);$("#modal-dynamicConfirm button[name=confirm]").off("click").on("click",function(){if("undefined"!==
typeof b["true"])b["true"]();$("#modal-dynamicConfirm").modal("hide")});$("#modal-dynamicConfirm button[name=cancel]").off("click").on("click",function(){if("undefined"!==typeof b["false"])b["false"]();$("#modal-dynamicConfirm").modal("hide")});$("#modal-dynamicConfirm").modal()},full:function(b){$("#modal-dynamicFull .modal-title").text(b.title);$("#modal-dynamicFull .modal-body").html(b.content);$("#modal-dynamicFull").modal();$("#modal-dynamicFull .modal-footer").html("");jQuery.each(b.buttons,
function(b,a){$("#modal-dynamicFull .modal-footer").append($("<button>").attr("class","btn btn-secondary").text(b).click(function(){a();$("#modal-dynamicFull").modal("hide");return!1}))});"undefined"!==typeof b.oF&&b.oF();if("undefined"!==typeof b.cF)$("#modal-dynamicFull").on("hidden.bs.modal",function(){b.cF()})}};
(function(b,g,a){function c(d){d=d||location.href;return"#"+d.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var e=document,f=b.event.special,k=e.documentMode,l="onhashchange"in g&&(k===a||7<k);b.fn.hashchange=function(d){return d?this.bind("hashchange",d):this.trigger("hashchange")};b.fn.hashchange.delay=50;f.hashchange=b.extend(f.hashchange,{setup:function(){if(l)return!1;b(m.start)},teardown:function(){if(l)return!1;b(m.stop)}});var m=function(){function d(){var a=c(),h=m(k);a!==k?(w(k=a,h),b(g).trigger("hashchange")):
h!==k&&(location.href=location.href.replace(/#.*/,"")+h);f=setTimeout(d,b.fn.hashchange.delay)}var h={},f,k=c(),v=function(d){return d},w=v,m=v;h.start=function(){f||d()};h.stop=function(){f&&clearTimeout(f);f=a};navigator.userAgent.match(/msie [6,7,8]/i)&&!l&&function(){var a,f;h.start=function(){a||(f=(f=b.fn.hashchange.src)&&f+c(),a=b('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){f||w(c());d()}).attr("src",f||"javascript:0").insertAfter("body")[0].contentWindow,e.onpropertychange=
function(){try{"title"===event.propertyName&&(a.document.title=e.title)}catch(r){}})};h.stop=v;m=function(){return c(a.location.href)};w=function(d,h){var c=a.document,f=b.fn.hashchange.domain;d!==h&&(c.title=e.title,c.open(),f&&c.write('<script>document.domain="'+f+'"\x3c/script>'),c.close(),a.location.hash=d)}}();return h}()})(jQuery,this);
jQuery.base64=function(b){function g(a,b){a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(b));if(-1===a)throw"Cannot decode base64";return a}function a(a,b){a=a.charCodeAt(b);if(255<a)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return a}return{decode:function(a){var b=0,c,k=a.length,l=[];a=String(a);if(0===k)return a;if(0!==k%4)throw"Cannot decode base64";"="===a.charAt(k-1)&&(b=1,"="===a.charAt(k-2)&&(b=2),k-=4);for(c=0;c<k;c+=4){var m=g(a,c)<<18|g(a,c+1)<<
12|g(a,c+2)<<6|g(a,c+3);l.push(String.fromCharCode(m>>16,m>>8&255,m&255))}switch(b){case 1:m=g(a,c)<<18|g(a,c+1)<<12|g(a,c+2)<<6;l.push(String.fromCharCode(m>>16,m>>8&255));break;case 2:m=g(a,c)<<18|g(a,c+1)<<12,l.push(String.fromCharCode(m>>16))}return l.join("")},encode:function(b){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";b=String(b);var e,c=[],k=b.length-b.length%3;if(0===b.length)return b;for(e=0;e<k;e+=3){var g=a(b,e)<<16|a(b,e+1)<<8|a(b,e+2);c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>
18));c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>12&63));c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>6&63));c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g&63))}switch(b.length-k){case 1:g=a(b,e)<<16;c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>12&63)+"==");break;case 2:g=
a(b,e)<<16|a(b,e+1)<<8,c.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>18)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>6&63)+"=")}return c.join("")},VERSION:"1.0"}}(jQuery);
(function(b){"function"===typeof define&&define.amd?define(["jquery","jquery-ui/ui/widget"],b):"object"===typeof exports?b(require("jquery"),require("./vendor/jquery.ui.widget")):b(window.jQuery)})(function(b){function g(a){var c="dragover"===a;return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var f=e.dataTransfer;f&&-1!==b.inArray("Files",f.types)&&!1!==this._trigger(a,b.Event(a,{delegatedEvent:e}))&&(e.preventDefault(),c&&(f.dropEffect="copy"))}}b.support.fileInput=
!(/(Android (1\.[0156]|2\.[01]))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.[05]|3\.0))/.test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),
pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},
i18n:function(a,c){a=this.messages[a]||a.toString();c&&b.each(c,function(b,c){a=a.replace("{"+b+"}",c)});return a},formData:function(a){return a.serializeArray()},add:function(a,c){if(a.isDefaultPrevented())return!1;(c.autoUpload||!1!==c.autoUpload&&b(this).fileupload("option","autoUpload"))&&c.process().done(function(){c.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&
function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime();this.bitrate=this.loaded=0;this.getBitrate=function(a,b,e){var c=a-this.timestamp;if(!this.bitrate||!e||c>e)this.bitrate=1E3/c*(b-this.loaded)*8,this.loaded=b,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(a){if("function"===
b.type(a.formData))return a.formData(a.form);if(b.isArray(a.formData))return a.formData;if("object"===b.type(a.formData)){var c=[];b.each(a.formData,function(a,b){c.push({name:a,value:b})});return c}return[]},_getTotal:function(a){var c=0;b.each(a,function(a,b){c+=b.size||1});return c},_initProgressObject:function(a){var c={loaded:0,total:0,bitrate:0};a._progress?b.extend(a._progress,c):a._progress=c},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&
delete a._response[b];else a._response={}},_onProgress:function(a,c){if(a.lengthComputable){var e=Date.now?Date.now():(new Date).getTime();if(!(c._time&&c.progressInterval&&e-c._time<c.progressInterval&&a.loaded!==a.total)){c._time=e;var f=Math.floor(a.loaded/a.total*(c.chunkSize||c._progress.total))+(c.uploadedBytes||0);this._progress.loaded+=f-c._progress.loaded;this._progress.bitrate=this._bitrateTimer.getBitrate(e,this._progress.loaded,c.bitrateInterval);c._progress.loaded=c.loaded=f;c._progress.bitrate=
c.bitrate=c._bitrateTimer.getBitrate(e,f,c.bitrateInterval);this._trigger("progress",b.Event("progress",{delegatedEvent:a}),c);this._trigger("progressall",b.Event("progressall",{delegatedEvent:a}),this._progress)}}},_initProgressListener:function(a){var c=this,e=a.xhr?a.xhr():b.ajaxSettings.xhr();e.upload&&(b(e.upload).bind("progress",function(b){var e=b.originalEvent;b.lengthComputable=e.lengthComputable;b.loaded=e.loaded;b.total=e.total;c._onProgress(b,a)}),a.xhr=function(){return e})},_isInstanceOf:function(a,
b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var c=this,e=a.files[0],f=a.multipart||!b.support.xhrFileUpload,k="array"===b.type(a.paramName)?a.paramName[0]:a.paramName;a.headers=b.extend({},a.headers);a.contentRange&&(a.headers["Content-Range"]=a.contentRange);f&&!a.blob&&this._isInstanceOf("File",e)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"');if(!f)a.contentType=e.type||"application/octet-stream",a.data=a.blob||e;
else if(b.support.xhrFormDataFileUpload){if(a.postMessage){var g=this._getFormData(a);a.blob?g.push({name:k,value:a.blob}):b.each(a.files,function(e,d){g.push({name:"array"===b.type(a.paramName)&&a.paramName[e]||k,value:d})})}else c._isInstanceOf("FormData",a.formData)?g=a.formData:(g=new FormData,b.each(this._getFormData(a),function(a,d){g.append(d.name,d.value)})),a.blob?g.append(k,a.blob,e.name):b.each(a.files,function(e,d){(c._isInstanceOf("File",d)||c._isInstanceOf("Blob",d))&&g.append("array"===
b.type(a.paramName)&&a.paramName[e]||k,d,d.uploadName||d.name)});a.data=g}a.blob=null},_initIframeSettings:function(a){var c=b("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);a.redirect&&c&&c!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&
(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var c=b(a.fileInput),e=a.paramName;e?b.isArray(e)||(e=[e]):(e=[],c.each(function(){var a=b(this),c=a.prop("name")||"files[]";for(a=(a.prop("files")||[1]).length;a;)e.push(c),--a}),e.length||(e=[c.prop("name")||"files[]"]));return e},_initFormSettings:function(a){a.form&&a.form.length||(a.form=b(a.fileInput.prop("form")),a.form.length||(a.form=b(this.options.fileInput.prop("form"))));a.paramName=this._getParamName(a);
a.url||(a.url=a.form.prop("action")||location.href);a.type=(a.type||"string"===b.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase();"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST");a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){a=b.extend({},this.options,a);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?
"rejected":"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(a,c,e){var f=b.Deferred(),g=f.promise();c=c||this.options.context||g;!0===a?f.resolveWith(c,e):!1===a&&f.rejectWith(c,e);g.abort=f.promise;return this._enhancePromise(g)},_addConvenienceMethods:function(a,c){var e=this,f=function(a){return b.Deferred().resolveWith(e,a).promise()};c.process=function(a,g){if(a||g)c._processQueue=this._processQueue=(this._processQueue||
f([this])).then(function(){return c.errorThrown?b.Deferred().rejectWith(e,[c]).promise():f(arguments)}).then(a,g);return this._processQueue||f([this])};c.submit=function(){"pending"!==this.state()&&(c.jqXHR=this.jqXHR=!1!==e._trigger("submit",b.Event("submit",{delegatedEvent:a}),this)&&e._onSend(a,this));return this.jqXHR||e._getXHRPromise()};c.abort=function(){if(this.jqXHR)return this.jqXHR.abort();this.errorThrown="abort";e._trigger("fail",null,this);return e._getXHRPromise(!1)};c.state=function(){if(this.jqXHR)return e._getDeferredState(this.jqXHR);
if(this._processQueue)return e._getDeferredState(this._processQueue)};c.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===e._getDeferredState(this._processQueue)};c.progress=function(){return this._progress};c.response=function(){return this._response}},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(a,c){a.uploadedBytes=a.uploadedBytes||0;var e=this,f=a.files[0],g=f.size,
l=a.uploadedBytes,m=a.maxChunkSize||g,d=this._blobSlice,h=b.Deferred(),n=h.promise(),t;if(!(this._isXHRUpload(a)&&d&&(l||("function"===b.type(m)?m(a):m)<g))||a.data)return!1;if(c)return!0;if(l>=g)return f.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",f.error]);var v=function(){var c=b.extend({},a),n=c._progress.loaded;c.blob=d.call(f,l,l+("function"===b.type(m)?m(c):m),f.type);c.chunkSize=c.blob.size;c.contentRange="bytes "+l+"-"+(l+c.chunkSize-1)+"/"+g;e._initXHRData(c);
e._initProgressListener(c);t=(!1!==e._trigger("chunksend",null,c)&&b.ajax(c)||e._getXHRPromise(!1,c.context)).done(function(d,f,k){l=e._getUploadedBytes(k)||l+c.chunkSize;n+c.chunkSize-c._progress.loaded&&e._onProgress(b.Event("progress",{lengthComputable:!0,loaded:l-c.uploadedBytes,total:l-c.uploadedBytes}),c);a.uploadedBytes=c.uploadedBytes=l;c.result=d;c.textStatus=f;c.jqXHR=k;e._trigger("chunkdone",null,c);e._trigger("chunkalways",null,c);l<g?v():h.resolveWith(c.context,[d,f,k])}).fail(function(a,
d,b){c.jqXHR=a;c.textStatus=d;c.errorThrown=b;e._trigger("chunkfail",null,c);e._trigger("chunkalways",null,c);h.rejectWith(c.context,[a,d,b])})};this._enhancePromise(n);n.abort=function(){return t.abort()};v();return n},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0);this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||
0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(a,c,e,f){var g=f._progress.total,l=f._response;f._progress.loaded<g&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:g,total:g}),f);l.result=f.result=a;l.textStatus=f.textStatus=c;l.jqXHR=f.jqXHR=e;this._trigger("done",null,f)},_onFail:function(a,b,e,f){var c=f._response;f.recalculateProgress&&(this._progress.loaded-=
f._progress.loaded,this._progress.total-=f._progress.total);c.jqXHR=f.jqXHR=a;c.textStatus=f.textStatus=b;c.errorThrown=f.errorThrown=e;this._trigger("fail",null,f)},_onAlways:function(a,b,e,f){this._trigger("always",null,f)},_onSend:function(a,c){c.submit||this._addConvenienceMethods(a,c);var e=this,f,g,l=e._getAJAXSettings(c),m=function(){e._sending+=1;l._bitrateTimer=new e._BitrateTimer;return f=f||((g||!1===e._trigger("send",b.Event("send",{delegatedEvent:a}),l))&&e._getXHRPromise(!1,l.context,
g)||e._chunkedUpload(l)||b.ajax(l)).done(function(a,d,b){e._onDone(a,d,b,l)}).fail(function(a,d,b){e._onFail(a,d,b,l)}).always(function(a,d,b){e._onAlways(a,d,b,l);--e._sending;--e._active;if(l.limitConcurrentUploads&&l.limitConcurrentUploads>e._sending)for(a=e._slots.shift();a;){if("pending"===e._getDeferredState(a)){a.resolve();break}a=e._slots.shift()}0===e._active&&e._trigger("stop")})};this._beforeSend(a,l);if(this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=
this._sending){if(1<this.options.limitConcurrentUploads){var d=b.Deferred();this._slots.push(d);c=d.then(m)}else c=this._sequence=this._sequence.then(m,m);c.abort=function(){g=[void 0,"abort","abort"];return f?f.abort():(d&&d.rejectWith(l.context,g),m())};return this._enhancePromise(c)}return m()},_onAdd:function(a,c){var e=this,f=!0,g=b.extend({},this.options,c),l=c.files,m=l.length,d=g.limitMultiFileUploads,h=g.limitMultiFileUploadSize,n=g.limitMultiFileUploadSizeOverhead,t=0,v=this._getParamName(g),
w=0;if(!m)return!1;h&&void 0===l[0].size&&(h=void 0);if((g.singleFileUploads||d||h)&&this._isXHRUpload(g))if(g.singleFileUploads||h||!d)if(!g.singleFileUploads&&h){var D=[];var B=[];for(g=0;g<m;g+=1)if(t+=l[g].size+n,g+1===m||t+l[g+1].size+n>h||d&&g+1-w>=d)D.push(l.slice(w,g+1)),t=v.slice(w,g+1),t.length||(t=v),B.push(t),w=g+1,t=0}else B=v;else for(D=[],B=[],g=0;g<m;g+=d)D.push(l.slice(g,g+d)),t=v.slice(g,g+d),t.length||(t=v),B.push(t);else D=[l],B=[v];c.originalFiles=l;b.each(D||l,function(d,h){var n=
b.extend({},c);n.files=D?h:[h];n.paramName=B[d];e._initResponseObject(n);e._initProgressObject(n);e._addConvenienceMethods(a,n);return f=e._trigger("add",b.Event("add",{delegatedEvent:a}),n)});return f},_replaceFileInput:function(a){var c=a.fileInput,e=c.clone(!0),f=c.is(document.activeElement);a.fileInputClone=e;b("<form></form>").append(e)[0].reset();c.after(e).detach();f&&e.focus();b.cleanData(c.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(a,b){return b===c[0]?e[0]:
b});c[0]===this.element[0]&&(this.element=e)},_handleFileTreeEntry:function(a,c){var e=this,f=b.Deferred(),g=[],l=function(d){d&&!d.entry&&(d.entry=a);f.resolve([d])},m=function(d){e._handleFileTreeEntries(d,c+a.name+"/").done(function(a){f.resolve(a)}).fail(l)},d=function(){h.readEntries(function(a){a.length?(g=g.concat(a),d()):m(g)},l)};c=c||"";if(a.isFile)a._file?(a._file.relativePath=c,f.resolve(a._file)):a.file(function(a){a.relativePath=c;f.resolve(a)},l);else if(a.isDirectory){var h=a.createReader();
d()}else f.resolve([]);return f.promise()},_handleFileTreeEntries:function(a,c){var e=this;return b.when.apply(b,b.map(a,function(a){return e._handleFileTreeEntry(a,c)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var c=a.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(b.map(c,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):
b.Deferred().resolve(b.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=b(a);var c=a.prop("webkitEntries")||a.prop("entries");if(c&&c.length)return this._handleFileTreeEntries(c);c=b.makeArray(a.prop("files"));if(c.length)void 0===c[0].name&&c[0].fileName&&b.each(c,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{a=a.prop("value");if(!a)return b.Deferred().resolve([]).promise();c=[{name:a.replace(/^.*\\/,"")}]}return b.Deferred().resolve(c).promise()},_getFileInputFiles:function(a){return a instanceof
b&&1!==a.length?b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var c=this,e={fileInput:b(a.target),form:b(a.target.form)};this._getFileInputFiles(e.fileInput).always(function(f){e.files=f;c.options.replaceFileInput&&c._replaceFileInput(e);!1!==c._trigger("change",b.Event("change",{delegatedEvent:a}),e)&&c._onAdd(a,e)})},_onPaste:function(a){var c=a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.items,e={files:[]};c&&c.length&&(b.each(c,function(a,b){(a=b.getAsFile&&b.getAsFile())&&e.files.push(a)}),!1!==this._trigger("paste",b.Event("paste",{delegatedEvent:a}),e)&&this._onAdd(a,e))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var c=this,e=a.dataTransfer,f={};e&&e.files&&e.files.length&&(a.preventDefault(),this._getDroppedFiles(e).always(function(e){f.files=e;!1!==c._trigger("drop",b.Event("drop",{delegatedEvent:a}),f)&&c._onAdd(a,
f)}))},_onDragOver:g("dragover"),_onDragEnter:g("dragenter"),_onDragLeave:g("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste}));b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");
this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(a,c){var e=-1!==b.inArray(a,this._specialOptions);e&&this._destroyEventHandlers();this._super(a,c);e&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;void 0===a.fileInput?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof
b||(a.fileInput=b(a.fileInput));a.dropZone instanceof b||(a.dropZone=b(a.dropZone));a.pasteZone instanceof b||(a.pasteZone=b(a.pasteZone))},_getRegExp:function(a){a=a.split("/");var b=a.pop();a.shift();return new RegExp(a.join("/"),b)},_isRegExpOption:function(a,c){return"url"!==a&&"string"===b.type(c)&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var a=this,c=this.options,e=this.element.data();b.each(this.element[0].attributes,function(b,g){b=g.name.toLowerCase();/^data-/.test(b)&&
(b=b.slice(5).replace(/-[a-z]/g,function(a){return a.charAt(1).toUpperCase()}),g=e[b],a._isRegExpOption(b,g)&&(g=a._getRegExp(g)),c[b]=g)})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var c=this;a&&!this.options.disabled&&(a.fileInput&&
!a.files?this._getFileInputFiles(a.fileInput).always(function(b){a.files=b;c._onAdd(null,a)}):(a.files=b.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var c=this,e=b.Deferred(),f=e.promise(),g,l;f.abort=function(){l=!0;if(g)return g.abort();e.reject(null,"abort","abort");return f};this._getFileInputFiles(a.fileInput).always(function(b){l||(b.length?(a.files=b,g=c._onSend(null,a),g.then(function(a,b,c){e.resolve(a,b,c)},function(a,
b,c){e.reject(a,b,c)})):e.reject())});return this._enhancePromise(f)}a.files=b.makeArray(a.files);if(a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})});
(function(b){if("function"===typeof define&&define.amd)define(["jquery"],b);else if("object"===typeof exports){var g=require("jquery");module.exports=b(g)}else b(window.jQuery||window.Zepto||window.$)})(function(b){b.fn.serializeJSON=function(g){var a,c,e,f,k,l,m,d;var h=b.serializeJSON;var n=this;var t=h.setupOpts(g);g=n.serializeArray();h.readCheckboxUncheckedValues(g,t,n);var v={};b.each(g,function(b,g){a=g.name;c=g.value;f=h.extractTypeAndNameWithNoType(a);k=f.nameWithNoType;(l=f.type)||(l=h.attrFromInputWithName(n,
a,"data-value-type"));h.validateType(a,l,t);"skip"!==l&&(m=h.splitInputNameIntoKeysArray(k),e=h.parseValue(c,a,l,t),(d=!e&&h.shouldSkipFalsy(n,a,k,l,t))||h.deepSet(v,m,e,t))});return v};b.serializeJSON={defaultOptions:{checkboxUncheckedValue:void 0,parseNumbers:!1,parseBooleans:!1,parseNulls:!1,parseAll:!1,parseWithFunction:null,skipFalsyValuesForTypes:[],skipFalsyValuesForFields:[],customTypes:{},defaultTypes:{string:function(b){return String(b)},number:function(b){return Number(b)},"boolean":function(b){return-1===
["false","null","undefined","","0"].indexOf(b)},"null":function(b){return-1===["false","null","undefined","","0"].indexOf(b)?b:null},array:function(b){return JSON.parse(b)},object:function(b){return JSON.parse(b)},auto:function(g){return b.serializeJSON.parseValue(g,null,null,{parseNumbers:!0,parseBooleans:!0,parseNulls:!0})},skip:null},useIntKeysAsArrayIndex:!1},setupOpts:function(g){var a=b.serializeJSON;null==g&&(g={});var c=a.defaultOptions||{};a="checkboxUncheckedValue parseNumbers parseBooleans parseNulls parseAll parseWithFunction skipFalsyValuesForTypes skipFalsyValuesForFields customTypes defaultTypes useIntKeysAsArrayIndex".split(" ");
for(e in g)if(-1===a.indexOf(e))throw Error("serializeJSON ERROR: invalid option '"+e+"'. Please use one of "+a.join(", "));var e=function(a){return!1!==g[a]&&""!==g[a]&&(g[a]||c[a])};a=e("parseAll");return{checkboxUncheckedValue:e("checkboxUncheckedValue"),parseNumbers:a||e("parseNumbers"),parseBooleans:a||e("parseBooleans"),parseNulls:a||e("parseNulls"),parseWithFunction:e("parseWithFunction"),skipFalsyValuesForTypes:e("skipFalsyValuesForTypes"),skipFalsyValuesForFields:e("skipFalsyValuesForFields"),
typeFunctions:b.extend({},e("defaultTypes"),e("customTypes")),useIntKeysAsArrayIndex:e("useIntKeysAsArrayIndex")}},parseValue:function(g,a,c,e){var f=b.serializeJSON;var k=g;e.typeFunctions&&c&&e.typeFunctions[c]?k=e.typeFunctions[c](g):e.parseNumbers&&f.isNumeric(g)?k=Number(g):!e.parseBooleans||"true"!==g&&"false"!==g?e.parseNulls&&"null"==g?k=null:e.typeFunctions&&e.typeFunctions.string&&(k=e.typeFunctions.string(g)):k="true"===g;e.parseWithFunction&&!c&&(k=e.parseWithFunction(k,a));return k},
isObject:function(b){return b===Object(b)},isUndefined:function(b){return void 0===b},isValidArrayIndex:function(b){return/^[0-9]+$/.test(String(b))},isNumeric:function(b){return 0<=b-parseFloat(b)},optionKeys:function(b){if(Object.keys)return Object.keys(b);var a,c=[];for(a in b)c.push(a);return c},readCheckboxUncheckedValues:function(g,a,c){var e,f;null==a&&(a={});c.find("input[type=checkbox][name]:not(:checked):not([disabled])").add(c.filter("input[type=checkbox][name]:not(:checked):not([disabled])")).each(function(c,
l){e=b(l);f=e.attr("data-unchecked-value");null==f&&(f=a.checkboxUncheckedValue);if(null!=f){if(l.name&&-1!==l.name.indexOf("[]["))throw Error("serializeJSON ERROR: checkbox unchecked values are not supported on nested arrays of objects like '"+l.name+"'. See https://github.com/marioizquierdo/jquery.serializeJSON/issues/67");g.push({name:l.name,value:f})}})},extractTypeAndNameWithNoType:function(b){var a;return(a=b.match(/(.*):([^:]+)$/))?{nameWithNoType:a[1],type:a[2]}:{nameWithNoType:b,type:null}},
shouldSkipFalsy:function(g,a,c,e,f){g=b.serializeJSON.attrFromInputWithName(g,a,"data-skip-falsy");if(null!=g)return"false"!==g;if((g=f.skipFalsyValuesForFields)&&(-1!==g.indexOf(c)||-1!==g.indexOf(a)))return!0;a=f.skipFalsyValuesForTypes;null==e&&(e="string");return a&&-1!==a.indexOf(e)?!0:!1},attrFromInputWithName:function(b,a,c){a='[name="'+a.replace(/(:|\.|\[|\]|\s)/g,"\\$1")+'"]';return b.find(a).add(b.filter(a)).attr(c)},validateType:function(g,a,c){var e=b.serializeJSON;c=e.optionKeys(c?c.typeFunctions:
e.defaultOptions.defaultTypes);if(a&&-1===c.indexOf(a))throw Error("serializeJSON ERROR: Invalid type "+a+" found in input name '"+g+"', please use one of "+c.join(", "));return!0},splitInputNameIntoKeysArray:function(g){g=g.split("[");g=b.map(g,function(a){return a.replace(/\]/g,"")});""===g[0]&&g.shift();return g},deepSet:function(g,a,c,e){null==e&&(e={});var f=b.serializeJSON;if(f.isUndefined(g))throw Error("ArgumentError: param 'o' expected to be an object or array, found undefined");if(!a||0===
a.length)throw Error("ArgumentError: param 'keys' expected to be an array with least one element");var k=a[0];if(1===a.length)""===k?g.push(c):g[k]=c;else{var l=a[1];if(""===k){k=g.length-1;var m=g[k];k=f.isObject(m)&&(f.isUndefined(m[l])||2<a.length)?k:k+1}if(""===l){if(f.isUndefined(g[k])||!b.isArray(g[k]))g[k]=[]}else if(e.useIntKeysAsArrayIndex&&f.isValidArrayIndex(l)){if(f.isUndefined(g[k])||!b.isArray(g[k]))g[k]=[]}else if(f.isUndefined(g[k])||!f.isObject(g[k]))g[k]={};a=a.slice(1);f.deepSet(g[k],
a,c,e)}}}});
(function(b){"function"===typeof define&&define.amd?define("jquery-typeahead",["jquery"],function(g){return b(g)}):"object"===typeof module&&module.exports?module.exports=function(g,a){void 0===g&&(g="undefined"!==typeof window?require("jquery"):require("jquery")(a));return b(g)}():b(jQuery)})(function(b){window.Typeahead={version:"2.10.4"};var g={input:null,minLength:2,maxLength:!1,maxItem:8,dynamic:!1,delay:300,order:null,offset:!1,hint:!1,accent:!1,highlight:!0,multiselect:null,group:!1,groupOrder:null,
maxItemPerGroup:null,dropdownFilter:!1,dynamicFilter:null,backdrop:!1,backdropOnFocus:!1,cache:!1,ttl:36E5,compression:!1,searchOnFocus:!1,blurOnTab:!0,resultContainer:null,generateOnLoad:null,mustSelectItem:!1,href:null,display:["display"],template:null,templateValue:null,groupTemplate:null,correlativeTemplate:!1,emptyTemplate:!1,cancelButton:!0,loadingAnimation:!0,filter:!0,matcher:null,source:null,callback:{onInit:null,onReady:null,onShowLayout:null,onHideLayout:null,onSearch:null,onResult:null,
onLayoutBuiltBefore:null,onLayoutBuiltAfter:null,onNavigateBefore:null,onNavigateAfter:null,onEnter:null,onLeave:null,onClickBefore:null,onClickAfter:null,onDropdownFilter:null,onSendRequest:null,onReceiveRequest:null,onPopulateSource:null,onCacheSave:null,onSubmit:null,onCancel:null},selector:{container:"typeahead__container",result:"typeahead__result",list:"typeahead__list",group:"typeahead__group",item:"typeahead__item",empty:"typeahead__empty",display:"typeahead__display",query:"typeahead__query",
filter:"typeahead__filter",filterButton:"typeahead__filter-button",dropdown:"typeahead__dropdown",dropdownItem:"typeahead__dropdown-item",labelContainer:"typeahead__label-container",label:"typeahead__label",button:"typeahead__button",backdrop:"typeahead__backdrop",hint:"typeahead__hint",cancelButton:"typeahead__cancel-button"},debug:!1},a={from:"\u00e3\u00e0\u00e1\u00e4\u00e2\u1ebd\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u00f5\u00f2\u00f3\u00f6\u00f4\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7",to:"aaaaaeeeeeiiiiooooouuuunc"},
c=~window.navigator.appVersion.indexOf("MSIE 9."),e=~window.navigator.appVersion.indexOf("MSIE 10"),f=~window.navigator.userAgent.indexOf("Trident")?~window.navigator.userAgent.indexOf("rv:11"):!1,k=function(a,b){this.rawQuery=a.val()||"";this.query=a.val()||"";this.selector=a[0].selector;this.deferred=null;this.tmpSource={};this.source={};this.dynamicGroups=[];this.hasDynamicGroups=!1;this.generatedGroupCount=0;this.groupBy="group";this.groups=[];this.searchGroups=[];this.generateGroups=[];this.requestGroups=
[];this.result=[];this.tmpResult={};this.groupTemplate="";this.resultHtml=null;this.resultCount=0;this.resultCountPerGroup={};this.options=b;this.node=a;this.namespace="."+this.helper.slugify.call(this,this.selector)+".typeahead";this.isContentEditable="undefined"!==typeof this.node.attr("contenteditable")&&"false"!==this.node.attr("contenteditable");this.comparedItems=this.items=this.item=this.resultContainer=this.container=null;this.xhr={};this.hintIndex=null;this.filters={dropdown:{},dynamic:{}};
this.dropdownFilter={static:[],dynamic:[]};this.dropdownFilterAll=null;this.isDropdownEvent=!1;this.requests={};this.backdrop={};this.hint={};this.label={};this.focusOnly=this.hasDragged=!1;this.__construct()};k.prototype={_validateCacheMethod:function(a){var d=["localStorage","sessionStorage"];if(!0===a)a="localStorage";else if("string"===typeof a&&!~d.indexOf(a))return this.options.debug&&(m.log({node:this.selector,function:"extendOptions()",message:'Invalid options.cache, possible options are "localStorage" or "sessionStorage"'}),
m.print()),!1;d="undefined"!==typeof window[a];try{window[a].setItem("typeahead","typeahead"),window[a].removeItem("typeahead")}catch(n){d=!1}return d&&a||!1},extendOptions:function(){this.options.cache=this._validateCacheMethod(this.options.cache);!this.options.compression||"object"===typeof LZString&&this.options.cache||(this.options.debug&&(m.log({node:this.selector,function:"extendOptions()",message:"Missing LZString Library or options.cache, no compression will occur."}),m.print()),this.options.compression=
!1);if(!this.options.maxLength||isNaN(this.options.maxLength))this.options.maxLength=Infinity;"undefined"!==typeof this.options.maxItem&&~[0,!1].indexOf(this.options.maxItem)&&(this.options.maxItem=Infinity);this.options.maxItemPerGroup&&!/^\d+$/.test(this.options.maxItemPerGroup)&&(this.options.maxItemPerGroup=null);this.options.display&&!Array.isArray(this.options.display)&&(this.options.display=[this.options.display]);this.options.multiselect&&(this.items=[],this.comparedItems=[],"string"===typeof this.options.multiselect.matchOn&&
(this.options.multiselect.matchOn=[this.options.multiselect.matchOn]));this.options.group&&(Array.isArray(this.options.group)?this.options.debug&&(m.log({node:this.selector,function:"extendOptions()",message:"options.group must be a boolean|string|object as of 2.5.0"}),m.print()):("string"===typeof this.options.group?this.options.group={key:this.options.group}:"boolean"===typeof this.options.group&&(this.options.group={key:"group"}),this.options.group.key=this.options.group.key||"group"));this.options.highlight&&
!~["any",!0].indexOf(this.options.highlight)&&(this.options.highlight=!1);if(this.options.dropdownFilter&&this.options.dropdownFilter instanceof Object){Array.isArray(this.options.dropdownFilter)||(this.options.dropdownFilter=[this.options.dropdownFilter]);for(var d=0,h=this.options.dropdownFilter.length;d<h;++d)this.dropdownFilter[this.options.dropdownFilter[d].value?"static":"dynamic"].push(this.options.dropdownFilter[d])}this.options.dynamicFilter&&!Array.isArray(this.options.dynamicFilter)&&(this.options.dynamicFilter=
[this.options.dynamicFilter]);this.options.accent&&("object"===typeof this.options.accent?this.options.accent.from&&this.options.accent.to&&this.options.accent.from.length!==this.options.accent.to.length&&this.options.debug&&(m.log({node:this.selector,function:"extendOptions()",message:'Invalid "options.accent", from and to must be defined and same length.'}),m.print()):this.options.accent=a);this.options.groupTemplate&&(this.groupTemplate=this.options.groupTemplate);this.options.resultContainer&&
("string"===typeof this.options.resultContainer&&(this.options.resultContainer=b(this.options.resultContainer)),this.options.resultContainer instanceof b&&this.options.resultContainer[0]?this.resultContainer=this.options.resultContainer:this.options.debug&&(m.log({node:this.selector,function:"extendOptions()",message:'Invalid jQuery selector or jQuery Object for "options.resultContainer".'}),m.print()));this.options.maxItemPerGroup&&this.options.group&&this.options.group.key&&(this.groupBy=this.options.group.key);
this.options.callback&&this.options.callback.onClick&&(this.options.callback.onClickBefore=this.options.callback.onClick,delete this.options.callback.onClick);this.options.callback&&this.options.callback.onNavigate&&(this.options.callback.onNavigateBefore=this.options.callback.onNavigate,delete this.options.callback.onNavigate);this.options=b.extend(!0,{},g,this.options)},unifySourceFormat:function(){this.dynamicGroups=[];Array.isArray(this.options.source)&&(this.options.source={group:{data:this.options.source}});
"string"===typeof this.options.source&&(this.options.source={group:{ajax:{url:this.options.source}}});this.options.source.ajax&&(this.options.source={group:{ajax:this.options.source.ajax}});if(this.options.source.url||this.options.source.data)this.options.source={group:this.options.source};var a;for(a in this.options.source)if(this.options.source.hasOwnProperty(a)){var b=this.options.source[a];"string"===typeof b&&(b={ajax:{url:b}});var e=b.url||b.ajax;Array.isArray(e)?(b.ajax="string"===typeof e[0]?
{url:e[0]}:e[0],b.ajax.path=b.ajax.path||e[1]||null):"object"===typeof b.url?b.ajax=b.url:"string"===typeof b.url&&(b.ajax={url:b.url});delete b.url;if(!b.data&&!b.ajax)return this.options.debug&&(m.log({node:this.selector,function:"unifySourceFormat()",arguments:JSON.stringify(this.options.source),message:'Undefined "options.source.'+a+'.[data|ajax]" is Missing - Typeahead dropped'}),m.print()),!1;b.display&&!Array.isArray(b.display)&&(b.display=[b.display]);b.minLength="number"===typeof b.minLength?
b.minLength:this.options.minLength;b.maxLength="number"===typeof b.maxLength?b.maxLength:this.options.maxLength;b.dynamic="boolean"===typeof b.dynamic||this.options.dynamic;b.minLength>b.maxLength&&(b.minLength=b.maxLength);this.options.source[a]=b;this.options.source[a].dynamic&&this.dynamicGroups.push(a);b.cache="undefined"!==typeof b.cache?this._validateCacheMethod(b.cache):this.options.cache;!b.compression||"object"===typeof LZString&&b.cache||(this.options.debug&&(m.log({node:this.selector,function:"unifySourceFormat()",
message:"Missing LZString Library or group.cache, no compression will occur on group: "+a}),m.print()),b.compression=!1)}this.hasDynamicGroups=this.options.dynamic||!!this.dynamicGroups.length;return!0},init:function(){this.helper.executeCallback.call(this,this.options.callback.onInit,[this.node]);this.container=this.node.closest("."+this.options.selector.container);this.options.debug&&(m.log({node:this.selector,function:"init()",message:"OK - Typeahead activated on "+this.selector}),m.print())},
delegateEvents:function(){var a=this,h=["focus"+this.namespace,"input"+this.namespace,"propertychange"+this.namespace,"keydown"+this.namespace,"keyup"+this.namespace,"search"+this.namespace,"generate"+this.namespace];b("html").on("touchmove",function(){a.hasDragged=!0}).on("touchstart",function(){a.hasDragged=!1});this.node.closest("form").on("submit",function(b){if(a.options.mustSelectItem&&a.helper.isEmpty(a.item))b.preventDefault();else if(a.options.backdropOnFocus||a.hideLayout(),a.options.callback.onSubmit)return a.helper.executeCallback.call(a,
a.options.callback.onSubmit,[a.node,this,a.item||a.items,b])}).on("reset",function(){setTimeout(function(){a.node.trigger("input"+a.namespace);a.hideLayout()})});var n=!1;if(this.node.attr("placeholder")&&(e||f)){var g=!0;this.node.on("focusin focusout",function(){g=!(this.value||!this.placeholder)});this.node.on("input",function(a){g&&(a.stopImmediatePropagation(),g=!1)})}this.node.off(this.namespace).on(h.join(" "),function(d,e){switch(d.type){case "generate":a.generateSource(Object.keys(a.options.source));
break;case "focus":if(a.focusOnly){a.focusOnly=!1;break}a.options.backdropOnFocus&&(a.buildBackdropLayout(),a.showLayout());a.options.searchOnFocus&&!a.item&&(a.deferred=b.Deferred(),a.assignQuery(),a.generateSource());break;case "keydown":8===d.keyCode&&a.options.multiselect&&a.options.multiselect.cancelOnBackspace&&""===a.query&&a.items.length?a.cancelMultiselectItem(a.items.length-1,null,d):d.keyCode&&~[9,13,27,38,39,40].indexOf(d.keyCode)&&(n=!0,a.navigate(d));break;case "keyup":c&&a.node[0].value.replace(/^\s+/,
"").toString().length<a.query.length&&a.node.trigger("input"+a.namespace);break;case "propertychange":if(n){n=!1;break}case "input":a.deferred=b.Deferred();a.assignQuery();""===a.rawQuery&&""===a.query&&(d.originalEvent=e||{},a.helper.executeCallback.call(a,a.options.callback.onCancel,[a.node,d]));a.options.cancelButton&&a.toggleCancelButtonVisibility();a.options.hint&&a.hint.container&&""!==a.hint.container.val()&&0!==a.hint.container.val().indexOf(a.rawQuery)&&(a.hint.container.val(""),a.isContentEditable&&
a.hint.container.text(""));a.hasDynamicGroups?a.helper.typeWatch(function(){a.generateSource()},a.options.delay):a.generateSource();break;case "search":a.searchResult(),a.buildLayout(),a.result.length||a.searchGroups.length&&a.options.emptyTemplate&&a.query.length?a.showLayout():a.hideLayout(),a.deferred&&a.deferred.resolve()}return a.deferred&&a.deferred.promise()});this.options.generateOnLoad&&this.node.trigger("generate"+this.namespace)},assignQuery:function(){this.rawQuery=this.isContentEditable?
this.node.text():this.node.val().toString();this.rawQuery=this.rawQuery.replace(/^\s+/,"");this.rawQuery!==this.query&&(this.item=null,this.query=this.rawQuery)},filterGenerateSource:function(){this.searchGroups=[];this.generateGroups=[];if(!this.focusOnly||this.options.multiselect)for(var a in this.options.source)this.options.source.hasOwnProperty(a)&&this.query.length>=this.options.source[a].minLength&&this.query.length<=this.options.source[a].maxLength&&(this.searchGroups.push(a),!this.options.source[a].dynamic&&
this.source[a]||this.generateGroups.push(a))},generateSource:function(a){this.filterGenerateSource();if(Array.isArray(a)&&a.length)this.generateGroups=a;else if(!this.generateGroups.length){this.node.trigger("search"+this.namespace);return}this.requestGroups=[];this.generatedGroupCount=0;this.options.loadingAnimation&&this.container.addClass("loading");if(!this.helper.isEmpty(this.xhr)){for(var d in this.xhr)this.xhr.hasOwnProperty(d)&&this.xhr[d].abort();this.xhr={}}var e=this,c;d=0;for(var f=this.generateGroups.length;d<
f;++d){a=this.generateGroups[d];var g=this.options.source[a];var k=g.cache;var l=g.compression;if(k&&(c=window[k].getItem("TYPEAHEAD_"+this.selector+":"+a))){l&&(c=LZString.decompressFromUTF16(c));l=!1;try{c=JSON.parse(c+""),c.data&&c.ttl>(new Date).getTime()?(this.populateSource(c.data,a),l=!0,this.options.debug&&(m.log({node:this.selector,function:"generateSource()",message:'Source for group "'+a+'" found in '+k}),m.print())):window[k].removeItem("TYPEAHEAD_"+this.selector+":"+a)}catch(r){}if(l)continue}if(g.data&&
!g.ajax)if("function"===typeof g.data){var p=g.data.call(this);Array.isArray(p)?e.populateSource(p,a):"function"===typeof p.promise&&function(a){b.when(p).then(function(b){b&&Array.isArray(b)&&e.populateSource(b,a)})}(a)}else this.populateSource(b.extend(!0,[],g.data),a);else g.ajax&&(this.requests[a]||(this.requests[a]=this.generateRequestObject(a)),this.requestGroups.push(a))}this.requestGroups.length&&this.handleRequests();return!!this.generateGroups.length},generateRequestObject:function(a){var b=
this,d=this.options.source[a],e={request:{url:d.ajax.url||null,dataType:"json",beforeSend:function(e,c){b.xhr[a]=e;var h=b.requests[a].callback.beforeSend||d.ajax.beforeSend;"function"===typeof h&&h.apply(null,arguments)}},callback:{beforeSend:null,done:null,fail:null,then:null,always:null},extra:{path:d.ajax.path||null,group:a},validForGroup:[a]};if("function"!==typeof d.ajax&&(d.ajax instanceof Object&&(e=this.extendXhrObject(e,d.ajax)),1<Object.keys(this.options.source).length))for(var c in this.requests)this.requests.hasOwnProperty(c)&&
!this.requests[c].isDuplicated&&e.request.url&&e.request.url===this.requests[c].request.url&&(this.requests[c].validForGroup.push(a),e.isDuplicated=!0,delete e.validForGroup);return e},extendXhrObject:function(a,e){"object"===typeof e.callback&&(a.callback=e.callback,delete e.callback);"function"===typeof e.beforeSend&&(a.callback.beforeSend=e.beforeSend,delete e.beforeSend);a.request=b.extend(!0,a.request,e);"jsonp"!==a.request.dataType.toLowerCase()||a.request.jsonpCallback||(a.request.jsonpCallback=
"callback_"+a.extra.group);return a},handleRequests:function(){var a=this,e=this.requestGroups.length;if(!1!==this.helper.executeCallback.call(this,this.options.callback.onSendRequest,[this.node,this.query]))for(var c=0,f=this.requestGroups.length;c<f;++c){var g=this.requestGroups[c];this.requests[g].isDuplicated||function(d,c){if("function"===typeof a.options.source[d].ajax){var h=a.options.source[d].ajax.call(a,a.query);c=a.extendXhrObject(a.generateRequestObject(d),"object"===typeof h?h:{});if("object"!==
typeof c.request||!c.request.url){a.options.debug&&(m.log({node:a.selector,function:"handleRequests",message:'Source function must return an object containing ".url" key for group "'+d+'"'}),m.print());a.populateSource([],d);return}a.requests[d]=c}var f;d=!1;var n={};~c.request.url.indexOf("{{query}}")&&(d||(c=b.extend(!0,{},c),d=!0),c.request.url=c.request.url.replace("{{query}}",encodeURIComponent(a.query)));if(c.request.data)for(var g in c.request.data)if(c.request.data.hasOwnProperty(g)&&~String(c.request.data[g]).indexOf("{{query}}")){d||
(c=b.extend(!0,{},c),d=!0);c.request.data[g]=c.request.data[g].replace("{{query}}",a.query);break}b.ajax(c.request).done(function(b,d,e){for(var h,g=0,k=c.validForGroup.length;g<k;g++)h=c.validForGroup[g],f=a.requests[h],f.callback.done instanceof Function&&(n[h]=f.callback.done.call(a,b,d,e),Array.isArray(n[h])&&"object"===typeof n[h]||!a.options.debug||(m.log({node:a.selector,function:"Ajax.callback.done()",message:"Invalid returned data has to be an Array"}),m.print()))}).fail(function(b,d,e){for(var h=
0,n=c.validForGroup.length;h<n;h++)f=a.requests[c.validForGroup[h]],f.callback.fail instanceof Function&&f.callback.fail.call(a,b,d,e);a.options.debug&&(m.log({node:a.selector,function:"Ajax.callback.fail()",arguments:JSON.stringify(c.request),message:d}),console.log(e),m.print())}).always(function(b,d,h){for(var g,k=0,t=c.validForGroup.length;k<t;k++){g=c.validForGroup[k];f=a.requests[g];f.callback.always instanceof Function&&f.callback.always.call(a,b,d,h);if("object"!==typeof h)break;a.populateSource(null!==
b&&"function"===typeof b.promise&&[]||n[g]||b,f.extra.group,f.extra.path||f.request.path);--e;0===e&&a.helper.executeCallback.call(a,a.options.callback.onReceiveRequest,[a.node,a.query])}}).then(function(b,d){for(var e=0,h=c.validForGroup.length;e<h;e++)f=a.requests[c.validForGroup[e]],f.callback.then instanceof Function&&f.callback.then.call(a,b,d)})}(g,this.requests[g])}},populateSource:function(a,e,c){var d=this,h=this.options.source[e],f=h.ajax&&h.data;c&&"string"===typeof c&&(a=this.helper.namespace.call(this,
c,a));"undefined"===typeof a&&this.options.debug&&(m.log({node:this.selector,function:"populateSource()",arguments:c,message:"Invalid data path."}),m.print());Array.isArray(a)||(this.options.debug&&(m.log({node:this.selector,function:"populateSource()",arguments:JSON.stringify({group:e}),message:"Invalid data type, must be Array type."}),m.print()),a=[]);f&&("function"===typeof f&&(f=f()),Array.isArray(f)?a=a.concat(f):this.options.debug&&(m.log({node:this.selector,function:"populateSource()",arguments:JSON.stringify(f),
message:"WARNING - this.options.source."+e+".data Must be an Array or a function that returns an Array."}),m.print()));var g=h.display?"compiled"===h.display[0]?h.display[1]:h.display[0]:"compiled"===this.options.display[0]?this.options.display[1]:this.options.display[0],n=0;for(f=a.length;n<f;n++)if(null===a[n]||"boolean"===typeof a[n])this.options.debug&&(m.log({node:this.selector,function:"populateSource()",message:"WARNING - NULL/BOOLEAN value inside "+e+"! The data was skipped."}),m.print());
else{if("string"===typeof a[n]){var k={};k[g]=a[n];a[n]=k}a[n].group=e}if(!this.hasDynamicGroups&&this.dropdownFilter.dynamic.length){var l={};n=0;for(f=a.length;n<f;n++)for(var q=0,x=this.dropdownFilter.dynamic.length;q<x;q++)if(k=this.dropdownFilter.dynamic[q].key,g=a[n][k])this.dropdownFilter.dynamic[q].value||(this.dropdownFilter.dynamic[q].value=[]),l[k]||(l[k]=[]),~l[k].indexOf(g.toLowerCase())||(l[k].push(g.toLowerCase()),this.dropdownFilter.dynamic[q].value.push(g))}if(this.options.correlativeTemplate)if(f=
h.template||this.options.template,k="","function"===typeof f&&(f=f.call(this,"",{})),f){if(Array.isArray(this.options.correlativeTemplate))for(n=0,f=this.options.correlativeTemplate.length;n<f;n++)k+="{{"+this.options.correlativeTemplate[n]+"}} ";else k=f.replace(/<.+?>/g," ").replace(/\s{2,}/," ").trim();n=0;for(f=a.length;n<f;n++)a[n].compiled=b("<textarea />").html(k.replace(/\{\{([\w\-\.]+)(?:\|(\w+))?}}/g,function(b,e){return d.helper.namespace.call(d,e,a[n],"get","")}).trim()).text();h.display?
~h.display.indexOf("compiled")||h.display.unshift("compiled"):~this.options.display.indexOf("compiled")||this.options.display.unshift("compiled")}else this.options.debug&&(m.log({node:this.selector,function:"populateSource()",arguments:String(e),message:"WARNING - this.options.correlativeTemplate is enabled but no template was found."}),m.print());this.options.callback.onPopulateSource&&(a=this.helper.executeCallback.call(this,this.options.callback.onPopulateSource,[this.node,a,e,c]),!this.options.debug||
a&&Array.isArray(a)||(m.log({node:this.selector,function:"callback.populateSource()",message:'callback.onPopulateSource must return the "data" parameter'}),m.print()));this.tmpSource[e]=Array.isArray(a)&&a||[];h=this.options.source[e].cache;f=this.options.source[e].compression;k=this.options.source[e].ttl||this.options.ttl;h&&!window[h].getItem("TYPEAHEAD_"+this.selector+":"+e)&&(this.options.callback.onCacheSave&&(a=this.helper.executeCallback.call(this,this.options.callback.onCacheSave,[this.node,
a,e,c]),!this.options.debug||a&&Array.isArray(a)||(m.log({node:this.selector,function:"callback.populateSource()",message:'callback.onCacheSave must return the "data" parameter'}),m.print())),c=JSON.stringify({data:a,ttl:(new Date).getTime()+k}),f&&(c=LZString.compressToUTF16(c)),window[h].setItem("TYPEAHEAD_"+this.selector+":"+e,c));this.incrementGeneratedGroup()},incrementGeneratedGroup:function(){this.generatedGroupCount++;if(this.generatedGroupCount===this.generateGroups.length){this.xhr={};for(var a=
0,b=this.generateGroups.length;a<b;a++)this.source[this.generateGroups[a]]=this.tmpSource[this.generateGroups[a]];this.hasDynamicGroups||this.buildDropdownItemLayout("dynamic");this.options.loadingAnimation&&this.container.removeClass("loading");this.node.trigger("search"+this.namespace)}},navigate:function(a){this.helper.executeCallback.call(this,this.options.callback.onNavigateBefore,[this.node,this.query,a]);if(27===a.keyCode)a.preventDefault(),this.query.length?(this.resetInput(),this.node.trigger("input"+
this.namespace,[a])):(this.node.blur(),this.hideLayout());else if(this.result.length){var b=this.resultContainer.find("."+this.options.selector.item).not("[disabled]"),d=b.filter(".active"),e=d[0]?b.index(d):null,c=d[0]?d.attr("data-index"):null,f=null;this.clearActiveItem();this.helper.executeCallback.call(this,this.options.callback.onLeave,[this.node,null!==e&&b.eq(e)||void 0,null!==c&&this.result[c]||void 0,a]);13===a.keyCode?(a.preventDefault(),0<d.length?"javascript:;"===d.find("a:first")[0].href?
d.find("a:first").trigger("click",a):d.find("a:first")[0].click():this.node.closest("form").trigger("submit")):39===a.keyCode?null!==e?b.eq(e).find("a:first")[0].click():this.options.hint&&""!==this.hint.container.val()&&this.helper.getCaret(this.node[0])>=this.query.length&&b.filter('[data-index="'+this.hintIndex+'"]').find("a:first")[0].click():(9===a.keyCode?this.options.blurOnTab?this.hideLayout():0<d.length?e+1<b.length?(a.preventDefault(),f=e+1,this.addActiveItem(b.eq(f))):this.hideLayout():
b.length?(a.preventDefault(),f=0,this.addActiveItem(b.first())):this.hideLayout():38===a.keyCode?(a.preventDefault(),0<d.length?0<=e-1&&(f=e-1,this.addActiveItem(b.eq(f))):b.length&&(f=b.length-1,this.addActiveItem(b.last()))):40===a.keyCode&&(a.preventDefault(),0<d.length?e+1<b.length&&(f=e+1,this.addActiveItem(b.eq(f))):b.length&&(f=0,this.addActiveItem(b.first()))),d=null!==f?b.eq(f).attr("data-index"):null,this.helper.executeCallback.call(this,this.options.callback.onEnter,[this.node,null!==f&&
b.eq(f)||void 0,null!==d&&this.result[d]||void 0,a]),a.preventInputChange&&~[38,40].indexOf(a.keyCode)&&this.buildHintLayout(null!==d&&d<this.result.length?[this.result[d]]:null),this.options.hint&&this.hint.container&&this.hint.container.css("color",a.preventInputChange?this.hint.css.color:null===d&&this.hint.css.color||this.hint.container.css("background-color")||"fff"),e=null===d||a.preventInputChange?this.rawQuery:this.getTemplateValue.call(this,this.result[d]),this.node.val(e),this.isContentEditable&&
this.node.text(e),this.helper.executeCallback.call(this,this.options.callback.onNavigateAfter,[this.node,b,null!==f&&b.eq(f).find("a:first")||void 0,null!==d&&this.result[d]||void 0,this.query,a]))}},getTemplateValue:function(a){if(a){var b=a.group&&this.options.source[a.group].templateValue||this.options.templateValue;"function"===typeof b&&(b=b.call(this));if(!b)return this.helper.namespace.call(this,a.matchedKey,a).toString();var d=this;return b.replace(/\{\{([\w\-.]+)}}/gi,function(b,e){return d.helper.namespace.call(d,
e,a,"get","")})}},clearActiveItem:function(){this.resultContainer.find("."+this.options.selector.item).removeClass("active")},addActiveItem:function(a){a.addClass("active")},searchResult:function(){this.resetLayout();!1!==this.helper.executeCallback.call(this,this.options.callback.onSearch,[this.node,this.query])&&(!this.searchGroups.length||this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit||this.searchResultData(),this.helper.executeCallback.call(this,
this.options.callback.onResult,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]),this.isDropdownEvent&&(this.helper.executeCallback.call(this,this.options.callback.onDropdownFilter,[this.node,this.query,this.filters.dropdown,this.result]),this.isDropdownEvent=!1))},searchResultData:function(){var a=this.groupBy,e=null,c=this.query.toLowerCase(),f=this.options.maxItem,g=this.options.maxItemPerGroup,k=this.filters.dynamic&&!this.helper.isEmpty(this.filters.dynamic),l={},
B="function"===typeof this.options.matcher&&this.options.matcher;this.options.accent&&(c=this.helper.removeAccent.call(this,c));for(var p=0,r=this.searchGroups.length;p<r;++p){var q=this.searchGroups[p];if(!this.filters.dropdown||"group"!==this.filters.dropdown.key||this.filters.dropdown.value===q){var x="undefined"!==typeof this.options.source[q].filter?this.options.source[q].filter:this.options.filter;var E="function"===typeof this.options.source[q].matcher&&this.options.source[q].matcher||B;for(var C=
0,F=this.source[q].length;C<F&&(!(this.resultItemCount>=f)||this.options.callback.onResult);C++)if(!k||this.dynamicFilter.validate.apply(this,[this.source[q][C]])){var y=this.source[q][C];if(!(null===y||"boolean"===typeof y||this.options.multiselect&&!this.isMultiselectUniqueData(y)||this.filters.dropdown&&(y[this.filters.dropdown.key]||"").toLowerCase()!==(this.filters.dropdown.value||"").toLowerCase())){(e="group"===a?q:y[a]?y[a]:y.group)&&!this.tmpResult[e]&&(this.tmpResult[e]=[],this.resultCountPerGroup[e]=
0);if(g&&"group"===a&&this.tmpResult[e].length>=g&&!this.options.callback.onResult)break;var u=this.options.source[q].display||this.options.display;for(var A=0,K=u.length;A<K;++A){if(!1!==x){var H=/\./.test(u[A])?this.helper.namespace.call(this,u[A],y):y[u[A]];if("undefined"===typeof H||""===H){this.options.debug&&(l[A]={display:u[A],data:y});continue}H=this.helper.cleanStringFromScript(H)}if("function"===typeof x){var z=x.call(this,y,H);if(void 0===z)break;if(!z)continue;"object"===typeof z&&(y=
z)}if(~[void 0,!0].indexOf(x)){var G=H;G=G.toString().toLowerCase();this.options.accent&&(G=this.helper.removeAccent.call(this,G));z=G.indexOf(c);if(this.options.correlativeTemplate&&"compiled"===u[A]&&0>z&&/\s/.test(c)){var L=!0;var J=c.split(" ");for(var I=0,M=J.length;I<M;I++)if(""!==J[I]){if(!~G.indexOf(J[I])){L=!1;break}G=G.replace(J[I],"")}}if(0>z&&!L)continue;if(this.options.offset&&0!==z)continue;if(E){z=E.call(this,y,H);if(void 0===z)break;if(!z)continue;"object"===typeof z&&(y=z)}}this.resultCount++;
this.resultCountPerGroup[e]++;if(this.resultItemCount<f){if(g&&this.tmpResult[e].length>=g)break;this.tmpResult[e].push(b.extend(!0,{matchedKey:u[A]},y));this.resultItemCount++}break}if(!this.options.callback.onResult){if(this.resultItemCount>=f)break;if(g&&this.tmpResult[e].length>=g&&"group"===a)break}}}}}this.options.debug&&!this.helper.isEmpty(l)&&(m.log({node:this.selector,function:"searchResult()",arguments:JSON.stringify(l),message:"Missing keys for display, make sure options.display is set properly."}),
m.print());if(this.options.order)for(q in u=[],this.tmpResult)if(this.tmpResult.hasOwnProperty(q)){p=0;for(r=this.tmpResult[q].length;p<r;p++)a=this.options.source[this.tmpResult[q][p].group].display||this.options.display,~u.indexOf(a[0])||u.push(a[0]);this.tmpResult[q].sort(this.helper.sort(u,"asc"===this.options.order,function(a){return a.toString().toUpperCase()}))}q=[];u=[];u="function"===typeof this.options.groupOrder?this.options.groupOrder.apply(this,[this.node,this.query,this.tmpResult,this.resultCount,
this.resultCountPerGroup]):Array.isArray(this.options.groupOrder)?this.options.groupOrder:"string"===typeof this.options.groupOrder&&~["asc","desc"].indexOf(this.options.groupOrder)?Object.keys(this.tmpResult).sort(this.helper.sort([],"asc"===this.options.groupOrder,function(a){return a.toString().toUpperCase()})):Object.keys(this.tmpResult);p=0;for(r=u.length;p<r;p++)q=q.concat(this.tmpResult[u[p]]||[]);this.groups=JSON.parse(JSON.stringify(u));this.result=q},buildLayout:function(){this.buildHtmlLayout();
this.buildBackdropLayout();this.buildHintLayout();this.options.callback.onLayoutBuiltBefore&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltBefore,[this.node,this.query,this.result,this.resultHtml]);this.resultHtml instanceof b&&this.resultContainer.html(this.resultHtml);this.options.callback.onLayoutBuiltAfter&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltAfter,[this.node,this.query,this.result])},buildHtmlLayout:function(){if(!1!==this.options.resultContainer){this.resultContainer||
(this.resultContainer=b("<div/>",{class:this.options.selector.result}),this.container.append(this.resultContainer));if(!this.result.length)if(this.options.multiselect&&this.options.multiselect.limit&&this.items.length>=this.options.multiselect.limit)var a=this.options.multiselect.limitTemplate?"function"===typeof this.options.multiselect.limitTemplate?this.options.multiselect.limitTemplate.call(this,this.query):this.options.multiselect.limitTemplate.replace(/\{\{query}}/gi,b("<div>").text(this.helper.cleanStringFromScript(this.query)).html()):
"Can't select more than "+this.items.length+" items.";else if(this.options.emptyTemplate&&""!==this.query)a="function"===typeof this.options.emptyTemplate?this.options.emptyTemplate.call(this,this.query):this.options.emptyTemplate.replace(/\{\{query}}/gi,b("<div>").text(this.helper.cleanStringFromScript(this.query)).html());else return;var e=this.query.toLowerCase();this.options.accent&&(e=this.helper.removeAccent.call(this,e));var c=this,f=this.groupTemplate||"<ul></ul>",g=!1;this.groupTemplate?
f=b(f.replace(/<([^>]+)>\{\{(.+?)}}<\/[^>]+>/g,function(b,d,e,h,f){b="";e="group"===e?c.groups:[e];if(!c.result.length){if(!0===g)return"";g=!0;return"<"+d+' class="'+c.options.selector.empty+'">'+a+"</"+d+">"}h=0;for(f=e.length;h<f;++h)b+="<"+d+' data-group-template="'+e[h]+'"><ul></ul></'+d+">";return b})):(f=b(f),this.result.length||f.append(a instanceof b?a:'<li class="'+c.options.selector.empty+'">'+a+"</li>"));f.addClass(this.options.selector.list+(this.helper.isEmpty(this.result)?" empty":
""));for(var k,l,m,p,r,q,x,E,C,F=this.groupTemplate&&this.result.length&&c.groups||[],y,u=0,A=this.result.length;u<A;++u)m=this.result[u],k=m.group,p=!this.options.multiselect&&this.options.source[m.group].href||this.options.href,x=[],E=this.options.source[m.group].display||this.options.display,this.options.group&&(k=m[this.options.group.key],this.options.group.template&&("function"===typeof this.options.group.template?l=this.options.group.template.call(this,m):"string"===typeof this.options.group.template&&
(l=this.options.group.template.replace(/\{\{([\w\-\.]+)}}/gi,function(a,b){return c.helper.namespace.call(c,b,m,"get","")}))),f.find('[data-search-group="'+k+'"]')[0]||(this.groupTemplate?f.find('[data-group-template="'+k+'"] ul'):f).append(b("<li/>",{class:c.options.selector.group,html:b("<a/>",{href:"javascript:;",html:l||k,tabindex:-1}),"data-search-group":k}))),this.groupTemplate&&F.length&&(y=F.indexOf(k||m.group),~y&&F.splice(y,1)),p=b("<li/>",{class:c.options.selector.item+" "+c.options.selector.group+
"-"+this.helper.slugify.call(this,k),disabled:m.disabled?!0:!1,"data-group":k,"data-index":u,html:b("<a/>",{href:p&&!m.disabled?m.href=c.generateHref.call(c,p,m):"javascript:;",html:function(){if(r=m.group&&c.options.source[m.group].template||c.options.template)"function"===typeof r&&(r=r.call(c,c.query,m)),q=r.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(a,b,d){a=c.helper.cleanStringFromScript(String(c.helper.namespace.call(c,b,m,"get","")));d=d&&d.split("|")||[];~d.indexOf("slugify")&&(a=
c.helper.slugify.call(c,a));~d.indexOf("raw")||!0===c.options.highlight&&e&&~E.indexOf(b)&&(a=c.helper.highlight.call(c,a,e.split(" "),c.options.accent));return a});else{for(var a=0,d=E.length;a<d;a++)C=/\./.test(E[a])?c.helper.namespace.call(c,E[a],m,"get",""):m[E[a]],"undefined"!==typeof C&&""!==C&&x.push(C);q='<span class="'+c.options.selector.display+'">'+c.helper.cleanStringFromScript(String(x.join(" ")))+"</span>"}if(!0===c.options.highlight&&e&&!r||"any"===c.options.highlight)q=c.helper.highlight.call(c,
q,e.split(" "),c.options.accent);b(this).append(q)}})}),function(a,d,e){e.on("click",function(a,e){d.disabled?a.preventDefault():(e&&"object"===typeof e&&(a.originalEvent=e),c.options.mustSelectItem&&c.helper.isEmpty(d)?a.preventDefault():(c.options.multiselect?(c.items.push(d),c.comparedItems.push(c.getMultiselectComparedData(d))):c.item=d,!1===c.helper.executeCallback.call(c,c.options.callback.onClickBefore,[c.node,b(this),d,a])||a.originalEvent&&a.originalEvent.defaultPrevented||a.isDefaultPrevented()||
(e=c.getTemplateValue.call(c,d),c.options.multiselect?(c.query=c.rawQuery="",c.addMultiselectItemLayout(e)):(c.focusOnly=!0,c.query=c.rawQuery=e,c.isContentEditable&&(c.node.text(c.query),c.helper.setCaretAtEnd(c.node[0]))),c.hideLayout(),c.node.val(c.query).focus(),c.helper.executeCallback.call(c,c.options.callback.onClickAfter,[c.node,b(this),d,a]))))});e.on("mouseenter",function(a){d.disabled||(c.clearActiveItem(),c.addActiveItem(b(this)));c.helper.executeCallback.call(c,c.options.callback.onEnter,
[c.node,b(this),d,a])});e.on("mouseleave",function(a){d.disabled||c.clearActiveItem();c.helper.executeCallback.call(c,c.options.callback.onLeave,[c.node,b(this),d,a])})}(u,m,p),(this.groupTemplate?f.find('[data-group-template="'+k+'"] ul'):f).append(p);if(this.result.length&&F.length)for(u=0,A=F.length;u<A;++u)f.find('[data-group-template="'+F[u]+'"]').remove();this.resultHtml=f}},generateHref:function(a,b){var d=this;"string"===typeof a?a=a.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(a,c,
e){a=d.helper.namespace.call(d,c,b,"get","");e=e&&e.split("|")||[];~e.indexOf("slugify")&&(a=d.helper.slugify.call(d,a));return a}):"function"===typeof a&&(a=a.call(this,b));return a},getMultiselectComparedData:function(a){var b="";if(Array.isArray(this.options.multiselect.matchOn))for(var d=0,c=this.options.multiselect.matchOn.length;d<c;++d)b+="undefined"!==typeof a[this.options.multiselect.matchOn[d]]?a[this.options.multiselect.matchOn[d]]:"";else{a=JSON.parse(JSON.stringify(a));b=["group","matchedKey",
"compiled","href"];d=0;for(c=b.length;d<c;++d)delete a[b[d]];b=JSON.stringify(a)}return b},buildBackdropLayout:function(){this.options.backdrop&&(this.backdrop.container||(this.backdrop.css=b.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},this.options.backdrop),this.backdrop.container=b("<div/>",{class:this.options.selector.backdrop,css:this.backdrop.css}).insertAfter(this.container)),this.container.addClass("backdrop").css({"z-index":this.backdrop.css["z-index"]+
1,position:"relative"}))},buildHintLayout:function(a){if(this.options.hint)if(this.node[0].scrollWidth>Math.ceil(this.node.innerWidth()))this.hint.container&&this.hint.container.val("");else{var d=this,c="";a=a||this.result;var e=this.query.toLowerCase();this.options.accent&&(e=this.helper.removeAccent.call(this,e));this.hintIndex=null;if(this.searchGroups.length){this.hint.container||(this.hint.css=b.extend({"border-color":"transparent",position:"absolute",top:0,display:"inline","z-index":-1,float:"none",
color:"silver","box-shadow":"none",cursor:"default","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},this.options.hint),this.hint.container=b("<"+this.node[0].nodeName+"/>",{type:this.node.attr("type"),class:this.node.attr("class"),readonly:!0,unselectable:"on","aria-hidden":"true",tabindex:-1,click:function(){d.node.focus()}}).addClass(this.options.selector.hint).css(this.hint.css).insertAfter(this.node),this.node.parent().css({position:"relative"}));
this.hint.container.css("color",this.hint.css.color);if(e)for(var f,g,k=0,l=a.length;k<l;k++)if(!a[k].disabled){f=a[k].group;f=this.options.source[f].display||this.options.display;for(var m=0,r=f.length;m<r;m++)if(g=String(a[k][f[m]]).toLowerCase(),this.options.accent&&(g=this.helper.removeAccent.call(this,g)),0===g.indexOf(e)){c=String(a[k][f[m]]);this.hintIndex=k;break}if(null!==this.hintIndex)break}a=0<c.length&&this.rawQuery+c.substring(this.query.length)||"";this.hint.container.val(a);this.isContentEditable&&
this.hint.container.text(a)}}},buildDropdownLayout:function(){if(this.options.dropdownFilter){var a=this;b("<span/>",{class:this.options.selector.filter,html:function(){b(this).append(b("<button/>",{type:"button",class:a.options.selector.filterButton,style:"display: none;",click:function(){a.container.toggleClass("filter");var d=a.namespace+"-dropdown-filter";b("html").off(d);if(a.container.hasClass("filter"))b("html").on("click"+d+" touchend"+d,function(c){b(c.target).closest("."+a.options.selector.filter)[0]&&
b(c.target).closest(a.container)[0]||a.hasDragged||(a.container.removeClass("filter"),b("html").off(d))})}}));b(this).append(b("<ul/>",{class:a.options.selector.dropdown}))}}).insertAfter(a.container.find("."+a.options.selector.query))}},buildDropdownItemLayout:function(a){if(this.options.dropdownFilter){var d=this,c="string"===typeof this.options.dropdownFilter&&this.options.dropdownFilter||"All",e=this.container.find("."+this.options.selector.dropdown);"static"!==a||!0!==this.options.dropdownFilter&&
"string"!==typeof this.options.dropdownFilter||this.dropdownFilter.static.push({key:"group",template:"{{group}}",all:c,value:Object.keys(this.options.source)});for(var f=0,g=this.dropdownFilter[a].length;f<g;f++){var k=this.dropdownFilter[a][f];Array.isArray(k.value)||(k.value=[k.value]);k.all&&(this.dropdownFilterAll=k.all);for(var l=0,m=k.value.length;l<=m;l++)if(l!==m||f===g-1)if(l!==m||f!==g-1||"static"!==a||!this.dropdownFilter.dynamic.length){var r=this.dropdownFilterAll||c;k.value[l]?r=k.template?
k.template.replace(new RegExp("{{"+k.key+"}}","gi"),k.value[l]):k.value[l]:this.container.find("."+d.options.selector.filterButton).html(r);(function(a,f,h){e.append(b("<li/>",{class:d.options.selector.dropdownItem+" "+d.helper.slugify.call(d,f.key+"-"+(f.value[a]||c)),html:b("<a/>",{href:"javascript:;",html:h,click:function(b){b.preventDefault();b={key:f.key,value:f.value[a]||"*",template:h};"*"===b.value?delete d.filters.dropdown:d.filters.dropdown=b;d.container.removeClass("filter").find("."+d.options.selector.filterButton).html(b.template);
d.isDropdownEvent=!0;d.node.trigger("search"+d.namespace);d.options.multiselect&&d.adjustInputSize();d.node.focus()}})}))})(l,k,r)}}this.dropdownFilter[a].length&&this.container.find("."+d.options.selector.filterButton).removeAttr("style")}},dynamicFilter:{isEnabled:!1,init:function(){this.options.dynamicFilter&&(this.dynamicFilter.bind.call(this),this.dynamicFilter.isEnabled=!0)},validate:function(a){var b=null,d=null,c;for(c in this.filters.dynamic)if(this.filters.dynamic.hasOwnProperty(c)){var e=
~c.indexOf(".")?this.helper.namespace.call(this,c,a,"get"):a[c];"|"!==this.filters.dynamic[c].modifier||b||(b=e==this.filters.dynamic[c].value||!1);if("&"===this.filters.dynamic[c].modifier)if(e==this.filters.dynamic[c].value)d=!0;else{d=!1;break}}a=b;null!==d&&(a=d,!0===d&&null!==b&&(a=b));return!!a},set:function(a,b){a=a.match(/^([|&])?(.+)/);b?this.filters.dynamic[a[2]]={modifier:a[1]||"|",value:b}:delete this.filters.dynamic[a[2]];this.dynamicFilter.isEnabled&&this.generateSource()},bind:function(){for(var a=
this,c,e=0,f=this.options.dynamicFilter.length;e<f;e++)c=this.options.dynamicFilter[e],"string"===typeof c.selector&&(c.selector=b(c.selector)),c.selector instanceof b&&c.selector[0]&&c.key?function(b){b.selector.off(a.namespace).on("change"+a.namespace,function(){a.dynamicFilter.set.apply(a,[b.key,a.dynamicFilter.getValue(this)])}).trigger("change"+a.namespace)}(c):this.options.debug&&(m.log({node:this.selector,function:"buildDynamicLayout()",message:'Invalid jQuery selector or jQuery Object for "filter.selector" or missing filter.key'}),
m.print())},getValue:function(a){if("SELECT"===a.tagName)var b=a.value;else"INPUT"===a.tagName&&("checkbox"===a.type?b=a.checked&&a.getAttribute("value")||a.checked||null:"radio"===a.type&&a.checked&&(b=a.value));return b}},buildMultiselectLayout:function(){if(this.options.multiselect){var a=this;this.label.container=b("<span/>",{class:this.options.selector.labelContainer,"data-padding-left":parseFloat(this.node.css("padding-left"))||0,"data-padding-right":parseFloat(this.node.css("padding-right"))||
0,"data-padding-top":parseFloat(this.node.css("padding-top"))||0,click:function(d){b(d.target).hasClass(a.options.selector.labelContainer)&&a.node.focus()}});this.node.closest("."+this.options.selector.query).prepend(this.label.container);if(this.options.multiselect.data)if(Array.isArray(this.options.multiselect.data))this.populateMultiselectData(this.options.multiselect.data);else if("function"===typeof this.options.multiselect.data){var c=this.options.multiselect.data.call(this);Array.isArray(c)?
this.populateMultiselectData(c):"function"===typeof c.promise&&b.when(c).then(function(b){b&&Array.isArray(b)&&a.populateMultiselectData(b)})}}},isMultiselectUniqueData:function(a){for(var b=!0,d=0,c=this.comparedItems.length;d<c;++d)if(this.comparedItems[d]===this.getMultiselectComparedData(a)){b=!1;break}return b},populateMultiselectData:function(a){for(var b=0,d=a.length;b<d;++b)this.isMultiselectUniqueData(a[b])&&(this.items.push(a[b]),this.comparedItems.push(this.getMultiselectComparedData(a[b])),
this.addMultiselectItemLayout(this.getTemplateValue(a[b])));this.node.trigger("search"+this.namespace,{origin:"populateMultiselectData"})},addMultiselectItemLayout:function(a){var d=this;a=b("<span/>",{class:this.options.selector.label,html:b("<"+(this.options.multiselect.href?"a":"span")+"/>",{text:a,click:function(a){var c=b(this).closest("."+d.options.selector.label);c=d.label.container.find("."+d.options.selector.label).index(c);d.options.multiselect.callback&&d.helper.executeCallback.call(d,
d.options.multiselect.callback.onClick,[d.node,d.items[c],a])},href:this.options.multiselect.href?d.generateHref.call(d,d.options.multiselect.href,d.items[d.items.length-1]):null})});a.append(b("<span/>",{class:this.options.selector.cancelButton,html:"\u00d7",click:function(a){var c=b(this).closest("."+d.options.selector.label),e=d.label.container.find("."+d.options.selector.label).index(c);d.cancelMultiselectItem(e,c,a)}}));this.label.container.append(a);this.adjustInputSize()},cancelMultiselectItem:function(a,
b,c){var d=this.items[a];b=b||this.label.container.find("."+this.options.selector.label).eq(a);b.remove();this.items.splice(a,1);this.comparedItems.splice(a,1);this.options.multiselect.callback&&this.helper.executeCallback.call(this,this.options.multiselect.callback.onCancel,[this.node,d,c]);this.adjustInputSize();this.focusOnly=!0;this.node.focus().trigger("input"+this.namespace,{origin:"cancelMultiselectItem"})},adjustInputSize:function(){var a=this.node[0].getBoundingClientRect().width-(parseFloat(this.label.container.data("padding-right"))||
0)-(parseFloat(this.label.container.css("padding-left"))||0),c=0,e=0,f=0,g=!1,k=0;this.label.container.find("."+this.options.selector.label).filter(function(d,h){0===d&&(k=b(h)[0].getBoundingClientRect().height+parseFloat(b(h).css("margin-bottom")||0));c=b(h)[0].getBoundingClientRect().width+parseFloat(b(h).css("margin-right")||0);f+c>.7*a&&!g&&(e++,g=!0);f+c<a?f+=c:(g=!1,f=c)});var l=parseFloat(this.label.container.data("padding-left")||0)+(g?0:f),m=e*k+parseFloat(this.label.container.data("padding-top")||
0);this.container.find("."+this.options.selector.query).find("input, textarea, [contenteditable], .typeahead__hint").css({paddingLeft:l,paddingTop:m})},showLayout:function(){!this.container.hasClass("result")&&(this.result.length||this.options.emptyTemplate||this.options.backdropOnFocus)&&(function(){var a=this;b("html").off("keydown"+this.namespace).on("keydown"+this.namespace,function(d){d.keyCode&&9===d.keyCode&&setTimeout(function(){b(":focus").closest(a.container).find(a.node)[0]||a.hideLayout()},
0)});b("html").off("click"+this.namespace+" touchend"+this.namespace).on("click"+this.namespace+" touchend"+this.namespace,function(d){b(d.target).closest(a.container)[0]||b(d.target).closest("."+a.options.selector.item)[0]||d.target.className===a.options.selector.cancelButton||a.hasDragged||a.hideLayout()})}.call(this),this.container.addClass([this.result.length||this.searchGroups.length&&this.options.emptyTemplate&&this.query.length?"result ":"",this.options.hint&&this.searchGroups.length?"hint":
"",this.options.backdrop||this.options.backdropOnFocus?"backdrop":""].join(" ")),this.helper.executeCallback.call(this,this.options.callback.onShowLayout,[this.node,this.query]))},hideLayout:function(){if(this.container.hasClass("result")||this.container.hasClass("backdrop"))this.container.removeClass("result hint filter"+(this.options.backdropOnFocus&&b(this.node).is(":focus")?"":" backdrop")),this.options.backdropOnFocus&&this.container.hasClass("backdrop")||(b("html").off(this.namespace),this.helper.executeCallback.call(this,
this.options.callback.onHideLayout,[this.node,this.query]))},resetLayout:function(){this.result=[];this.tmpResult={};this.groups=[];this.resultCount=0;this.resultCountPerGroup={};this.resultItemCount=0;this.resultHtml=null;this.options.hint&&this.hint.container&&(this.hint.container.val(""),this.isContentEditable&&this.hint.container.text(""))},resetInput:function(){this.node.val("");this.isContentEditable&&this.node.text("");this.item=null;this.rawQuery=this.query=""},buildCancelButtonLayout:function(){if(this.options.cancelButton){var a=
this;b("<span/>",{class:this.options.selector.cancelButton,html:"\u00d7",mousedown:function(b){b.stopImmediatePropagation();b.preventDefault();a.resetInput();a.node.trigger("input"+a.namespace,[b])}}).insertBefore(this.node)}},toggleCancelButtonVisibility:function(){this.container.toggleClass("cancel",!!this.query.length)},__construct:function(){this.extendOptions();this.unifySourceFormat()&&(this.dynamicFilter.init.apply(this),this.init(),this.buildDropdownLayout(),this.buildDropdownItemLayout("static"),
this.buildMultiselectLayout(),this.delegateEvents(),this.buildCancelButtonLayout(),this.helper.executeCallback.call(this,this.options.callback.onReady,[this.node]))},helper:{isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},removeAccent:function(b){if("string"===typeof b){var d=a;"object"===typeof this.options.accent&&(d=this.options.accent);return b=b.toLowerCase().replace(new RegExp("["+d.from+"]","g"),function(a){return d.to[d.from.indexOf(a)]})}},slugify:function(a){a=
String(a);""!==a&&(a=this.helper.removeAccent.call(this,a),a=a.replace(/[^-a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""));return a},sort:function(a,b,c){var d=function(b){for(var d=0,e=a.length;d<e;d++)if("undefined"!==typeof b[a[d]])return c(b[a[d]]);return b};b=[-1,1][+!!b];return function(a,c){return a=d(a),c=d(c),b*((a>c)-(c>a))}},replaceAt:function(a,b,c,e){return a.substring(0,b)+e+a.substring(b+c)},highlight:function(a,b,c){a=String(a);c=c&&this.helper.removeAccent.call(this,a)||
a;var d=[];Array.isArray(b)||(b=[b]);b.sort(function(a,b){return b.length-a.length});for(var e=b.length-1;0<=e;e--)""===b[e].trim()?b.splice(e,1):b[e]=b[e].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c.replace(new RegExp("(?:"+b.join("|")+")(?!([^<]+)?>)","gi"),function(a,b,c){d.push({offset:c,length:a.length})});for(e=d.length-1;0<=e;e--)a=this.helper.replaceAt(a,d[e].offset,d[e].length,"<strong>"+a.substr(d[e].offset,d[e].length)+"</strong>");return a},getCaret:function(a){var b=0;if(a.selectionStart)return a.selectionStart;
if(document.selection){var d=document.selection.createRange();if(null===d)return b;a=a.createTextRange();b=a.duplicate();a.moveToBookmark(d.getBookmark());b.setEndPoint("EndToStart",a);b=b.text.length}else window.getSelection&&(d=window.getSelection(),d.rangeCount&&(d=d.getRangeAt(0),d.commonAncestorContainer.parentNode==a&&(b=d.endOffset)));return b},setCaretAtEnd:function(a){if("undefined"!==typeof window.getSelection&&"undefined"!==typeof document.createRange){var b=document.createRange();b.selectNodeContents(a);
b.collapse(!1);a=window.getSelection();a.removeAllRanges();a.addRange(b)}else"undefined"!==typeof document.body.createTextRange&&(b=document.body.createTextRange(),b.moveToElementText(a),b.collapse(!1),b.select())},cleanStringFromScript:function(a){return"string"===typeof a&&a.replace(/<\/?(?:script|iframe)\b[^>]*>/gm,"")||a},executeCallback:function(a,b){if(a){if("function"===typeof a)var d=a;else if("string"===typeof a||Array.isArray(a))if("string"===typeof a&&(a=[a,[]]),d=this.helper.namespace.call(this,
a[0],window),"function"!==typeof d){this.options.debug&&(m.log({node:this.selector,function:"executeCallback()",arguments:JSON.stringify(a),message:'WARNING - Invalid callback function"'}),m.print());return}return d.apply(this,(a[1]||[]).concat(b?b:[]))}},namespace:function(a,b,c,e){if("string"!==typeof a||""===a)return this.options.debug&&(m.log({node:this.options.input||this.selector,function:"helper.namespace()",arguments:a,message:'ERROR - Missing string"'}),m.print()),!1;var d="undefined"!==
typeof e?e:void 0;if(!~a.indexOf("."))return b[a]||d;a=a.split(".");b=b||window;c=c||"get";for(var f,g=0,h=a.length;g<h;g++){f=a[g];if("undefined"===typeof b[f]){if(~["get","delete"].indexOf(c))return"undefined"!==typeof e?e:void 0;b[f]={}}if(~["set","create","delete"].indexOf(c)&&g===h-1)if("set"===c||"create"===c)b[f]=d;else return delete b[f],!0;b=b[f]}return b},typeWatch:function(){var a=0;return function(b,d){clearTimeout(a);a=setTimeout(b,d)}}()}};b.fn.typeahead=b.typeahead=function(a){return l.typeahead(this,
a)};var l={typeahead:function(a,c){if(c&&c.source&&"object"===typeof c.source){if("function"===typeof a){if(!c.input){m.log({node:a.selector,function:"$.typeahead()",message:'Undefined "options.input" - Typeahead dropped'});m.print();return}a=b(c.input)}"undefined"===typeof a[0].value&&(a[0].value=a.text());if(a.length){if(1===a.length)return a[0].selector=a.selector||c.input||a[0].nodeName.toLowerCase(),window.Typeahead[a[0].selector]=new k(a,c);for(var d={},e,f=0,g=a.length;f<g;++f)e=a[f].nodeName.toLowerCase(),
"undefined"!==typeof d[e]&&(e+=f),a[f].selector=e,window.Typeahead[e]=d[e]=new k(a.eq(f),c);return d}m.log({node:a.selector,function:"$.typeahead()",arguments:JSON.stringify(c.input),message:"Unable to find jQuery input element - Typeahead dropped"})}else m.log({node:a.selector||c&&c.input,function:"$.typeahead()",arguments:JSON.stringify(c&&c.source||""),message:'Undefined "options" or "options.source" or invalid source type - Typeahead dropped'});m.print()}},m={table:{},log:function(a){a.message&&
"string"===typeof a.message&&(this.table[a.message]=b.extend({node:"",function:"",arguments:""},a))},print:function(){if(!k.prototype.helper.isEmpty(this.table)&&console&&console.table){if(void 0!==console.group||void 0!==console.table)console.groupCollapsed("--- jQuery Typeahead Debug ---"),console.table(this.table),console.groupEnd();this.table={}}}};m.log({message:"WARNING - You are using the DEBUG version. Use /dist/jquery.typeahead.min.js in production."});m.print();window.console=window.console||
{log:function(){}};Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")});"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,b){void 0===b&&(b=0);0>b&&(b+=this.length);0>b&&(b=0);for(var c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1});Object.keys||(Object.keys=function(a){var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,
c)&&b.push(c);return b});return k});
