var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}},"es6","es3");$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return[a,c]})}},"es6","es3");
var fimApi=function(){this.requestDefaults={close:!1,timerId:1,refresh:-1,timeout:5E3,cache:!1,begin:function(){},error:function(){},exception:function(){},each:function(){},reverseEach:!1,end:function(){},async:!0,action:null,autoId:!1};this.timers={};this.done=function(a,b){return function(c){var d=c[b?b:Object.keys(c)[0]];a.begin(d);a.reverseEach&&(d=d.reverse());$.each(d,function(b,c){a.each(c)});a.end(d,c.metadata)}};this.fail=function(a,b){return function(c){"responseJSON"in c||(c.responseJSON=
JSON.parse(c.responseText));if("exception"in c.responseJSON)if("The access token provided has expired"==c.responseJSON.exception.details)$.cookie("webpro_username")?standard.login({username:$.cookie("webpro_username"),password:$.cookie("webpro_username"),finish:b}):(standard.logout(),dia.error("Your login has expired. Please login again."));else return a.exception(c.responseJSON.exception);else return a.error(c)}};this.timer=function(a,b,c){a.close?(console.log("close "+b+"_"+a.timerId,fimApi.timers),
clearInterval(fimApi.timers[b+"_"+a.timerId]),delete fimApi.timers[b+"_"+a.timerId]):(c(a),-1<a.refresh&&(clearInterval(fimApi.timers[b+"_"+a.timerId]),fimApi.timers[b+"_"+a.timerId]=setInterval(function(){c(a)},a.refresh)))};this.registerDefaultExceptionHandler=function(a){this.requestDefaults.exception=a};this.getDefaultExceptionHandler=function(){return this.requestDefaults.exception}};
fimApi.prototype.login=function(a,b){a=fimApi.mergeDefaults(a,{grant_type:"password",username:null,password:null,access_token:null,refresh_token:null,client_id:""});""==a.username&&""==a.password&&(a.grant_type="anonymous");b=fimApi.mergeDefaults(b,fimApi.requestDefaults);return $.ajax({url:directory+"validate.php",type:"POST",data:a,timeout:b.timeout,cache:b.cache}).done(function(a){b.end(a.login)}).fail(function(a){b.error(a.responseJSON.exception)})};
fimApi.prototype.getUsers=function(a,b){a=fimApi.mergeDefaults(a,{info:["self","groups","profile"],access_token:window.sessionHash,id:null,userIds:null,userNames:null,userNameSearch:null});b=fimApi.mergeDefaults(b,fimApi.requestDefaults);(function(){$.ajax({type:"get",url:directory+"api/user.php",data:a,timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getUsers(a,b)}))})()};
fimApi.prototype.createUser=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);return $.ajax({type:"post",url:directory+"api/user.php",data:fimApi.mergeDefaults(a,{name:null,password:null,birthDate:null,email:null}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getUsers(a,b)}))};
fimApi.prototype.getRooms=function(a,b){a=fimApi.mergeDefaults(a,{access_token:window.sessionHash,id:null,roomIds:null,roomNames:null,roomNameSearch:null,permLevel:null,page:null});b=fimApi.mergeDefaults(b,fimApi.requestDefaults);(function(){$.ajax({type:"get",url:directory+"api/room.php",data:a,timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getRooms(a,b)}))})()};
fimApi.prototype.getMessages=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);fimApi.timer(b,"getMessages",function(b){b.autoId&&window.requestSettings[a.roomId].firstRequest&&(b.reverseEach=!0);$.ajax({type:"get",url:directory+"api/message.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash,roomId:null,userIds:null,messageIdEnd:null,messageIdStart:b.autoId&&window.requestSettings[a.roomId].lastMessage?window.requestSettings[a.roomId].lastMessage+1:null,page:null,messageTextSearch:null,
archive:b.autoId?window.requestSettings[a.roomId].firstRequest:!1}),timeout:b.timeout,cache:b.cache}).done(function(c){if(b.autoId){window.requestSettings[a.roomId].firstRequest&&(window.requestSettings[a.roomId].firstRequest=!1);for(var d in c.messages)c.messages[d].id&&(window.requestSettings[a.roomId].lastMessage=Number.isNaN(Number(window.requestSettings[a.roomId].lastMessage))?c.messages[d].id:Math.max(c.messages[d].id,window.requestSettings[a.roomId].lastMessage))}fimApi.done(b)(c)}).fail(function(c){b.refresh&&
fimApi.getMessages(null,{close:!0});fimApi.fail(b,function(){fimApi.getMessages(a,b)})(c)})})};fimApi.prototype.sendMessage=function(a,b,c){b=fimApi.mergeDefaults(b,{access_token:window.sessionHash,ignoreBlock:!1,message:null,flag:null});c=fimApi.mergeDefaults(c,fimApi.requestDefaults);$.ajax({url:directory+"api/message.php?"+$.param({roomId:a}),type:"POST",data:b,timeout:c.timeout,cache:c.cache}).done(fimApi.done(c)).fail(fimApi.fail(c,function(){fimApi.sendMessage(a,b,c)}))};
fimApi.prototype.editMessage=function(a,b,c,d){c=fimApi.mergeDefaults(c,{ignoreBlock:!1,message:null,flag:null});d=fimApi.mergeDefaults(d,fimApi.requestDefaults);$.ajax({url:directory+"api/message.php?"+$.param({_action:"edit",access_token:window.sessionHash,id:b,roomId:a}),type:"POST",data:c,timeout:d.timeout,cache:d.cache}).done(fimApi.done(d)).fail(fimApi.fail(d,function(){fimApi.editMessage(a,b,c,d)}))};
fimApi.prototype.deleteMessage=function(a,b,c){c=fimApi.mergeDefaults(c,fimApi.requestDefaults);$.ajax({url:directory+"api/message.php?"+$.param({_action:"delete",access_token:window.sessionHash,id:b,roomId:a}),type:"POST",timeout:c.timeout,cache:c.cache}).done(fimApi.done(c)).fail(fimApi.fail(c,function(){fimApi.deleteMessage(a,b,c)}))};
fimApi.prototype.getUnreadMessages=function(a,b){b=fimApi.mergeDefaults(b,fimApi.mergeDefaults({timeout:3E4,refresh:3E4},fimApi.requestDefaults));fimApi.timer(b,"getUnreadMessages",function(b){$.ajax({type:"get",url:directory+"api/unreadMessages.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(function(c){b.refresh&&fimApi.getUnreadMessages(null,{close:!0});fimApi.fail(b,function(){fimApi.getUnreadMessages(a,b)})(c)})})};
fimApi.prototype.getFiles=function(a,b){a=fimApi.mergeDefaults(a,{access_token:window.sessionHash,userIds:"",fileIds:""});b=fimApi.mergeDefaults(b,fimApi.requestDefaults);b.close&&clearInterval(fimApi.timers["getFiles_"+b.timerId]);(function(){$.ajax({type:"get",url:directory+"api/files.php",data:a,timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getFiles(a.requestSettings)}))})()};
fimApi.prototype.getStats=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);$.ajax({type:"get",url:directory+"api/stats.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash,roomId:null,number:10}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b,"roomStats")).fail(fimApi.fail(b,function(){fimApi.getStats(a,b)}))};
fimApi.prototype.getKicks=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);(function(){$.ajax({type:"get",url:directory+"api/kick.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash,roomId:null,userId:null}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getKicks(a,b)}))})()};
fimApi.prototype.getCensorLists=function(a,b){a=fimApi.mergeDefaults(a,{access_token:window.sessionHash,roomId:null,listIds:null,includeWords:1});b=fimApi.mergeDefaults(b,fimApi.requestDefaults);(function(){$.ajax({type:"get",url:directory+"api/getCensorLists.php",data:a,timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getCensorLists(a,b)}))})()};
fimApi.prototype.getActiveUsers=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);fimApi.timer(b,"getActiveUsers",function(b){$.ajax({type:"get",url:directory+"api/userStatus.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash,roomIds:null,userIds:null,onlineThreshold:null}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b,"users")).fail(function(c){b.refresh&&fimApi.getActiveUsers(null,{close:!0});fimApi.fail(b,function(){fimApi.getActiveUsers(a,b)})(c)})})};
fimApi.prototype.getGroups=function(a,b){b=fimApi.mergeDefaults(b,fimApi.requestDefaults);$.ajax({type:"get",url:directory+"api/group.php",data:fimApi.mergeDefaults(a,{access_token:window.sessionHash,groupIds:null,groupNames:null,groupNameSearch:null}),timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.getGroups(a,b)}))};
fimApi.prototype.acHelper=function(a){return function(b,c){$.ajax({type:"get",url:directory+"api/acHelper.php",data:{access_token:window.sessionHash,list:a,search:b.term},success:function(a){c($.map(a.entries,function(a,b){return{label:a,value:b}}))}})}};
fimApi.prototype.kickUser=function(a,b,c,d){d=fimApi.mergeDefaults(d,fimApi.requestDefaults);$.ajax({url:directory+"api/kick.php?"+$.param({access_token:window.sessionHash,roomId:b,userId:a}),type:"POST",data:{length:c},timeout:d.timeout,cache:d.cache}).done(fimApi.done(d)).fail(fimApi.fail(d,function(){fimApi.kickUser(a,b,c,d)}))};
fimApi.prototype.unkickUser=function(a,b,c){c=fimApi.mergeDefaults(c,fimApi.requestDefaults);$.ajax({url:directory+"api/kick.php?"+$.param({access_token:window.sessionHash,_action:"delete",roomId:b,userId:a}),type:"POST",timeout:c.timeout,cache:c.cache}).done(fimApi.done(c)).fail(fimApi.fail(c,function(){fimApi.unkickUser(a,b,c)}))};
fimApi.prototype.markMessageRead=function(a,b){var c={access_token:window.sessionHash,roomId:a};b=fimApi.mergeDefaults(b,fimApi.requestDefaults);$.ajax({url:directory+"api/markMessageRead.php",type:"POST",data:c,timeout:b.timeout,cache:b.cache}).done(fimApi.done(b)).fail(fimApi.fail(b,function(){fimApi.markMessageRead(a,b)}))};
fimApi.prototype.editUserOptions=function(a,b,c){b=fimApi.mergeDefaults(b,{defaultFormatting:null,defaultColor:null,defaultHighlight:null,defaultRoomId:null,watchRooms:null,favRooms:null,ignoreList:null,friendsList:null,profile:null,defaultFontface:null,parentalAge:null,parentalFlags:null,avatar:null,privacyLevel:null});c=fimApi.mergeDefaults(c,fimApi.requestDefaults);$.ajax({url:directory+"api/userOptions.php?"+$.param({access_token:window.sessionHash,_action:a?a:"edit"}),type:"POST",data:b,timeout:c.timeout,
cache:c.cache}).done(fimApi.done(c)).fail(fimApi.fail(c,function(){fimApi.editUserOptions(a,b,c)}))};fimApi.prototype.favRoom=function(a){this.editUserOptions("create",{favRooms:[a]})};fimApi.prototype.unfavRoom=function(a){this.editUserOptions("delete",{favRooms:[a]})};fimApi.prototype.watchRoom=function(a){this.editUserOptions("create",{watchRooms:[a]})};fimApi.prototype.unwatchRoom=function(a){this.editUserOptions("delete",{watchRooms:[a]})};
fimApi.prototype.editRoom=function(a,b,c,d){c=fimApi.mergeDefaults(c,{access_token:window.sessionHash,name:null,defaultPermissions:null,userPermissions:null,groupPermissions:null,censorLists:null,parentalAge:null,parentalFlags:null,hidden:null,official:null});d=fimApi.mergeDefaults(d,fimApi.requestDefaults);$.ajax({url:directory+"api/room.php?"+$.param({id:a,_action:b}),method:"POST",data:c,timeout:d.timeout,cache:d.cache}).done(fimApi.done(d)).fail(fimApi.fail(d,function(){fimApi.editRoom(a,c,d)}))};
fimApi.prototype.createRoom=function(a,b){fimApi.editRoom(null,"create",a,b)};fimApi.prototype.deleteRoom=function(a,b){fimApi.editRoom(a,"delete",{},b)};fimApi.prototype.undeleteRoom=function(a,b){fimApi.editRoom(a,"undelete",{},b)};fimApi.prototype.editRoomPermissionUser=function(a,b,c){var d={};d["*"+b]=c;fimApi.editRoom(a,"edit",{userPermissions:d})};fimApi.prototype.editRoomPermissionGroup=function(a,b,c){var d={};d["*"+b]=c;fimApi.editRoom(a,"edit",{groupPermissions:d})};
fimApi.prototype.editUserStatus=function(a,b,c){b=fimApi.mergeDefaults(b,{status:null,typing:null});c=fimApi.mergeDefaults(c,fimApi.requestDefaults);$.ajax({url:directory+"api/userStatus.php?"+$.param({_action:"edit",access_token:window.sessionHash,roomIds:[a]}),type:"POST",data:b,timeout:c.timeout,cache:c.cache}).done(fimApi.done(c)).fail(fimApi.fail(c,function(){fimApi.editUserStatus(a,b,c)}))};fimApi.prototype.ping=function(a,b){this.editUserStatus(a,{},b)};
fimApi.prototype.changeAvatar=function(a,b){this.editUserOptions({avatarHash:a},b)};fimApi.prototype.mergeDefaults=function(a,b){var c={},d;for(d in a){if(!(d in b))throw"Invalid data in object call: "+d;null!==a[d]&&void 0!==a[d]&&(c[d]=a[d])}for(d in b)d in c||null===b[d]||(c[d]=b[d]);return c};fimApi.prototype.jsonify=function(a,b){a=void 0===a?{}:Object.create(a);for(var c in b)b[c]in a&&(a[b[c]]=JSON.stringify(a[b[c]]));return a};
